<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Chia Yong Soon">
<meta name="dcterms.date" content="2023-12-09">

<title>ISSS624 (CHIAYS) - Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS624 (<strong>CHIAYS</strong>)</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex1/Hands-on_Ex1.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex2/Hands-on_Ex2.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex3/Hands-on_Ex3.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex4/Hands-on_Ex4.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li class="dropdown-header">Hands-on Exercise 5</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex1/In-class_Ex1.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex2/In-class_Ex2-SW.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 2-SW</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex2/In-class_Ex2-GLSA.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 2-GLSA</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex2/In-class_Ex2-EHSA.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 2-EHSA</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex3/In-class_Ex3.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex4/In-class_Ex4.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li class="dropdown-header">In-class Exercise 5</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex1/Take-home_Ex1-WDMP.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1-WDMP</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex1/Take-home_Ex1-WDAP.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1-WDAP</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex1/Take-home_Ex1-WEMP.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1-WEMP</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex1/Take-home_Ex1-WEEP.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1-WEEP</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-extra-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Extra Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-extra-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Extra_Exercise/Extra_Exercise.html" rel="" target="">
 <span class="dropdown-text">Extra_Exercise</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setting-the-scene" id="toc-setting-the-scene" class="nav-link active" data-scroll-target="#setting-the-scene"><strong>1 Setting the Scene</strong></a></li>
  <li><a href="#motivation-and-objective" id="toc-motivation-and-objective" class="nav-link" data-scroll-target="#motivation-and-objective"><strong>2 Motivation and Objective</strong></a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data"><strong>The Data</strong></a>
  <ul class="collapse">
  <li><a href="#open-government-data" id="toc-open-government-data" class="nav-link" data-scroll-target="#open-government-data">Open Government Data</a></li>
  <li><a href="#specially-collected-data" id="toc-specially-collected-data" class="nav-link" data-scroll-target="#specially-collected-data">Specially collected data</a></li>
  </ul></li>
  <li><a href="#the-task" id="toc-the-task" class="nav-link" data-scroll-target="#the-task"><strong>3 The Task</strong></a>
  <ul class="collapse">
  <li><a href="#geospatial-data-science" id="toc-geospatial-data-science" class="nav-link" data-scroll-target="#geospatial-data-science">Geospatial Data Science</a></li>
  <li><a href="#spatial-interaction-modelling" id="toc-spatial-interaction-modelling" class="nav-link" data-scroll-target="#spatial-interaction-modelling">Spatial Interaction Modelling</a></li>
  </ul></li>
  <li><a href="#installing-and-loading-the-r-packages" id="toc-installing-and-loading-the-r-packages" class="nav-link" data-scroll-target="#installing-and-loading-the-r-packages"><strong>4 Installing and Loading the R Packages</strong></a></li>
  <li><a href="#the-data-1" id="toc-the-data-1" class="nav-link" data-scroll-target="#the-data-1"><strong>5 The Data</strong></a>
  <ul class="collapse">
  <li><a href="#aspatial-data" id="toc-aspatial-data" class="nav-link" data-scroll-target="#aspatial-data">Aspatial data</a></li>
  <li><a href="#geospatial-data" id="toc-geospatial-data" class="nav-link" data-scroll-target="#geospatial-data">Geospatial data</a></li>
  </ul></li>
  <li><a href="#geospatial-data-wrangling" id="toc-geospatial-data-wrangling" class="nav-link" data-scroll-target="#geospatial-data-wrangling"><strong>6 Geospatial data wrangling</strong></a>
  <ul class="collapse">
  <li><a href="#combining-busstop-and-mpsz" id="toc-combining-busstop-and-mpsz" class="nav-link" data-scroll-target="#combining-busstop-and-mpsz">Combining Busstop and mpsz</a></li>
  </ul></li>
  <li><a href="#choropleth-visualisation" id="toc-choropleth-visualisation" class="nav-link" data-scroll-target="#choropleth-visualisation"><strong>7 Choropleth Visualisation</strong></a></li>
  <li><a href="#visualising-spatial-interaction" id="toc-visualising-spatial-interaction" class="nav-link" data-scroll-target="#visualising-spatial-interaction"><strong>8 Visualising Spatial Interaction</strong></a>
  <ul class="collapse">
  <li><a href="#removing-intra-zonal-flows" id="toc-removing-intra-zonal-flows" class="nav-link" data-scroll-target="#removing-intra-zonal-flows">Removing intra-zonal flows</a></li>
  <li><a href="#creating-desire-lines" id="toc-creating-desire-lines" class="nav-link" data-scroll-target="#creating-desire-lines">Creating desire lines</a></li>
  <li><a href="#visualising-the-desire-lines" id="toc-visualising-the-desire-lines" class="nav-link" data-scroll-target="#visualising-the-desire-lines">Visualising the desire lines</a></li>
  </ul></li>
  <li><a href="#geocoding-using-sla-api" id="toc-geocoding-using-sla-api" class="nav-link" data-scroll-target="#geocoding-using-sla-api"><strong>9 Geocoding using SLA API</strong></a></li>
  <li><a href="#performing-point-in-polygon-count-process" id="toc-performing-point-in-polygon-count-process" class="nav-link" data-scroll-target="#performing-point-in-polygon-count-process"><strong>10 Performing point-in-polygon count process</strong></a></li>
  <li><a href="#data-integration-and-final-touch-up" id="toc-data-integration-and-final-touch-up" class="nav-link" data-scroll-target="#data-integration-and-final-touch-up"><strong>11 Data Integration and Final Touch-up</strong></a></li>
  <li><a href="#calibrating-spatial-interaction-models-with-r" id="toc-calibrating-spatial-interaction-models-with-r" class="nav-link" data-scroll-target="#calibrating-spatial-interaction-models-with-r"><strong>12 Calibrating Spatial Interaction Models with R</strong></a></li>
  <li><a href="#calibrate-sim" id="toc-calibrate-sim" class="nav-link" data-scroll-target="#calibrate-sim"><strong>13 Calibrate SIM</strong></a></li>
  <li><a href="#computing-distance-matrix" id="toc-computing-distance-matrix" class="nav-link" data-scroll-target="#computing-distance-matrix"><strong>14 Computing Distance Matrix</strong></a>
  <ul class="collapse">
  <li><a href="#converting-from-sf-data.table-to-spatialpolygonsdataframe" id="toc-converting-from-sf-data.table-to-spatialpolygonsdataframe" class="nav-link" data-scroll-target="#converting-from-sf-data.table-to-spatialpolygonsdataframe">Converting from sf data.table to SpatialPolygonsDataFrame</a></li>
  <li><a href="#computing-the-distance-matrix" id="toc-computing-the-distance-matrix" class="nav-link" data-scroll-target="#computing-the-distance-matrix">Computing the distance matrix</a></li>
  <li><a href="#labelling-column-and-row-heanders-of-a-distance-matrix" id="toc-labelling-column-and-row-heanders-of-a-distance-matrix" class="nav-link" data-scroll-target="#labelling-column-and-row-heanders-of-a-distance-matrix">Labelling column and row heanders of a distance matrix</a></li>
  <li><a href="#pivoting-distance-value-by-subzone_c" id="toc-pivoting-distance-value-by-subzone_c" class="nav-link" data-scroll-target="#pivoting-distance-value-by-subzone_c">Pivoting distance value by SUBZONE_C</a></li>
  <li><a href="#updating-intra-zonal-distances" id="toc-updating-intra-zonal-distances" class="nav-link" data-scroll-target="#updating-intra-zonal-distances">Updating intra-zonal distances</a></li>
  </ul></li>
  <li><a href="#separating-intra-flow-from-passenger-volume-df" id="toc-separating-intra-flow-from-passenger-volume-df" class="nav-link" data-scroll-target="#separating-intra-flow-from-passenger-volume-df"><strong>15 Separating intra-flow from passenger volume df</strong></a></li>
  <li><a href="#combining-passenger-volume-data-with-distance-value" id="toc-combining-passenger-volume-data-with-distance-value" class="nav-link" data-scroll-target="#combining-passenger-volume-data-with-distance-value"><strong>16 Combining passenger volume data with distance value</strong></a></li>
  <li><a href="#preparing-origin-and-destination-attributes" id="toc-preparing-origin-and-destination-attributes" class="nav-link" data-scroll-target="#preparing-origin-and-destination-attributes"><strong>17 Preparing Origin and Destination Attributes</strong></a>
  <ul class="collapse">
  <li><a href="#importing-population-data" id="toc-importing-population-data" class="nav-link" data-scroll-target="#importing-population-data">Importing population data</a></li>
  <li><a href="#geospatial-data-wrangling-1" id="toc-geospatial-data-wrangling-1" class="nav-link" data-scroll-target="#geospatial-data-wrangling-1">Geospatial data wrangling</a></li>
  <li><a href="#preparing-origin-attribute" id="toc-preparing-origin-attribute" class="nav-link" data-scroll-target="#preparing-origin-attribute">Preparing origin attribute</a></li>
  <li><a href="#calibrating-spatial-interaction-models" id="toc-calibrating-spatial-interaction-models" class="nav-link" data-scroll-target="#calibrating-spatial-interaction-models">Calibrating Spatial Interaction Models</a></li>
  </ul></li>
  <li><a href="#calibrating-spatial-interaction-models-schoolbusiness" id="toc-calibrating-spatial-interaction-models-schoolbusiness" class="nav-link" data-scroll-target="#calibrating-spatial-interaction-models-schoolbusiness">18 Calibrating Spatial Interaction Models (School/Business)</a>
  <ul class="collapse">
  <li><a href="#origin--production--constrained-model" id="toc-origin--production--constrained-model" class="nav-link" data-scroll-target="#origin--production--constrained-model">Origin- (Production-) constrained Model</a></li>
  <li><a href="#doubly-constrained-model" id="toc-doubly-constrained-model" class="nav-link" data-scroll-target="#doubly-constrained-model">Doubly constrained model</a></li>
  </ul></li>
  <li><a href="#model-comparison-1" id="toc-model-comparison-1" class="nav-link" data-scroll-target="#model-comparison-1">19 Model comparison</a>
  <ul class="collapse">
  <li><a href="#statistical-measures" id="toc-statistical-measures" class="nav-link" data-scroll-target="#statistical-measures">Statistical measures</a></li>
  <li><a href="#visualising-fitted-values" id="toc-visualising-fitted-values" class="nav-link" data-scroll-target="#visualising-fitted-values">Visualising fitted values</a></li>
  </ul></li>
  <li><a href="#identify-outlier" id="toc-identify-outlier" class="nav-link" data-scroll-target="#identify-outlier">20 Identify Outlier</a></li>
  <li><a href="#re-calibrating-spatial-interaction-models-schoolbusiness" id="toc-re-calibrating-spatial-interaction-models-schoolbusiness" class="nav-link" data-scroll-target="#re-calibrating-spatial-interaction-models-schoolbusiness">21 Re-Calibrating Spatial Interaction Models (School/Business)</a>
  <ul class="collapse">
  <li><a href="#origin--production--constrained-model-1" id="toc-origin--production--constrained-model-1" class="nav-link" data-scroll-target="#origin--production--constrained-model-1">Origin- (Production-) constrained Model</a></li>
  <li><a href="#doubly-constrained-model-1" id="toc-doubly-constrained-model-1" class="nav-link" data-scroll-target="#doubly-constrained-model-1">Doubly constrained model</a></li>
  </ul></li>
  <li><a href="#re-model-comparison" id="toc-re-model-comparison" class="nav-link" data-scroll-target="#re-model-comparison">22 Re-Model comparison</a>
  <ul class="collapse">
  <li><a href="#statistical-measures-1" id="toc-statistical-measures-1" class="nav-link" data-scroll-target="#statistical-measures-1">Statistical measures</a></li>
  <li><a href="#visualising-fitted-values-1" id="toc-visualising-fitted-values-1" class="nav-link" data-scroll-target="#visualising-fitted-values-1">Visualising fitted values</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Chia Yong Soon </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 9, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">December 10, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="setting-the-scene" class="level2">
<h2 class="anchored" data-anchor-id="setting-the-scene"><strong>1 Setting the Scene</strong></h2>
<p>What are the driving forces behind urban dwellers to weak up early in morning to commute from their home locations to their work places? What are the impact of removing a public bus service on the commuters reside along the corridor of the bus route? These and many other questions related to urban mobility are challenges faced by transport operators and urban managers.</p>
<p>To provide answer to this question, traditionally, commuters survey will be used. However, commuters survey is a very costly, time-consuming and laborous, not to mention that the survey data tend to take a long time to clean and analyse. As a result, it is not unusual, by the time the survey report was ready, most of the information already out-of-date!</p>
<p>As city-wide urban infrastructures such as public buses, mass rapid transits, public utilities and roads become digital, the data sets obtained can be used as a framework for tracking movement patterns through space and time. This is particularly true with the recent trend of massive deployment of pervasive computing technologies such as GPS on the vehicles and SMART cards used by public transport commuters.</p>
<p>Unfortunately, this explosive growth of geospatially-referenced data has far outpaced the planner’s ability to utilize and transform the data into insightful information thus creating an adverse impact on the return on the investment made to collect and manage this data.</p>
</section>
<section id="motivation-and-objective" class="level2">
<h2 class="anchored" data-anchor-id="motivation-and-objective"><strong>2 Motivation and Objective</strong></h2>
<p>This take-home exercise is motivated by two main reasons. Firstly, despite increasing amounts of open data available for public consumption, there has not been significant practice research carried out to show how these disparate data sources can be integrated, analysed, and modelled to support policy making decisions.</p>
<p>Secondly, there is a general lack of practical research to show how geospatial data science and analysis (GDSA) can be used to support decision-making.</p>
<p>Hence, your task for this take-home exercise is to conduct a case study to demonstrate the potential value of GDSA to integrate publicly available data from multiple sources for building a spatial interaction models to determine factors affecting urban mobility patterns of public bus transit.</p>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data"><strong>The Data</strong></h2>
<section id="open-government-data" class="level3">
<h3 class="anchored" data-anchor-id="open-government-data">Open Government Data</h3>
<p>For the purpose of this assignment, data from several open government sources will be used:</p>
<ul>
<li><p><em>Passenger Volume by Origin Destination Bus Stops</em>, <em>Bus Stop Location</em>, <em>Train Station</em> and <em>Train Station Exit Point</em>, just to name a few of them, from <a href="https://datamall.lta.gov.sg/content/datamall/en.html">LTA DataMall</a>.</p></li>
<li><p><em>Master Plan 2019 Subzone Boundary</em>, <em>HDB Property Information</em>, <em>School Directory and Information</em> and other relevant data from <a href="https://beta.data.gov.sg/">Data.gov.sg</a>.</p></li>
</ul>
</section>
<section id="specially-collected-data" class="level3">
<h3 class="anchored" data-anchor-id="specially-collected-data">Specially collected data</h3>
<ul>
<li><p><em>Business</em>, <em>entertn</em>, <em>F&amp;B</em>, <em>FinServ</em>, <em>Leisure&amp;Recreation</em> and <em>Retails</em> are geospatial data sets of the locations of business establishments, entertainments, food and beverage outlets, financial centres, leisure and recreation centres, retail and services stores/outlets I compiled for urban mobility study. They are available on in the geospatial folder to Take-home Exercise 2 data folder.</p></li>
<li><p>HDB: This data set is the geocoded version of <em>HDB Property Information</em> data from data.gov. The data set is prepared using September 2021 data. If you want to prepare you own data by using the latest <em>HDB Property Information</em> provided on data.gov.sg, this <a href="https://is415-msty.netlify.app/posts/2021-10-25-take-home-exercise-3/?panelset6=glimpse%28%29#geocoding-our-aspatial-data">link</a> provides a useful step-by-step guide.</p></li>
</ul>
</section>
</section>
<section id="the-task" class="level2">
<h2 class="anchored" data-anchor-id="the-task"><strong>3 The Task</strong></h2>
<p>The specific tasks of this take-home exercise are as follows:</p>
<section id="geospatial-data-science" class="level3">
<h3 class="anchored" data-anchor-id="geospatial-data-science">Geospatial Data Science</h3>
<ul>
<li><p>Derive an analytical hexagon data of 325m (this distance is the perpendicular distance between the centre of the hexagon and its edges) to represent the <a href="https://tmg.utoronto.ca/files/Reports/Traffic-Zone-Guidance_March-2021_Final.pdf">traffic analysis zone (TAZ)</a>.</p></li>
<li><p>With reference to the time intervals provided in the table below, construct an O-D matrix of commuter flows for a time interval of your choice by integrating <em>Passenger Volume by Origin Destination Bus Stops</em> and <em>Bus Stop Location</em> from <a href="https://datamall.lta.gov.sg/content/datamall/en.html">LTA DataMall</a>. The O-D matrix must be aggregated at the analytics hexagon level</p>
<table class="table">
<thead>
<tr class="header">
<th>Peak hour period</th>
<th>Bus tap on time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Weekday morning peak</td>
<td>6am to 9am</td>
</tr>
<tr class="even">
<td>Weekday afternoon peak</td>
<td>5pm to 8pm</td>
</tr>
<tr class="odd">
<td>Weekend/holiday morning peak</td>
<td>11am to 2pm</td>
</tr>
<tr class="even">
<td>Weekend/holiday evening peak</td>
<td>4pm to 7pm</td>
</tr>
</tbody>
</table></li>
<li><p>Display the O-D flows of the passenger trips by using appropriate geovisualisation methods (not more than 5 maps).</p></li>
<li><p>Describe the spatial patterns revealed by the geovisualisation (not more than 100 words per visual).</p></li>
<li><p>Assemble at least three propulsive and three attractiveness variables by using aspatial and geospatial from publicly available sources.</p></li>
<li><p>Compute a distance matrix by using the analytical hexagon data derived earlier.</p></li>
</ul>
</section>
<section id="spatial-interaction-modelling" class="level3">
<h3 class="anchored" data-anchor-id="spatial-interaction-modelling">Spatial Interaction Modelling</h3>
<ul>
<li><p>Calibrate spatial interactive models to determine factors affecting urban commuting flows at the selected time interval.</p></li>
<li><p>Present the modelling results by using appropriate geovisualisation and graphical visualisation methods. (Not more than 5 visuals)</p></li>
<li><p>With reference to the Spatial Interaction Model output tables, maps and data visualisation prepared, describe the modelling results. (not more than 100 words per visual).</p></li>
</ul>
</section>
</section>
<section id="installing-and-loading-the-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="installing-and-loading-the-r-packages"><strong>4 Installing and Loading the R Packages</strong></h2>
<p>Six R packages will be used for this exercise, they are sf, sfdep, tmap, tidyverse, knitr, plotly.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, sfdep, tmap, tidyverse, knitr, plotly, httr, stplanr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol type="1">
<li><p>sf: Purpose: The sf package stands for “simple features” and is used for working with spatial data in R. It provides a framework for representing and manipulating geometric objects like points, lines, and polygons, making it useful for tasks such as geographic information system (GIS) analysis.</p></li>
<li><p>sfdep: Purpose: The sfdep provides users with a way to conduct “Exploratory Spatial Data Analysis”, typical for exploratory data analysis. It evaluates the phenomena captured in the data on whether they are dependent upon space–or are spatially auto-correlated. “Local Indicators of Spatial Association”, LISAs for short are measures that are developed to identify whether some observed pattern is truly random or impacted by its relationship in space.</p></li>
<li><p>tmap: Purpose: tmap is a package for creating thematic maps in R. It provides a simple and consistent interface for visualizing spatial data, making it easier to create informative and visually appealing maps. It is often used in conjunction with the sf package for handling spatial data.</p></li>
<li><p>tidyverse: Purpose: The tidyverse is not a single package but a collection of R packages that work together cohesively for data manipulation and visualization. It includes popular packages like ggplot2 for plotting, dplyr for data manipulation, tidyr for data tidying, and others. The tidyverse philosophy emphasizes a consistent and intuitive approach to data analysis.</p></li>
<li><p>knitr: Purpose: knitr is a package for dynamic report generation in R. It allows you to embed R code directly into documents and then render the code and its output, such as tables and plots, into various document formats like HTML, PDF, or Word. It is commonly used with R Markdown to create reproducible research reports.</p></li>
<li><p>plotly: Purpose: plotly is a package for creating interactive and dynamic plots in R. It supports a variety of chart types, including scatter plots, line charts, and 3D plots. The resulting visualizations can be embedded into web pages, making it a powerful tool for creating interactive and shareable data visualizations.</p></li>
<li><p>httr: Purpose: httr is a package designed to work with web APIs. It provides functions for sending HTTP requests, handling responses, and interacting with web services. The name “httr” stands for “http tools.”</p></li>
<li><p>stplanr: Purpose stplanr is an package designed for transport planning and analysis. It provides a set of functions and tools for working with spatial data related to transport and infrastructure planning. The package leverages the capabilities of the sf (simple features) package for handling spatial data.</p></li>
</ol>
</section>
<section id="the-data-1" class="level2">
<h2 class="anchored" data-anchor-id="the-data-1"><strong>5 The Data</strong></h2>
<section id="aspatial-data" class="level3">
<h3 class="anchored" data-anchor-id="aspatial-data">Aspatial data</h3>
<p>For the purpose of this take-home exercise, Passenger Volume by Origin Destination Bus Stops downloaded from LTA DataMall will be used.</p>
<section id="importing-the-aspatial-data" class="level4">
<h4 class="anchored" data-anchor-id="importing-the-aspatial-data">Importing the aspatial data</h4>
<p>Since listings data set is in csv file format, we will use read_csv() of readr package to import origin_destination_bus.csv as shown the code chunk below. The output R object is called odbus1023 and it is a tibble data frame.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>odbus1023 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/origin_destination_bus_202310.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 5694297 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (5): YEAR_MONTH, DAY_TYPE, PT_TYPE, ORIGIN_PT_CODE, DESTINATION_PT_CODE
dbl (2): TIME_PER_HOUR, TOTAL_TRIPS

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>A quick check of odbus tibble data frame shows that the values in OROGIN_PT_CODE and DESTINATON_PT_CODE are in numeric data type.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(odbus1023)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,694,297
Columns: 7
$ YEAR_MONTH          &lt;chr&gt; "2023-10", "2023-10", "2023-10", "2023-10", "2023-…
$ DAY_TYPE            &lt;chr&gt; "WEEKENDS/HOLIDAY", "WEEKDAY", "WEEKENDS/HOLIDAY",…
$ TIME_PER_HOUR       &lt;dbl&gt; 16, 16, 14, 14, 17, 17, 17, 7, 14, 14, 10, 20, 20,…
$ PT_TYPE             &lt;chr&gt; "BUS", "BUS", "BUS", "BUS", "BUS", "BUS", "BUS", "…
$ ORIGIN_PT_CODE      &lt;chr&gt; "04168", "04168", "80119", "80119", "44069", "2028…
$ DESTINATION_PT_CODE &lt;chr&gt; "10051", "10051", "90079", "90079", "17229", "2014…
$ TOTAL_TRIPS         &lt;dbl&gt; 3, 5, 3, 5, 4, 1, 24, 2, 1, 7, 3, 2, 5, 1, 1, 1, 1…</code></pre>
</div>
</div>
<p>Convert these data values into factor data type.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>odbus1023<span class="sc">$</span>ORIGIN_PT_CODE <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(odbus1023<span class="sc">$</span>ORIGIN_PT_CODE) </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>odbus1023<span class="sc">$</span>DESTINATION_PT_CODE <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(odbus1023<span class="sc">$</span>DESTINATION_PT_CODE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Notice that both of them are in factor data type now.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(odbus1023)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,694,297
Columns: 7
$ YEAR_MONTH          &lt;chr&gt; "2023-10", "2023-10", "2023-10", "2023-10", "2023-…
$ DAY_TYPE            &lt;chr&gt; "WEEKENDS/HOLIDAY", "WEEKDAY", "WEEKENDS/HOLIDAY",…
$ TIME_PER_HOUR       &lt;dbl&gt; 16, 16, 14, 14, 17, 17, 17, 7, 14, 14, 10, 20, 20,…
$ PT_TYPE             &lt;chr&gt; "BUS", "BUS", "BUS", "BUS", "BUS", "BUS", "BUS", "…
$ ORIGIN_PT_CODE      &lt;fct&gt; 04168, 04168, 80119, 80119, 44069, 20281, 20281, 1…
$ DESTINATION_PT_CODE &lt;fct&gt; 10051, 10051, 90079, 90079, 17229, 20141, 20141, 1…
$ TOTAL_TRIPS         &lt;dbl&gt; 3, 5, 3, 5, 4, 1, 24, 2, 1, 7, 3, 2, 5, 1, 1, 1, 1…</code></pre>
</div>
</div>
</section>
<section id="task--weekday-morning-peak-period-6am-to-9am" class="level4">
<h4 class="anchored" data-anchor-id="task--weekday-morning-peak-period-6am-to-9am">TASK:- Weekday morning peak (Period: 6am to 9am)</h4>
<p>For the purpose of extracting the commuting flows during the weekday morning peak for the period from 6am to 9am. Call the output tibble data table as origin_WDMP and dest_WDMP.</p>
<table class="table">
<thead>
<tr class="header">
<th>Peak hour period</th>
<th>Bus tap on time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Weekday morning peak</td>
<td>6am to 9am</td>
</tr>
</tbody>
</table>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>origin_WDMP <span class="ot">&lt;-</span> odbus1023 <span class="sc">%&gt;%</span>   </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(DAY_TYPE <span class="sc">==</span> <span class="st">"WEEKDAY"</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(TIME_PER_HOUR <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span>            </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        TIME_PER_HOUR <span class="sc">&lt;=</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(ORIGIN_PT_CODE) <span class="sc">%&gt;%</span>   </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarise</span>(<span class="at">TRIPS =</span> <span class="fu">sum</span>(TOTAL_TRIPS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>dest_WDMP <span class="ot">&lt;-</span> odbus1023 <span class="sc">%&gt;%</span>   </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(DAY_TYPE <span class="sc">==</span> <span class="st">"WEEKDAY"</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(TIME_PER_HOUR <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span>            </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        TIME_PER_HOUR <span class="sc">&lt;=</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(DESTINATION_PT_CODE) <span class="sc">%&gt;%</span>   </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarise</span>(<span class="at">TRIPS =</span> <span class="fu">sum</span>(TOTAL_TRIPS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>all_WDMP <span class="ot">&lt;-</span> odbus1023 <span class="sc">%&gt;%</span>   </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(DAY_TYPE <span class="sc">==</span> <span class="st">"WEEKDAY"</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(TIME_PER_HOUR <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span>            </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>        TIME_PER_HOUR <span class="sc">&lt;=</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(ORIGIN_PT_CODE,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                 DESTINATION_PT_CODE) <span class="sc">%&gt;%</span>   </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarise</span>(<span class="at">TRIPS =</span> <span class="fu">sum</span>(TOTAL_TRIPS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ORIGIN_PT_CODE'. You can override using
the `.groups` argument.</code></pre>
</div>
</div>
<p>View the top few rows of the summarized trips by ORIGIN_PT_CODE.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(origin_WDMP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  ORIGIN_PT_CODE TRIPS
  &lt;fct&gt;          &lt;dbl&gt;
1 01012           1770
2 01013            841
3 01019           1530
4 01029           2483
5 01039           2919
6 01059           1734</code></pre>
</div>
</div>
<p>View the top few rows of the summarized trips by DESTINATION_PT_CODE.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dest_WDMP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  DESTINATION_PT_CODE TRIPS
  &lt;fct&gt;               &lt;dbl&gt;
1 01012                5950
2 01013                1542
3 01019                6500
4 01029                5904
5 01039                7642
6 01059               16642</code></pre>
</div>
</div>
<p>We will save the output in rds format for future used.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(origin_WDMP, <span class="st">"data/rds/origin_WDMP.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(dest_WDMP, <span class="st">"data/rds/dest_WDMP.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(all_WDMP, <span class="st">"data/rds/all_WDMP.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk below will be used to import the save into R environment.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>origin_WDMP <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/origin_WDMP.rds"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>dest_WDMP <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/dest_WDMP.rds"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>all_WDMP <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/all_WDMP.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="geospatial-data" class="level3">
<h3 class="anchored" data-anchor-id="geospatial-data">Geospatial data</h3>
<p>Two geospatial data will be used in this study, they are:</p>
<ul>
<li><p>Bus Stop Location from LTA DataMall. It provides information about all the bus stops currently being serviced by buses, including the bus stop code (identifier) and location coordinates.</p></li>
<li><p>hexagon, a hexagon layer of 375m (this distance is the perpendicular distance between the centre of the hexagon and its edges.) should be used to represent the <a href="https://tmg.utoronto.ca/files/Reports/Traffic-Zone-Guidance_March-2021_Final.pdf">traffic analysis zone</a>.</p></li>
</ul>
<section id="importing-the-data-into-r-environment" class="level4">
<h4 class="anchored" data-anchor-id="importing-the-data-into-r-environment">Importing the data into R Environment</h4>
<p>In this section, you are required to import two shapefile into RStudio, they are: - BusStop: This data provides the location of bus stop as at 2nd quarter of 2023. - MPSZ-2019: This data provides the sub-zone boundary of URA Master Plan 2019.</p>
<p>The code chunk below uses st_read() function of sf package to import BusStop shapefile into R as line feature data frame.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>BusStop <span class="ot">=</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,                           </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">layer =</span> <span class="st">"BusStop"</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `BusStop' from data source 
  `C:\chiays\ISS624\Take-home_Ex\Take-home_Ex2\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 5161 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82
Projected CRS: SVY21</code></pre>
</div>
</div>
<p>The message above reveals that there are a total of 5161 features and 3 fields in BusStop linestring feature data frame and it is in svy21 projected coordinates system too.</p>
<p>The structure of busstop sf tibble data frame should look as below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(BusStop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,161
Columns: 4
$ BUS_STOP_N &lt;chr&gt; "22069", "32071", "44331", "96081", "11561", "66191", "2338…
$ BUS_ROOF_N &lt;chr&gt; "B06", "B23", "B01", "B05", "B05", "B03", "B02A", "B02", "B…
$ LOC_DESC   &lt;chr&gt; "OPP CEVA LOGISTICS", "AFT TRACK 13", "BLK 239", "GRACE IND…
$ geometry   &lt;POINT [m]&gt; POINT (13576.31 32883.65), POINT (13228.59 44206.38),…</code></pre>
</div>
</div>
<p>Import MPSZ-2019 into RStudio and save it as a sf data frame called mpsz.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,                    </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">layer =</span> <span class="st">"MPSZ-2019"</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `MPSZ-2019' from data source 
  `C:\chiays\ISS624\Take-home_Ex\Take-home_Ex2\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 332 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<ul>
<li>st_read() function of sf package is used to import the shapefile into R as sf data frame.</li>
<li>st_transform() function of sf package is used to transform the projection to crs 3414.</li>
</ul>
<p>The structure of mpsz sf tibble data frame should look as below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mpsz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 332
Columns: 7
$ SUBZONE_N  &lt;chr&gt; "MARINA EAST", "INSTITUTION HILL", "ROBERTSON QUAY", "JURON…
$ SUBZONE_C  &lt;chr&gt; "MESZ01", "RVSZ05", "SRSZ01", "WISZ01", "MUSZ02", "MPSZ05",…
$ PLN_AREA_N &lt;chr&gt; "MARINA EAST", "RIVER VALLEY", "SINGAPORE RIVER", "WESTERN …
$ PLN_AREA_C &lt;chr&gt; "ME", "RV", "SR", "WI", "MU", "MP", "WI", "WI", "SI", "SI",…
$ REGION_N   &lt;chr&gt; "CENTRAL REGION", "CENTRAL REGION", "CENTRAL REGION", "WEST…
$ REGION_C   &lt;chr&gt; "CR", "CR", "CR", "WR", "CR", "CR", "WR", "WR", "CR", "CR",…
$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((33222.98 29..., MULTIPOLYGON (…</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="geospatial-data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="geospatial-data-wrangling"><strong>6 Geospatial data wrangling</strong></h2>
<section id="combining-busstop-and-mpsz" class="level3">
<h3 class="anchored" data-anchor-id="combining-busstop-and-mpsz">Combining Busstop and mpsz</h3>
<p>Code chunk below populates the planning subzone code (i.e.&nbsp;SUBZONE_C) of mpsz sf data frame into busstop sf data frame.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>busstop_mpsz <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(BusStop, mpsz) <span class="sc">%&gt;%</span>   </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(BUS_STOP_N, SUBZONE_C) <span class="sc">%&gt;%</span>   <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attribute variables are assumed to be spatially constant throughout
all geometries</code></pre>
</div>
</div>
<p>Before moving to the next step, save the output into rds format.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(busstop_mpsz, <span class="st">"data/rds/busstop_mpsz.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, append the planning subzone code from busstop_mpsz data frame onto origin_WDMP (origin &amp; destination) data frame.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>origin_SZ <span class="ot">&lt;-</span> <span class="fu">left_join</span>(origin_WDMP , busstop_mpsz,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ORIGIN_PT_CODE"</span> <span class="ot">=</span> <span class="st">"BUS_STOP_N"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ORIGIN_BS =</span> ORIGIN_PT_CODE,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_SZ =</span> SUBZONE_C) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ORIGIN_SZ) <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TOT_TRIPS =</span> <span class="fu">sum</span>(TRIPS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>dest_SZ <span class="ot">&lt;-</span> <span class="fu">left_join</span>(dest_WDMP , busstop_mpsz,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"DESTINATION_PT_CODE"</span> <span class="ot">=</span> <span class="st">"BUS_STOP_N"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">DEST_BS =</span> DESTINATION_PT_CODE,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">DEST_SZ =</span> SUBZONE_C) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(DEST_SZ) <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TOT_TRIPS =</span> <span class="fu">sum</span>(TRIPS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>all_SZ <span class="ot">&lt;-</span> <span class="fu">left_join</span>(all_WDMP , busstop_mpsz,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ORIGIN_PT_CODE"</span> <span class="ot">=</span> <span class="st">"BUS_STOP_N"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ORIGIN_BS =</span> ORIGIN_PT_CODE,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_SZ =</span> SUBZONE_C,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">DEST_BS =</span> DESTINATION_PT_CODE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in left_join(all_WDMP, busstop_mpsz, by = c(ORIGIN_PT_CODE = "BUS_STOP_N")): Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 25632 of `x` matches multiple rows in `y`.
ℹ Row 673 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>all_SZ <span class="ot">&lt;-</span> <span class="fu">left_join</span>(all_SZ , busstop_mpsz,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"DEST_BS"</span> <span class="ot">=</span> <span class="st">"BUS_STOP_N"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in left_join(all_SZ, busstop_mpsz, by = c(DEST_BS = "BUS_STOP_N")): Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 167 of `x` matches multiple rows in `y`.
ℹ Row 672 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>all_SZ <span class="ot">&lt;-</span> all_SZ <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">DEST_SZ =</span> SUBZONE_C) <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ORIGIN_SZ, DEST_SZ) <span class="sc">%&gt;%</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TOT_TRIPS =</span> <span class="fu">sum</span>(TRIPS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ORIGIN_SZ'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p>Next, merge the origin_BS &amp; dest_BS with busstop_mpsz data frame.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>origin_BS <span class="ot">&lt;-</span> <span class="fu">merge</span>(origin_WDMP, busstop_mpsz, <span class="at">by.x =</span> <span class="st">"ORIGIN_PT_CODE"</span>, <span class="at">by.y =</span> <span class="st">"BUS_STOP_N"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>(<span class="at">ORIGIN_BS =</span> ORIGIN_PT_CODE, <span class="at">ORIGIN_SZ =</span> SUBZONE_C) <span class="sc">%&gt;%</span>   </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(ORIGIN_BS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>dest_BS <span class="ot">&lt;-</span> <span class="fu">merge</span>(dest_WDMP, busstop_mpsz, <span class="at">by.x =</span> <span class="st">"DESTINATION_PT_CODE"</span>, <span class="at">by.y =</span> <span class="st">"BUS_STOP_N"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>(<span class="at">DEST_BS =</span> DESTINATION_PT_CODE, <span class="at">DEST_SZ =</span> SUBZONE_C) <span class="sc">%&gt;%</span>   </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(DEST_BS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>============== #| code-fold: true #| code-summary: “Show the code” origin_SZ &lt;- left_join(origin_WDAP_5_8 , busstop_mpsz,<br>
by = c(“ORIGIN_PT_CODE” = “BUS_STOP_N”)) %&gt;%<br>
rename(ORIGIN_BS = ORIGIN_PT_CODE,<br>
ORIGIN_SZ = SUBZONE_C) %&gt;%<br>
group_by(ORIGIN_SZ) %&gt;%<br>
summarise(TOT_TRIPS = sum(TRIPS)) ===============</p>
<p>Check for duplicate records</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>duplicate_origin_BS <span class="ot">&lt;-</span> origin_BS <span class="sc">%&gt;%</span>   </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by_all</span>() <span class="sc">%&gt;%</span>   </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>duplicate_origin_SZ <span class="ot">&lt;-</span> origin_SZ <span class="sc">%&gt;%</span>   </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by_all</span>() <span class="sc">%&gt;%</span>   </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>duplicate_dest_BS <span class="ot">&lt;-</span> dest_BS <span class="sc">%&gt;%</span>   </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by_all</span>() <span class="sc">%&gt;%</span>   </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>duplicate_dest_SZ <span class="ot">&lt;-</span> dest_SZ <span class="sc">%&gt;%</span>   </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by_all</span>() <span class="sc">%&gt;%</span>   </span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>See if any duplicate records.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(duplicate_origin_BS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 26
Columns: 3
$ ORIGIN_BS &lt;fct&gt; 11009, 11009, 22501, 22501, 43709, 43709, 47201, 47201, 5107…
$ TRIPS     &lt;dbl&gt; 17311, 17311, 11384, 11384, 1329, 1329, 25910, 25910, 6698, …
$ ORIGIN_SZ &lt;chr&gt; "QTSZ01", "QTSZ01", "JWSZ09", "JWSZ09", "BKSZ07", "BKSZ07", …</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(duplicate_origin_SZ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 0
Columns: 2
$ ORIGIN_SZ &lt;chr&gt; 
$ TOT_TRIPS &lt;dbl&gt; </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(duplicate_dest_BS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 26
Columns: 3
$ DEST_BS &lt;fct&gt; 11009, 11009, 22501, 22501, 43709, 43709, 47201, 47201, 51071,…
$ TRIPS   &lt;dbl&gt; 895, 895, 3666, 3666, 3573, 3573, 26477, 26477, 10279, 10279, …
$ DEST_SZ &lt;chr&gt; "QTSZ01", "QTSZ01", "JWSZ09", "JWSZ09", "BKSZ07", "BKSZ07", "W…</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(duplicate_dest_SZ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 0
Columns: 2
$ DEST_SZ   &lt;chr&gt; 
$ TOT_TRIPS &lt;dbl&gt; </code></pre>
</div>
</div>
<p>As shown above, there are duplicates. We can remove duplicate records (if any) with the following code.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>origin_BS <span class="ot">&lt;-</span> <span class="fu">unique</span>(origin_BS)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>origin_SZ <span class="ot">&lt;-</span> <span class="fu">unique</span>(origin_SZ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>dest_BS <span class="ot">&lt;-</span> <span class="fu">unique</span>(dest_BS)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>dest_SZ <span class="ot">&lt;-</span> <span class="fu">unique</span>(dest_SZ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, write a code chunk to update od_data data frame with the planning subzone codes.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>origintrip_BS <span class="ot">&lt;-</span> <span class="fu">left_join</span>(BusStop, origin_BS,                            </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"BUS_STOP_N"</span> <span class="ot">=</span> <span class="st">"ORIGIN_BS"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sf_column %in% names(g): Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 149 of `x` matches multiple rows in `y`.
ℹ Row 3044 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>origintrip_SZ <span class="ot">&lt;-</span> <span class="fu">left_join</span>(mpsz, </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                           origin_SZ,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SUBZONE_C"</span> <span class="ot">=</span> <span class="st">"ORIGIN_SZ"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>desttrip_BS <span class="ot">&lt;-</span> <span class="fu">left_join</span>(BusStop, dest_BS,                            </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"BUS_STOP_N"</span> <span class="ot">=</span> <span class="st">"DEST_BS"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sf_column %in% names(g): Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 149 of `x` matches multiple rows in `y`.
ℹ Row 3047 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>desttrip_SZ <span class="ot">&lt;-</span> <span class="fu">left_join</span>(mpsz, </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>                           dest_SZ,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SUBZONE_C"</span> <span class="ot">=</span> <span class="st">"DEST_SZ"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Drop points without data (i.e.&nbsp;trip)</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>non_finite_indices <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.finite</span>(origintrip_BS<span class="sc">$</span>TRIPS))</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>origintrip_BS<span class="sc">$</span>TRIPS[<span class="sc">!</span><span class="fu">is.finite</span>(origintrip_BS<span class="sc">$</span>TRIPS)] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>non_finite_indices <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.finite</span>(origintrip_SZ<span class="sc">$</span>TOT_TRIPS))</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>origintrip_SZ<span class="sc">$</span>TOT_TRIPS[<span class="sc">!</span><span class="fu">is.finite</span>(origintrip_SZ<span class="sc">$</span>TOT_TRIPS)] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>non_finite_indices <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.finite</span>(desttrip_BS<span class="sc">$</span>TRIPS))</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>desttrip_BS<span class="sc">$</span>TRIPS[<span class="sc">!</span><span class="fu">is.finite</span>(desttrip_BS<span class="sc">$</span>TRIPS)] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>non_finite_indices <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.finite</span>(desttrip_SZ<span class="sc">$</span>TOT_TRIPS))</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>desttrip_SZ<span class="sc">$</span>TOT_TRIPS[<span class="sc">!</span><span class="fu">is.finite</span>(desttrip_SZ<span class="sc">$</span>TOT_TRIPS)] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="choropleth-visualisation" class="level2">
<h2 class="anchored" data-anchor-id="choropleth-visualisation"><strong>7 Choropleth Visualisation</strong></h2>
<p>Prepare a choropleth map showing the distribution of passenger trips at planning sub-zone level.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(origintrip_BS)<span class="sc">+</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_symbols</span>(<span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Passenger trips generated at origin bus-stop level"</span>,</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>, </span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>() <span class="sc">+</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(desttrip_BS)<span class="sc">+</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_symbols</span>(<span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Passenger trips generated at destination bus-stop level"</span>,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>, </span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>() <span class="sc">+</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(origintrip_SZ)<span class="sc">+</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"TOT_TRIPS"</span>, </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>, </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"Blues"</span>,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Passenger trips"</span>) <span class="sc">+</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Passenger trips generated at planning sub-zone level (Origin)"</span>,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>, </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>() <span class="sc">+</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(desttrip_SZ)<span class="sc">+</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"TOT_TRIPS"</span>, </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>, </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"Blues"</span>,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Passenger trips"</span>) <span class="sc">+</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Passenger trips generated at planning sub-zone level (Destination)"</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>, </span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>() <span class="sc">+</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="visualising-spatial-interaction" class="level2">
<h2 class="anchored" data-anchor-id="visualising-spatial-interaction"><strong>8 Visualising Spatial Interaction</strong></h2>
<p>Prepare a desire line by using stplanr package.</p>
<section id="removing-intra-zonal-flows" class="level3">
<h3 class="anchored" data-anchor-id="removing-intra-zonal-flows">Removing intra-zonal flows</h3>
<p>The code chunk below will be used to remove intra-zonal flows.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>all_SZ_R <span class="ot">&lt;-</span> all_SZ[all_SZ<span class="sc">$</span>ORIGIN_SZ <span class="sc">!=</span> all_SZ<span class="sc">$</span>DEST_SZ,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="creating-desire-lines" class="level3">
<h3 class="anchored" data-anchor-id="creating-desire-lines">Creating desire lines</h3>
<p>In this code chunk below, od2line() of stplanr package is used to create the desire lines.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>flowLine <span class="ot">&lt;-</span> <span class="fu">od2line</span>(<span class="at">flow =</span> all_SZ_R, </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">zones =</span> mpsz,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">zone_code =</span> <span class="st">"SUBZONE_C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Creating centroids representing desire line start and end points.</code></pre>
</div>
</div>
</section>
<section id="visualising-the-desire-lines" class="level3">
<h3 class="anchored" data-anchor-id="visualising-the-desire-lines">Visualising the desire lines</h3>
<p>To visualise the resulting desire lines, the code chunk below is used.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>flowLine <span class="sc">%&gt;%</span>  </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"TOT_TRIPS"</span>,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>),</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">6</span>,</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in g$scale * (w_legend/maxW): longer object length is not a multiple of
shorter object length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in g$scale * (x/maxW): longer object length is not a multiple of
shorter object length</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>When the flow data are very messy and highly skewed like the one shown above, it is wiser to focus on selected flows, for example flow greater than or equal to 5000 as shown below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>flowLine <span class="sc">%&gt;%</span>  </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TOT_TRIPS <span class="sc">&gt;=</span> <span class="dv">5000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"TOT_TRIPS"</span>,</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>),</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">6</span>,</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in g$scale * (w_legend/maxW): longer object length is not a multiple of
shorter object length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in g$scale * (x/maxW): longer object length is not a multiple of
shorter object length</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="geocoding-using-sla-api" class="level2">
<h2 class="anchored" data-anchor-id="geocoding-using-sla-api"><strong>9 Geocoding using SLA API</strong></h2>
<p>Address geocoding, or simply geocoding, is the process of taking a aspatial description of a location, such as an address or postcode, and returning geographic coordinates, frequently latitude/longitude pair, to identify a location on the Earth’s surface.</p>
<p>Singapore Land Authority (SLA) supports an online geocoding service called OneMap API. The Search API looks up the address data or 6-digit postal code for an entered value. It then returns both latitude, longitude and x,y coordinates of the searched location.</p>
<p>The code chunks below will perform geocoding using SLA OneMap API. The input data will be in csv file format. It will be read into R Studio environment using read_csv function of readr package. A collection of http call functions of httr package of R will then be used to pass the individual records to the geocoding server at OneMap.</p>
<p>Two tibble data.frames will be created if the geocoding process completed successfully. They are called found and not_found. found contains all records that are geocoded correctly and not_found contains postal that failed to be geocoded.</p>
<p>Lastly, the found data table will joined with the initial csv data table by using a unique identifier (i.e.&nbsp;POSTAL) common to both data tables. The output data table will then save as an csv file called found.</p>
<p>======================= url&lt;-“https://www.onemap.gov.sg/api/common/elastic/search”</p>
<p>csv&lt;-read_csv(“data/aspatial/Generalinformationofschools.csv”)</p>
<p>postcodes&lt;-csv$<code>postal_code</code></p>
<p>found&lt;-data.frame() not_found&lt;-data.frame()</p>
<p>for(postcode in postcodes){ query&lt;-list(‘searchVal’=postcode,‘returnGeom’=‘Y’,‘getAddrDetails’=‘Y’,‘pageNum’=‘1’) res&lt;- GET(url,query=query)</p>
<p>if((content(res)$found)!=0){ found&lt;-rbind(found,data.frame(content(res))[4:13]) } else{ not_found = data.frame(postcode) } } =======================</p>
<p>Since we have done it during in-class ex4, we just need to read the csv that was prepared.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>schools <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/schools.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">latitude =</span> <span class="st">"results.LATITUDE"</span>,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">longitude =</span> <span class="st">"results.LONGITUDE"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(postal_code, school_name, latitude, longitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 350 Columns: 41
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(36): postal_code, school_name, url_address, address, telephone_no, tele... dbl
(5): ...1, results.X, results.Y, results.LATITUDE, results.LONGITUDE
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...1`</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>non_finite_indices <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.finite</span>(schools<span class="sc">$</span>latitude))</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>schools<span class="sc">$</span>latitude[<span class="sc">!</span><span class="fu">is.finite</span>(schools<span class="sc">$</span>latitude)] <span class="ot">&lt;-</span> <span class="fl">1.3887</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>non_finite_indices <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.finite</span>(schools<span class="sc">$</span>longitude))</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>schools<span class="sc">$</span>longitude[<span class="sc">!</span><span class="fu">is.finite</span>(schools<span class="sc">$</span>longitude)] <span class="ot">&lt;-</span> <span class="fl">103.7652</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Converting an aspatial data into sf tibble data.frame Next, convert schools tibble data.frame data into a simple feature tibble data.frame called schools_sf by using values in latitude and longitude fields.</p>
<p>Refer to st_as_sf() of sf package.</p>
<p>Must code longitude first before latitude. This combines both longitude and latitude into Geometry coordinates. (crs = 4326) Subsequently (crs = 3414) converts it into metres in Singapore context.</p>
<p>Show the code chunk</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>schools_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(schools, </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>),</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Using the steps you learned in previous exercises, create a point symbol map showing the location of schools with OSM as the background map.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(schools_sf) <span class="sc">+</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The shape mpsz is invalid. See sf::st_is_valid</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="performing-point-in-polygon-count-process" class="level2">
<h2 class="anchored" data-anchor-id="performing-point-in-polygon-count-process"><strong>10 Performing point-in-polygon count process</strong></h2>
<p>Next, we will count the number of schools located inside the planning subzones.</p>
<p>Count the number of schools within each planning subzone by using lengths() of Base and st_intersects() of sf package.</p>
<p>Show the code chunk</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>mpsz<span class="sc">$</span><span class="st">`</span><span class="at">SCHOOL_COUNT</span><span class="st">`</span><span class="ot">&lt;-</span> <span class="fu">lengths</span>(</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersects</span>(</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    mpsz, schools_sf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Compute and display the summary statistics of sch_count field.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mpsz<span class="sc">$</span>SCHOOL_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.000   0.000   0.000   1.054   2.000  12.000 </code></pre>
</div>
</div>
<p>The summary statistics above reveals that there are excessive 0 values in SCHOOL_COUNT field. If log() is going to be used to transform this field, additional step is required to ensure that all 0 will be replaced with a value between 0 and 1 but neither 0 nor 1.</p>
</section>
<section id="data-integration-and-final-touch-up" class="level2">
<h2 class="anchored" data-anchor-id="data-integration-and-final-touch-up"><strong>11 Data Integration and Final Touch-up</strong></h2>
<p>Using the steps you learned in earlier sub-sections, count the number of Business points in each planning subzone.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>business_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">layer =</span> <span class="st">"Business"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Business' from data source 
  `C:\chiays\ISS624\Take-home_Ex\Take-home_Ex2\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 6550 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 3669.148 ymin: 25408.41 xmax: 47034.83 ymax: 50148.54
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
</div>
<p>Next, we will count the number of business located inside the planning subzones.</p>
<p>Count the number of schools within each planning subzone by using lengths() of Base and st_intersects() of sf package.</p>
<p>Show the code chunk</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>mpsz<span class="sc">$</span><span class="st">`</span><span class="at">BUSINESS_COUNT</span><span class="st">`</span><span class="ot">&lt;-</span> <span class="fu">lengths</span>(</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersects</span>(</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>    mpsz, business_sf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Compute and display the summary statistics of sch_count field.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mpsz<span class="sc">$</span>BUSINESS_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00    0.00    2.00   19.73   13.00  307.00 </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(business_sf) <span class="sc">+</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The shape mpsz is invalid. See sf::st_is_valid</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>mpsz<span class="sc">$</span><span class="st">`</span><span class="at">BUSINESS_COUNT</span><span class="st">`</span><span class="ot">&lt;-</span> <span class="fu">lengths</span>(</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersects</span>(</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    mpsz, business_sf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mpsz<span class="sc">$</span>BUSINESS_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00    0.00    2.00   19.73   13.00  307.00 </code></pre>
</div>
</div>
<p>Now, it is time for us to bring in the flow_data.rds saved after Hands-on Exercise 3.</p>
<p>Show the code chunk</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>flow_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/flow_data_tidy.rds"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">TRIPS =</span> MORNING_PEAK)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span><span class="st">`</span><span class="at">BUSINESS_COUNT</span><span class="st">`</span><span class="ot">&lt;-</span> <span class="fu">lengths</span>(</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersects</span>(</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    flow_data, mpsz))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="calibrating-spatial-interaction-models-with-r" class="level2">
<h2 class="anchored" data-anchor-id="calibrating-spatial-interaction-models-with-r"><strong>12 Calibrating Spatial Interaction Models with R</strong></h2>
<p>Spatial Interaction Models (SIMs) are mathematical models for estimating flows between spatial entities developed by Alan Wilson in the late 1960s and early 1970, with considerable uptake and refinement for transport modelling since then Boyce and Williams (2015).</p>
<p>There are four main types of traditional SIMs (Wilson 1971):</p>
<ul>
<li>Unconstrained</li>
<li>Production-constrained</li>
<li>Attraction-constrained</li>
<li>Doubly-constrained</li>
</ul>
<p>Ordinary least square (OLS), log-normal, Poisson and negative binomial (NB) regression methods have been used extensively to calibrate OD flow models by processing flow data as different types of dependent variables. In this chapter, you will gain hands-on experiences on using appropriate R packages to calibrate SIM by using there four regression methods.</p>
</section>
<section id="calibrate-sim" class="level2">
<h2 class="anchored" data-anchor-id="calibrate-sim"><strong>13 Calibrate SIM</strong></h2>
<p>We are going to calibrate SIM to determine factors affecting the public bus passenger flows during the morning peak in Singapore. The four r packages that will be used are:</p>
<ul>
<li>sf for importing, integrating, processing and transforming geospatial data.</li>
<li>tidyverse for importing, integrating, wrangling and visualising data.</li>
<li>tmap for creating thematic maps.</li>
</ul>
<p>Additional R packages will be loaded.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sp, DT, performance, reshape2, ggpubr, units)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol type="1">
<li><p>DT: Purpose: The DT package is used for creating interactive tables in R Markdown documents, Shiny applications, and R scripts. It allows users to interact with the data by sorting, filtering, and exporting tables.</p></li>
<li><p>reshape2: Purpose: The reshape2 package is used for data reshaping and restructuring. It provides functions like melt and dcast that help transform data between wide and long formats.</p></li>
<li><p>ggpubr: Purpose: The ggpubr package extends the capabilities of the popular ggplot2 package. It provides functions to create complex plots easily, including grouped boxplots, scatter plots, correlation matrices, and more.</p></li>
<li><p>units: Purpose: The units package is used for working with physical units in R. It allows to attach units to numeric values and perform arithmetic operations while taking units into account. This is useful in scientific and engineering applications.</p></li>
</ol>
</section>
<section id="computing-distance-matrix" class="level2">
<h2 class="anchored" data-anchor-id="computing-distance-matrix"><strong>14 Computing Distance Matrix</strong></h2>
<section id="converting-from-sf-data.table-to-spatialpolygonsdataframe" class="level3">
<h3 class="anchored" data-anchor-id="converting-from-sf-data.table-to-spatialpolygonsdataframe">Converting from sf data.table to SpatialPolygonsDataFrame</h3>
<p>There are at least two ways to compute the required distance matrix. One is based on sf and the other is based on sp. Past experience shown that computing distance matrix by using sf function took relatively longer time that sp method especially the data set is large. In view of this, sp method is used in the code chunks below.</p>
<p>First as.Spatial() will be used to convert mpsz from sf tibble data frame to SpatialPolygonsDataFrame of sp object as shown in the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>mpsz_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(mpsz, <span class="st">"Spatial"</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>mpsz_sp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPolygonsDataFrame 
features    : 332 
extent      : 2667.538, 56396.44, 15748.72, 50256.33  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 8
names       : SUBZONE_N, SUBZONE_C, PLN_AREA_N, PLN_AREA_C,       REGION_N, REGION_C, SCHOOL_COUNT, BUSINESS_COUNT 
min values  : ADMIRALTY,    AMSZ01, ANG MO KIO,         AM, CENTRAL REGION,       CR,            0,              0 
max values  :    YUNNAN,    YSSZ09,     YISHUN,         YS,    WEST REGION,       WR,           12,            307 </code></pre>
</div>
</div>
</section>
<section id="computing-the-distance-matrix" class="level3">
<h3 class="anchored" data-anchor-id="computing-the-distance-matrix">Computing the distance matrix</h3>
<p>Next, spDists() of sp package will be used to compute the Euclidean distance between the centroids of the planning subzones.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">spDists</span>(mpsz_sp, </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dist, <span class="at">n=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]       [,2]      [,3]      [,4]       [,5]      [,6]      [,7]
 [1,]     0.000  3926.0025  3939.108 20252.964  2989.9839  1431.330 19211.836
 [2,]  3926.003     0.0000   305.737 16513.865   951.8314  5254.066 16242.523
 [3,]  3939.108   305.7370     0.000 16412.062  1045.9088  5299.849 16026.146
 [4,] 20252.964 16513.8648 16412.062     0.000 17450.3044 21665.795  7229.017
 [5,]  2989.984   951.8314  1045.909 17450.304     0.0000  4303.232 17020.916
 [6,]  1431.330  5254.0664  5299.849 21665.795  4303.2323     0.000 20617.082
 [7,] 19211.836 16242.5230 16026.146  7229.017 17020.9161 20617.082     0.000
 [8,] 14960.942 12749.4101 12477.871 11284.279 13336.0421 16281.453  5606.082
 [9,]  7515.256  7934.8082  7649.776 18427.503  7801.6163  8403.896 14810.930
[10,]  6391.342  4975.0021  4669.295 15469.566  5226.8731  7707.091 13111.391
           [,8]      [,9]     [,10]
 [1,] 14960.942  7515.256  6391.342
 [2,] 12749.410  7934.808  4975.002
 [3,] 12477.871  7649.776  4669.295
 [4,] 11284.279 18427.503 15469.566
 [5,] 13336.042  7801.616  5226.873
 [6,] 16281.453  8403.896  7707.091
 [7,]  5606.082 14810.930 13111.391
 [8,]     0.000  9472.024  8575.490
 [9,]  9472.024     0.000  3780.800
[10,]  8575.490  3780.800     0.000</code></pre>
</div>
</div>
<p>Notice that the output dist is a matrix column headers and row headers are not labeled with the planning subzone codes.</p>
</section>
<section id="labelling-column-and-row-heanders-of-a-distance-matrix" class="level3">
<h3 class="anchored" data-anchor-id="labelling-column-and-row-heanders-of-a-distance-matrix">Labelling column and row heanders of a distance matrix</h3>
<p>Create a list sorted according to the the distance matrix by planning sub-zone code.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>sz_names <span class="ot">&lt;-</span> mpsz<span class="sc">$</span>SUBZONE_C</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Attach SUBZONE_C to row and column for distance matrix matching ahead</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dist) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(sz_names)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(dist) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(sz_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="pivoting-distance-value-by-subzone_c" class="level3">
<h3 class="anchored" data-anchor-id="pivoting-distance-value-by-subzone_c">Pivoting distance value by SUBZONE_C</h3>
<p>Pivot the distance matrix into a long table by using the row and column subzone codes as show in the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="ot">&lt;-</span> <span class="fu">melt</span>(dist) <span class="sc">%&gt;%</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dist =</span> value)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(distPair, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     Var1   Var2      dist
1  MESZ01 MESZ01     0.000
2  RVSZ05 MESZ01  3926.003
3  SRSZ01 MESZ01  3939.108
4  WISZ01 MESZ01 20252.964
5  MUSZ02 MESZ01  2989.984
6  MPSZ05 MESZ01  1431.330
7  WISZ03 MESZ01 19211.836
8  WISZ02 MESZ01 14960.942
9  SISZ02 MESZ01  7515.256
10 SISZ01 MESZ01  6391.342</code></pre>
</div>
</div>
<p>Notice that within zone distance is 0.</p>
</section>
<section id="updating-intra-zonal-distances" class="level3">
<h3 class="anchored" data-anchor-id="updating-intra-zonal-distances">Updating intra-zonal distances</h3>
<p>We shall append a constant value to replace the intra-zonal distance of 0. First, we will select and find out the minimum value of the distance by using summary().</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="sc">%&gt;%</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dist <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Var1             Var2             dist        
 MESZ01 :   331   MESZ01 :   331   Min.   :  173.8  
 RVSZ05 :   331   RVSZ05 :   331   1st Qu.: 7149.5  
 SRSZ01 :   331   SRSZ01 :   331   Median :11890.0  
 WISZ01 :   331   WISZ01 :   331   Mean   :12229.4  
 MUSZ02 :   331   MUSZ02 :   331   3rd Qu.:16401.7  
 MPSZ05 :   331   MPSZ05 :   331   Max.   :49894.4  
 (Other):107906   (Other):107906                    </code></pre>
</div>
</div>
<p>Since the minimum distance is 173.8, we apply a constant distance value of 50m for intra-zones distance.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>distPair<span class="sc">$</span>dist <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(distPair<span class="sc">$</span>dist <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">50</span>, distPair<span class="sc">$</span>dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk below will be used to check the result data.frame.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="sc">%&gt;%</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Var1             Var2             dist      
 MESZ01 :   332   MESZ01 :   332   Min.   :   50  
 RVSZ05 :   332   RVSZ05 :   332   1st Qu.: 7097  
 SRSZ01 :   332   SRSZ01 :   332   Median :11864  
 WISZ01 :   332   WISZ01 :   332   Mean   :12193  
 MUSZ02 :   332   MUSZ02 :   332   3rd Qu.:16388  
 MPSZ05 :   332   MPSZ05 :   332   Max.   :49894  
 (Other):108232   (Other):108232                  </code></pre>
</div>
</div>
<p>The code chunk below is used to rename the origin and destination fields.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="ot">&lt;-</span> distPair <span class="sc">%&gt;%</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">orig =</span> Var1,</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">dest =</span> Var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Lastly, the code chunk below is used to save the dataframe for future use.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(distPair, <span class="st">"data/rds/distPair.rds"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="separating-intra-flow-from-passenger-volume-df" class="level2">
<h2 class="anchored" data-anchor-id="separating-intra-flow-from-passenger-volume-df"><strong>15 Separating intra-flow from passenger volume df</strong></h2>
<p>Code chunk below is used to add three new fields in flow_data dataframe.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>FlowNoIntra <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  flow_data<span class="sc">$</span>ORIGIN_SZ <span class="sc">==</span> flow_data<span class="sc">$</span>DESTIN_SZ, </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>, flow_data<span class="sc">$</span>TRIPS)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>offset <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>  flow_data<span class="sc">$</span>ORIGIN_SZ <span class="sc">==</span> flow_data<span class="sc">$</span>DESTIN_SZ, </span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.000001</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>According to the syntax used to derive values in FlowNoIntra field, all intra-zonal flow will be given a value of 0 or else the original flow values will be inserted.</p>
<p>Next, inter-zonal flow will be selected from flow_data and save into a new output data.frame called inter_zonal_flow by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>inter_zonal_flow <span class="ot">&lt;-</span> flow_data <span class="sc">%&gt;%</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FlowNoIntra <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="combining-passenger-volume-data-with-distance-value" class="level2">
<h2 class="anchored" data-anchor-id="combining-passenger-volume-data-with-distance-value"><strong>16 Combining passenger volume data with distance value</strong></h2>
<p>Before we can join flow_data and distPair, we need to convert data value type of ORIGIN_SZ and DESTIN_SZ fields of flow_data dataframe into factor data type.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>ORIGIN_SZ <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(flow_data<span class="sc">$</span>ORIGIN_SZ)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>DESTIN_SZ <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(flow_data<span class="sc">$</span>DESTIN_SZ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, left_join() of dplyr will be used to flow_data dataframe and distPair dataframe. The output is called flow_data1.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>flow_data1 <span class="ot">&lt;-</span> flow_data <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span> (distPair,</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ORIGIN_SZ"</span> <span class="ot">=</span> <span class="st">"orig"</span>,</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"DESTIN_SZ"</span> <span class="ot">=</span> <span class="st">"dest"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="preparing-origin-and-destination-attributes" class="level2">
<h2 class="anchored" data-anchor-id="preparing-origin-and-destination-attributes"><strong>17 Preparing Origin and Destination Attributes</strong></h2>
<section id="importing-population-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-population-data">Importing population data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/pop.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 332 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): PA, SZ
dbl (3): AGE7_12, AGE13_24, AGE25_64

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
</section>
<section id="geospatial-data-wrangling-1" class="level3">
<h3 class="anchored" data-anchor-id="geospatial-data-wrangling-1">Geospatial data wrangling</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> pop <span class="sc">%&gt;%</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mpsz,</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"PA"</span> <span class="ot">=</span> <span class="st">"PLN_AREA_N"</span>,</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"SZ"</span> <span class="ot">=</span> <span class="st">"SUBZONE_N"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">SZ_NAME =</span> SZ,</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">SZ =</span> SUBZONE_C)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="preparing-origin-attribute" class="level3">
<h3 class="anchored" data-anchor-id="preparing-origin-attribute">Preparing origin attribute</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>flow_data1 <span class="ot">&lt;-</span> flow_data1 <span class="sc">%&gt;%</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pop,</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="at">ORIGIN_SZ =</span> <span class="st">"SZ"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(PA, SZ_NAME))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="preparing-destination-attribute" class="level4">
<h4 class="anchored" data-anchor-id="preparing-destination-attribute">Preparing destination attribute</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>flow_data1 <span class="ot">&lt;-</span> flow_data1 <span class="sc">%&gt;%</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pop,</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="at">DESTIN_SZ =</span> <span class="st">"SZ"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(PA, SZ_NAME))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will called the output data file SIM_data. it is in rds data file format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(flow_data1, <span class="st">"data/rds/SIM_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="calibrating-spatial-interaction-models" class="level3">
<h3 class="anchored" data-anchor-id="calibrating-spatial-interaction-models">Calibrating Spatial Interaction Models</h3>
<p>In this section, you will learn how to calibrate Spatial Interaction Models by using Poisson Regression method.</p>
<section id="importing-the-modelling-data" class="level4">
<h4 class="anchored" data-anchor-id="importing-the-modelling-data">Importing the modelling data</h4>
<p>Firstly, let us import the modelling data by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/SIM_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dist =</span> dist.x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualising-the-dependent-variable-firstly-let-us-plot-the-distribution-of-the-dependent-variable-i.e.-trips-by-using-histogram-method-by-using-the-code-chunk-below." class="level4">
<h4 class="anchored" data-anchor-id="visualising-the-dependent-variable-firstly-let-us-plot-the-distribution-of-the-dependent-variable-i.e.-trips-by-using-histogram-method-by-using-the-code-chunk-below.">Visualising the dependent variable Firstly, let us plot the distribution of the dependent variable (i.e.&nbsp;TRIPS) by using histogram method by using the code chunk below.</h4>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Notice that the distribution is highly skewed and not resemble bell shape or also known as normal distribution.</p>
<p>Next, let us visualise the relation between the dependent variable and one of the key independent variable in Spatial Interaction Model, namely distance.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> dist,</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Notice that their relationship hardly resemble linear relationship.</p>
<p>On the other hand, if we plot the scatter plot by using the log transformed version of both variables, we can see that their relationship is more resemble linear relationship.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(dist),</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">log</span>(TRIPS))) <span class="sc">+</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="checking-for-variables-with-zero-values" class="level4">
<h4 class="anchored" data-anchor-id="checking-for-variables-with-zero-values">Checking for variables with zero values</h4>
<p>Since Poisson Regression is based of log and log 0 is undefined, it is important for us to ensure that no 0 values in the explanatory variables.</p>
<p>In the code chunk below, summary() of Base R is used to compute the summary statistics of all variables in SIM_data data frame.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SIM_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  ORIGIN_SZ          DESTIN_SZ             TRIPS             dist      
 Length:14734       Length:14734       Min.   :     1   Min.   :   50  
 Class :character   Class :character   1st Qu.:    14   1st Qu.: 3346  
 Mode  :character   Mode  :character   Median :    76   Median : 6067  
                                       Mean   :  1021   Mean   : 6880  
                                       3rd Qu.:   426   3rd Qu.: 9729  
                                       Max.   :232187   Max.   :26136  
 ORIGIN_AGE7_12    ORIGIN_AGE13_24    ORIGIN_AGE25_64    DESTIN_AGE7_12   
 Min.   :   0.99   Min.   :    0.99   Min.   :    0.99   Min.   :   0.99  
 1st Qu.: 240.00   1st Qu.:  440.00   1st Qu.: 2200.00   1st Qu.: 240.00  
 Median : 700.00   Median : 1350.00   Median : 6810.00   Median : 720.00  
 Mean   :1031.86   Mean   : 2268.84   Mean   :10487.62   Mean   :1033.40  
 3rd Qu.:1480.00   3rd Qu.: 3260.00   3rd Qu.:15770.00   3rd Qu.:1500.00  
 Max.   :6340.00   Max.   :16380.00   Max.   :74610.00   Max.   :6340.00  
 DESTIN_AGE13_24    DESTIN_AGE25_64     SCHOOL_COUNT     RETAIL_COUNT   
 Min.   :    0.99   Min.   :    0.99   Min.   : 0.990   Min.   :  0.99  
 1st Qu.:  460.00   1st Qu.: 2200.00   1st Qu.: 0.990   1st Qu.:  0.99  
 Median : 1420.00   Median : 7030.00   Median : 1.000   Median :  3.00  
 Mean   : 2290.35   Mean   :10574.46   Mean   : 1.987   Mean   : 16.47  
 3rd Qu.: 3260.00   3rd Qu.:15830.00   3rd Qu.: 2.000   3rd Qu.: 12.00  
 Max.   :16380.00   Max.   :74610.00   Max.   :12.000   Max.   :307.00  
 BUSINESS_COUNT    FlowNoIntra           offset             dist.y     
 Min.   : 0.000   Min.   :     0.0   Min.   :0.000001   Min.   :   50  
 1st Qu.: 5.000   1st Qu.:    13.0   1st Qu.:1.000000   1st Qu.: 3346  
 Median : 8.000   Median :    70.0   Median :1.000000   Median : 6067  
 Mean   : 8.567   Mean   :   839.9   Mean   :0.982150   Mean   : 6880  
 3rd Qu.:12.000   3rd Qu.:   379.0   3rd Qu.:1.000000   3rd Qu.: 9729  
 Max.   :32.000   Max.   :148274.0   Max.   :1.000000   Max.   :26136  
   AGE7_12.x      AGE13_24.x      AGE25_64.x      AGE7_12.y      AGE13_24.y   
 Min.   :   0   Min.   :    0   Min.   :    0   Min.   :   0   Min.   :    0  
 1st Qu.: 240   1st Qu.:  440   1st Qu.: 2200   1st Qu.: 240   1st Qu.:  460  
 Median : 700   Median : 1350   Median : 6810   Median : 720   Median : 1420  
 Mean   :1032   Mean   : 2269   Mean   :10487   Mean   :1033   Mean   : 2290  
 3rd Qu.:1480   3rd Qu.: 3260   3rd Qu.:15770   3rd Qu.:1500   3rd Qu.: 3260  
 Max.   :6340   Max.   :16380   Max.   :74610   Max.   :6340   Max.   :16380  
   AGE25_64.y             geometry    
 Min.   :    0   LINESTRING   :14734  
 1st Qu.: 2200   epsg:3414    :    0  
 Median : 7030   +proj=tmer...:    0  
 Mean   :10574                        
 3rd Qu.:15830                        
 Max.   :74610                        </code></pre>
</div>
</div>
<p>The print report above reveals that variables ORIGIN_AGE7_12, ORIGIN_AGE13_24, ORIGIN_AGE25_64,DESTIN_AGE7_12, DESTIN_AGE13_24, DESTIN_AGE25_64 consist of 0 values.</p>
<p>In view of this, code chunk below will be used to replace zero values to 0.99.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>DESTIN_AGE7_12 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>DESTIN_AGE7_12 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>DESTIN_AGE7_12)</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>DESTIN_AGE13_24 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>DESTIN_AGE13_24 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>DESTIN_AGE13_24)</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>DESTIN_AGE25_64 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>DESTIN_AGE25_64 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>DESTIN_AGE25_64)</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>ORIGIN_AGE7_12 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>ORIGIN_AGE7_12 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>ORIGIN_AGE7_12)</span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>ORIGIN_AGE13_24 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>ORIGIN_AGE13_24 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>ORIGIN_AGE13_24)</span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>ORIGIN_AGE25_64 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>ORIGIN_AGE25_64 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>ORIGIN_AGE25_64)</span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>BUSINESS_COUNT <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb134-20"><a href="#cb134-20" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>BUSINESS_COUNT <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb134-21"><a href="#cb134-21" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>BUSINESS_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>You can run the summary() again.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SIM_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  ORIGIN_SZ          DESTIN_SZ             TRIPS             dist      
 Length:14734       Length:14734       Min.   :     1   Min.   :   50  
 Class :character   Class :character   1st Qu.:    14   1st Qu.: 3346  
 Mode  :character   Mode  :character   Median :    76   Median : 6067  
                                       Mean   :  1021   Mean   : 6880  
                                       3rd Qu.:   426   3rd Qu.: 9729  
                                       Max.   :232187   Max.   :26136  
 ORIGIN_AGE7_12    ORIGIN_AGE13_24    ORIGIN_AGE25_64    DESTIN_AGE7_12   
 Min.   :   0.99   Min.   :    0.99   Min.   :    0.99   Min.   :   0.99  
 1st Qu.: 240.00   1st Qu.:  440.00   1st Qu.: 2200.00   1st Qu.: 240.00  
 Median : 700.00   Median : 1350.00   Median : 6810.00   Median : 720.00  
 Mean   :1031.86   Mean   : 2268.84   Mean   :10487.62   Mean   :1033.40  
 3rd Qu.:1480.00   3rd Qu.: 3260.00   3rd Qu.:15770.00   3rd Qu.:1500.00  
 Max.   :6340.00   Max.   :16380.00   Max.   :74610.00   Max.   :6340.00  
 DESTIN_AGE13_24    DESTIN_AGE25_64     SCHOOL_COUNT     RETAIL_COUNT   
 Min.   :    0.99   Min.   :    0.99   Min.   : 0.990   Min.   :  0.99  
 1st Qu.:  460.00   1st Qu.: 2200.00   1st Qu.: 0.990   1st Qu.:  0.99  
 Median : 1420.00   Median : 7030.00   Median : 1.000   Median :  3.00  
 Mean   : 2290.35   Mean   :10574.46   Mean   : 1.987   Mean   : 16.47  
 3rd Qu.: 3260.00   3rd Qu.:15830.00   3rd Qu.: 2.000   3rd Qu.: 12.00  
 Max.   :16380.00   Max.   :74610.00   Max.   :12.000   Max.   :307.00  
 BUSINESS_COUNT    FlowNoIntra           offset             dist.y     
 Min.   : 0.990   Min.   :     0.0   Min.   :0.000001   Min.   :   50  
 1st Qu.: 5.000   1st Qu.:    13.0   1st Qu.:1.000000   1st Qu.: 3346  
 Median : 8.000   Median :    70.0   Median :1.000000   Median : 6067  
 Mean   : 8.567   Mean   :   839.9   Mean   :0.982150   Mean   : 6880  
 3rd Qu.:12.000   3rd Qu.:   379.0   3rd Qu.:1.000000   3rd Qu.: 9729  
 Max.   :32.000   Max.   :148274.0   Max.   :1.000000   Max.   :26136  
   AGE7_12.x      AGE13_24.x      AGE25_64.x      AGE7_12.y      AGE13_24.y   
 Min.   :   0   Min.   :    0   Min.   :    0   Min.   :   0   Min.   :    0  
 1st Qu.: 240   1st Qu.:  440   1st Qu.: 2200   1st Qu.: 240   1st Qu.:  460  
 Median : 700   Median : 1350   Median : 6810   Median : 720   Median : 1420  
 Mean   :1032   Mean   : 2269   Mean   :10487   Mean   :1033   Mean   : 2290  
 3rd Qu.:1480   3rd Qu.: 3260   3rd Qu.:15770   3rd Qu.:1500   3rd Qu.: 3260  
 Max.   :6340   Max.   :16380   Max.   :74610   Max.   :6340   Max.   :16380  
   AGE25_64.y             geometry    
 Min.   :    0   LINESTRING   :14734  
 1st Qu.: 2200   epsg:3414    :    0  
 Median : 7030   +proj=tmer...:    0  
 Mean   :10574                        
 3rd Qu.:15830                        
 Max.   :74610                        </code></pre>
</div>
</div>
<p>Notice that all the 0 values have been replaced by 0.99.</p>
</section>
<section id="unconstrained-spatial-interaction-model" class="level4">
<h4 class="anchored" data-anchor-id="unconstrained-spatial-interaction-model">Unconstrained Spatial Interaction Model</h4>
<p>In this section, you will learn how to calibrate an unconstrained spatial interaction model by using glm() of Base Stats. The explanatory variables are origin population by different age cohort, destination population by different age cohort (i.e.&nbsp;ORIGIN_AGE25_64) and distance between origin and destination in km (i.e.&nbsp;dist).</p>
<p>The general formula of Unconstrained Spatial Interaction Model</p>
<p>The code chunk used to calibrate to model is shown below:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>uncSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIGIN_AGE25_64) <span class="sc">+</span> </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DESTIN_AGE25_64) <span class="sc">+</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>uncSIM</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = TRIPS ~ log(ORIGIN_AGE25_64) + log(DESTIN_AGE25_64) + 
    log(dist), family = poisson(link = "log"), data = SIM_data, 
    na.action = na.exclude)

Coefficients:
         (Intercept)  log(ORIGIN_AGE25_64)  log(DESTIN_AGE25_64)  
           10.407308              0.244859              0.009562  
           log(dist)  
           -0.705896  

Degrees of Freedom: 14733 Total (i.e. Null);  14730 Residual
Null Deviance:      60800000 
Residual Deviance: 36430000     AIC: 36520000</code></pre>
</div>
</div>
</section>
<section id="r-squared-function" class="level4">
<h4 class="anchored" data-anchor-id="r-squared-function">R-squared function</h4>
<p>In order to measure how much variation of the trips can be accounted by the model we will write a function to calculate R-Squared value as shown below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>CalcRSquared <span class="ot">&lt;-</span> <span class="cf">function</span>(observed,estimated){</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">cor</span>(observed,estimated)</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  R2 <span class="ot">&lt;-</span> r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  R2</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will compute the R-squared of the unconstrained SIM by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(uncSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, uncSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1892576</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r2_mcfadden</span>(uncSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Generalized Linear Regression
       R2: 0.400
  adj. R2: 0.400</code></pre>
</div>
</div>
</section>
<section id="origin-production-constrained-sim" class="level4">
<h4 class="anchored" data-anchor-id="origin-production-constrained-sim">Origin (Production) constrained SIM</h4>
<p>In this section, we will fit an origin constrained SIM by using the code3 chunk below.</p>
<p>The general formula of Origin Constrained Spatial Interaction Model</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>orcSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>                 ORIGIN_SZ <span class="sc">+</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">log</span>(DESTIN_AGE25_64) <span class="sc">+</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">log</span>(dist),</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(orcSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ ORIGIN_SZ + log(DESTIN_AGE25_64) + log(dist), 
    family = poisson(link = "log"), data = SIM_data, na.action = na.exclude)

Coefficients:
                       Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)           1.211e+01  3.785e-03  3199.012  &lt; 2e-16 ***
ORIGIN_SZAMSZ02       1.008e+00  4.450e-03   226.401  &lt; 2e-16 ***
ORIGIN_SZAMSZ03       5.474e-01  4.563e-03   119.959  &lt; 2e-16 ***
ORIGIN_SZAMSZ04      -7.494e-02  5.187e-03   -14.448  &lt; 2e-16 ***
ORIGIN_SZAMSZ05      -2.006e-01  5.790e-03   -34.650  &lt; 2e-16 ***
ORIGIN_SZAMSZ06       4.193e-01  5.130e-03    81.736  &lt; 2e-16 ***
ORIGIN_SZAMSZ07      -1.372e+00  9.683e-03  -141.686  &lt; 2e-16 ***
ORIGIN_SZAMSZ08      -1.022e+00  8.956e-03  -114.087  &lt; 2e-16 ***
ORIGIN_SZAMSZ09       2.239e-01  5.408e-03    41.396  &lt; 2e-16 ***
ORIGIN_SZAMSZ10       5.061e-01  4.716e-03   107.311  &lt; 2e-16 ***
ORIGIN_SZAMSZ11      -1.856e+00  1.285e-02  -144.414  &lt; 2e-16 ***
ORIGIN_SZAMSZ12      -1.580e+00  1.076e-02  -146.883  &lt; 2e-16 ***
ORIGIN_SZBDSZ01       1.072e+00  4.345e-03   246.734  &lt; 2e-16 ***
ORIGIN_SZBDSZ02       5.198e-01  5.079e-03   102.340  &lt; 2e-16 ***
ORIGIN_SZBDSZ03       9.865e-01  4.490e-03   219.724  &lt; 2e-16 ***
ORIGIN_SZBDSZ04       1.767e+00  3.894e-03   453.646  &lt; 2e-16 ***
ORIGIN_SZBDSZ05       6.395e-01  4.546e-03   140.691  &lt; 2e-16 ***
ORIGIN_SZBDSZ06       9.363e-01  4.543e-03   206.094  &lt; 2e-16 ***
ORIGIN_SZBDSZ07      -1.281e+00  9.558e-03  -133.991  &lt; 2e-16 ***
ORIGIN_SZBDSZ08      -1.167e+00  9.032e-03  -129.194  &lt; 2e-16 ***
ORIGIN_SZBKSZ01      -4.540e-01  6.538e-03   -69.437  &lt; 2e-16 ***
ORIGIN_SZBKSZ02       3.736e-01  5.115e-03    73.050  &lt; 2e-16 ***
ORIGIN_SZBKSZ03       5.841e-01  4.934e-03   118.375  &lt; 2e-16 ***
ORIGIN_SZBKSZ04      -1.177e-01  5.914e-03   -19.895  &lt; 2e-16 ***
ORIGIN_SZBKSZ05      -2.164e-01  5.832e-03   -37.115  &lt; 2e-16 ***
ORIGIN_SZBKSZ06       3.684e-03  5.873e-03     0.627  0.53048    
ORIGIN_SZBKSZ07       7.456e-01  4.426e-03   168.439  &lt; 2e-16 ***
ORIGIN_SZBKSZ08      -2.279e-02  5.348e-03    -4.261 2.04e-05 ***
ORIGIN_SZBKSZ09      -9.572e-02  5.721e-03   -16.733  &lt; 2e-16 ***
ORIGIN_SZBLSZ01      -1.688e+00  1.482e-02  -113.887  &lt; 2e-16 ***
ORIGIN_SZBLSZ02      -2.154e+00  1.924e-02  -111.980  &lt; 2e-16 ***
ORIGIN_SZBLSZ03      -3.249e+00  3.930e-02   -82.662  &lt; 2e-16 ***
ORIGIN_SZBLSZ04      -2.203e+00  2.306e-02   -95.557  &lt; 2e-16 ***
ORIGIN_SZBMSZ01      -1.267e-01  5.222e-03   -24.266  &lt; 2e-16 ***
ORIGIN_SZBMSZ02      -1.075e+00  6.742e-03  -159.386  &lt; 2e-16 ***
ORIGIN_SZBMSZ03      -4.386e-01  5.794e-03   -75.707  &lt; 2e-16 ***
ORIGIN_SZBMSZ04      -6.333e-02  5.157e-03   -12.280  &lt; 2e-16 ***
ORIGIN_SZBMSZ05      -2.256e+00  1.247e-02  -180.957  &lt; 2e-16 ***
ORIGIN_SZBMSZ06      -2.378e+00  1.618e-02  -147.029  &lt; 2e-16 ***
ORIGIN_SZBMSZ07      -4.769e-01  5.653e-03   -84.362  &lt; 2e-16 ***
ORIGIN_SZBMSZ08      -5.652e-01  5.811e-03   -97.259  &lt; 2e-16 ***
ORIGIN_SZBMSZ09      -1.232e+00  8.688e-03  -141.760  &lt; 2e-16 ***
ORIGIN_SZBMSZ10      -1.471e+00  9.130e-03  -161.131  &lt; 2e-16 ***
ORIGIN_SZBMSZ11      -7.866e-01  6.595e-03  -119.263  &lt; 2e-16 ***
ORIGIN_SZBMSZ12      -1.072e+00  9.149e-03  -117.206  &lt; 2e-16 ***
ORIGIN_SZBMSZ13      -1.207e-01  5.691e-03   -21.218  &lt; 2e-16 ***
ORIGIN_SZBMSZ14      -5.376e-01  6.629e-03   -81.098  &lt; 2e-16 ***
ORIGIN_SZBMSZ15      -3.253e-01  6.054e-03   -53.740  &lt; 2e-16 ***
ORIGIN_SZBMSZ16      -1.548e+00  9.144e-03  -169.303  &lt; 2e-16 ***
ORIGIN_SZBMSZ17      -2.169e+00  1.576e-02  -137.622  &lt; 2e-16 ***
ORIGIN_SZBPSZ01       1.369e-01  5.553e-03    24.660  &lt; 2e-16 ***
ORIGIN_SZBPSZ02      -3.292e-02  6.462e-03    -5.094 3.50e-07 ***
ORIGIN_SZBPSZ03       1.491e-01  6.149e-03    24.241  &lt; 2e-16 ***
ORIGIN_SZBPSZ04       3.544e-01  5.084e-03    69.711  &lt; 2e-16 ***
ORIGIN_SZBPSZ05       5.454e-01  4.554e-03   119.764  &lt; 2e-16 ***
ORIGIN_SZBPSZ06      -1.406e+00  9.311e-03  -151.045  &lt; 2e-16 ***
ORIGIN_SZBPSZ07      -1.004e+00  8.575e-03  -117.068  &lt; 2e-16 ***
ORIGIN_SZBSSZ01      -1.625e-02  5.276e-03    -3.080  0.00207 ** 
ORIGIN_SZBSSZ02       3.088e-01  4.787e-03    64.495  &lt; 2e-16 ***
ORIGIN_SZBSSZ03       2.555e-01  4.689e-03    54.487  &lt; 2e-16 ***
ORIGIN_SZBTSZ01      -6.646e-02  5.385e-03   -12.340  &lt; 2e-16 ***
ORIGIN_SZBTSZ02      -1.078e+00  7.797e-03  -138.225  &lt; 2e-16 ***
ORIGIN_SZBTSZ03      -2.284e-01  5.727e-03   -39.876  &lt; 2e-16 ***
ORIGIN_SZBTSZ04      -1.053e+00  1.019e-02  -103.339  &lt; 2e-16 ***
ORIGIN_SZBTSZ05      -1.647e+00  1.100e-02  -149.690  &lt; 2e-16 ***
ORIGIN_SZBTSZ06      -7.804e-01  7.181e-03  -108.682  &lt; 2e-16 ***
ORIGIN_SZBTSZ07      -2.298e+00  1.321e-02  -173.921  &lt; 2e-16 ***
ORIGIN_SZBTSZ08      -1.283e+00  9.394e-03  -136.560  &lt; 2e-16 ***
ORIGIN_SZCBSZ01      -1.911e+00  5.483e-02   -34.844  &lt; 2e-16 ***
ORIGIN_SZCCSZ01      -1.758e+00  1.331e-02  -132.099  &lt; 2e-16 ***
ORIGIN_SZCHSZ01      -1.236e+00  1.178e-02  -104.954  &lt; 2e-16 ***
ORIGIN_SZCHSZ02      -5.424e-01  7.940e-03   -68.307  &lt; 2e-16 ***
ORIGIN_SZCHSZ03       4.332e-01  5.841e-03    74.153  &lt; 2e-16 ***
ORIGIN_SZCKSZ01       1.843e-01  5.117e-03    36.007  &lt; 2e-16 ***
ORIGIN_SZCKSZ02       6.800e-01  5.087e-03   133.672  &lt; 2e-16 ***
ORIGIN_SZCKSZ03       8.030e-01  4.522e-03   177.574  &lt; 2e-16 ***
ORIGIN_SZCKSZ04       1.298e+00  4.562e-03   284.446  &lt; 2e-16 ***
ORIGIN_SZCKSZ05       1.011e+00  5.305e-03   190.602  &lt; 2e-16 ***
ORIGIN_SZCKSZ06       1.262e+00  5.042e-03   250.262  &lt; 2e-16 ***
ORIGIN_SZCLSZ01      -6.805e-01  7.661e-03   -88.836  &lt; 2e-16 ***
ORIGIN_SZCLSZ02      -1.837e+00  1.364e-02  -134.665  &lt; 2e-16 ***
ORIGIN_SZCLSZ03      -1.001e+00  7.949e-03  -125.969  &lt; 2e-16 ***
ORIGIN_SZCLSZ04       6.966e-01  4.460e-03   156.204  &lt; 2e-16 ***
ORIGIN_SZCLSZ05      -1.974e+00  1.474e-02  -133.906  &lt; 2e-16 ***
ORIGIN_SZCLSZ06       8.585e-01  4.204e-03   204.230  &lt; 2e-16 ***
ORIGIN_SZCLSZ07      -2.974e-01  5.575e-03   -53.346  &lt; 2e-16 ***
ORIGIN_SZCLSZ08       3.231e-01  5.802e-03    55.688  &lt; 2e-16 ***
ORIGIN_SZCLSZ09      -1.697e+00  1.555e-02  -109.106  &lt; 2e-16 ***
ORIGIN_SZDTSZ02      -4.061e+00  8.341e-02   -48.693  &lt; 2e-16 ***
ORIGIN_SZDTSZ03      -4.031e+00  7.381e-02   -54.618  &lt; 2e-16 ***
ORIGIN_SZDTSZ13      -3.000e+00  3.129e-02   -95.889  &lt; 2e-16 ***
ORIGIN_SZGLSZ01      -1.405e+00  9.192e-03  -152.876  &lt; 2e-16 ***
ORIGIN_SZGLSZ02       2.536e-01  4.889e-03    51.880  &lt; 2e-16 ***
ORIGIN_SZGLSZ03       2.411e-01  4.855e-03    49.649  &lt; 2e-16 ***
ORIGIN_SZGLSZ04       8.350e-01  4.200e-03   198.826  &lt; 2e-16 ***
ORIGIN_SZGLSZ05       6.207e-01  4.375e-03   141.857  &lt; 2e-16 ***
ORIGIN_SZHGSZ01       2.806e-01  4.746e-03    59.121  &lt; 2e-16 ***
ORIGIN_SZHGSZ02       4.917e-01  4.712e-03   104.351  &lt; 2e-16 ***
ORIGIN_SZHGSZ03       2.452e-01  5.113e-03    47.952  &lt; 2e-16 ***
ORIGIN_SZHGSZ04       9.052e-01  4.303e-03   210.358  &lt; 2e-16 ***
ORIGIN_SZHGSZ05       1.170e+00  4.253e-03   275.033  &lt; 2e-16 ***
ORIGIN_SZHGSZ06      -1.016e-01  5.413e-03   -18.773  &lt; 2e-16 ***
ORIGIN_SZHGSZ07       6.984e-01  4.455e-03   156.757  &lt; 2e-16 ***
ORIGIN_SZHGSZ08       1.005e-01  5.354e-03    18.781  &lt; 2e-16 ***
ORIGIN_SZHGSZ09      -5.390e-01  6.962e-03   -77.417  &lt; 2e-16 ***
ORIGIN_SZHGSZ10      -3.512e+00  4.211e-02   -83.388  &lt; 2e-16 ***
ORIGIN_SZJESZ01       4.022e-01  4.869e-03    82.601  &lt; 2e-16 ***
ORIGIN_SZJESZ02       2.273e-01  4.924e-03    46.158  &lt; 2e-16 ***
ORIGIN_SZJESZ03       1.829e-01  5.286e-03    34.598  &lt; 2e-16 ***
ORIGIN_SZJESZ04      -1.177e+00  9.142e-03  -128.767  &lt; 2e-16 ***
ORIGIN_SZJESZ05      -2.065e+00  1.382e-02  -149.494  &lt; 2e-16 ***
ORIGIN_SZJESZ06       2.301e-01  4.853e-03    47.410  &lt; 2e-16 ***
ORIGIN_SZJESZ07      -1.889e+00  1.183e-02  -159.599  &lt; 2e-16 ***
ORIGIN_SZJESZ08      -1.062e+00  1.147e-02   -92.551  &lt; 2e-16 ***
ORIGIN_SZJESZ09       5.237e-01  4.959e-03   105.612  &lt; 2e-16 ***
ORIGIN_SZJESZ10      -1.829e+00  1.800e-02  -101.616  &lt; 2e-16 ***
ORIGIN_SZJESZ11      -2.023e+00  1.931e-02  -104.738  &lt; 2e-16 ***
ORIGIN_SZJWSZ01       2.125e-01  6.405e-03    33.183  &lt; 2e-16 ***
ORIGIN_SZJWSZ02       8.858e-01  4.521e-03   195.929  &lt; 2e-16 ***
ORIGIN_SZJWSZ03       1.269e+00  4.188e-03   302.922  &lt; 2e-16 ***
ORIGIN_SZJWSZ04       1.284e+00  4.280e-03   300.017  &lt; 2e-16 ***
ORIGIN_SZJWSZ05      -1.393e+00  1.252e-02  -111.339  &lt; 2e-16 ***
ORIGIN_SZJWSZ06      -1.015e+00  1.067e-02   -95.109  &lt; 2e-16 ***
ORIGIN_SZJWSZ07      -2.694e+00  2.751e-02   -97.911  &lt; 2e-16 ***
ORIGIN_SZJWSZ08       1.950e+00  4.110e-03   474.430  &lt; 2e-16 ***
ORIGIN_SZJWSZ09       1.831e+00  3.899e-03   469.595  &lt; 2e-16 ***
ORIGIN_SZKLSZ01       1.636e-01  4.902e-03    33.374  &lt; 2e-16 ***
ORIGIN_SZKLSZ02      -5.156e-01  6.321e-03   -81.570  &lt; 2e-16 ***
ORIGIN_SZKLSZ03      -4.145e-01  5.949e-03   -69.666  &lt; 2e-16 ***
ORIGIN_SZKLSZ04      -2.283e+00  1.187e-02  -192.327  &lt; 2e-16 ***
ORIGIN_SZKLSZ05      -8.593e-01  8.272e-03  -103.882  &lt; 2e-16 ***
ORIGIN_SZKLSZ06      -4.709e+00  1.857e-01   -25.352  &lt; 2e-16 ***
ORIGIN_SZKLSZ07      -1.123e+00  8.408e-03  -133.615  &lt; 2e-16 ***
ORIGIN_SZKLSZ08      -1.476e+00  9.152e-03  -161.321  &lt; 2e-16 ***
ORIGIN_SZLKSZ01      -3.273e+00  3.875e-02   -84.465  &lt; 2e-16 ***
ORIGIN_SZMDSZ01      -2.615e+00  2.802e-02   -93.303  &lt; 2e-16 ***
ORIGIN_SZMDSZ02      -8.945e-01  1.035e-02   -86.389  &lt; 2e-16 ***
ORIGIN_SZMDSZ03      -1.998e+00  1.703e-02  -117.297  &lt; 2e-16 ***
ORIGIN_SZMPSZ01      -1.093e+00  8.367e-03  -130.656  &lt; 2e-16 ***
ORIGIN_SZMPSZ02      -5.975e-01  6.898e-03   -86.616  &lt; 2e-16 ***
ORIGIN_SZMPSZ03      -9.706e-03  5.319e-03    -1.825  0.06804 .  
ORIGIN_SZMUSZ02      -3.923e+00  1.038e-01   -37.806  &lt; 2e-16 ***
ORIGIN_SZNTSZ01      -2.829e+00  3.529e-02   -80.157  &lt; 2e-16 ***
ORIGIN_SZNTSZ02      -3.256e+00  2.323e-02  -140.180  &lt; 2e-16 ***
ORIGIN_SZNTSZ03      -9.865e-01  7.777e-03  -126.848  &lt; 2e-16 ***
ORIGIN_SZNTSZ05      -3.353e+00  4.964e-02   -67.546  &lt; 2e-16 ***
ORIGIN_SZNTSZ06      -3.818e+00  5.576e-02   -68.483  &lt; 2e-16 ***
ORIGIN_SZNVSZ01       4.449e-01  4.482e-03    99.269  &lt; 2e-16 ***
ORIGIN_SZNVSZ02      -6.279e-01  6.470e-03   -97.044  &lt; 2e-16 ***
ORIGIN_SZNVSZ03      -1.212e+00  7.788e-03  -155.644  &lt; 2e-16 ***
ORIGIN_SZNVSZ04      -1.469e+00  9.091e-03  -161.543  &lt; 2e-16 ***
ORIGIN_SZNVSZ05      -2.628e+00  1.579e-02  -166.466  &lt; 2e-16 ***
ORIGIN_SZPGSZ01      -9.541e-01  1.223e-02   -78.035  &lt; 2e-16 ***
ORIGIN_SZPGSZ02      -5.353e-01  7.233e-03   -74.009  &lt; 2e-16 ***
ORIGIN_SZPGSZ03       9.574e-01  4.437e-03   215.779  &lt; 2e-16 ***
ORIGIN_SZPGSZ04       1.110e+00  4.417e-03   251.169  &lt; 2e-16 ***
ORIGIN_SZPGSZ05       2.658e-01  5.758e-03    46.156  &lt; 2e-16 ***
ORIGIN_SZPLSZ01      -8.153e-01  1.044e-02   -78.119  &lt; 2e-16 ***
ORIGIN_SZPLSZ02      -1.675e+00  1.478e-02  -113.340  &lt; 2e-16 ***
ORIGIN_SZPLSZ03      -2.963e+00  3.672e-02   -80.686  &lt; 2e-16 ***
ORIGIN_SZPLSZ04      -3.279e+00  3.684e-02   -89.012  &lt; 2e-16 ***
ORIGIN_SZPLSZ05      -2.466e+00  2.245e-02  -109.864  &lt; 2e-16 ***
ORIGIN_SZPNSZ01       1.411e+00  4.584e-03   307.690  &lt; 2e-16 ***
ORIGIN_SZPNSZ02      -5.043e-01  1.108e-02   -45.503  &lt; 2e-16 ***
ORIGIN_SZPNSZ03      -1.878e+00  1.940e-02   -96.796  &lt; 2e-16 ***
ORIGIN_SZPNSZ04      -2.761e+00  3.112e-02   -88.706  &lt; 2e-16 ***
ORIGIN_SZPNSZ05      -2.277e+00  2.628e-02   -86.662  &lt; 2e-16 ***
ORIGIN_SZPRSZ01      -7.934e-01  1.142e-02   -69.499  &lt; 2e-16 ***
ORIGIN_SZPRSZ02       9.414e-01  4.615e-03   203.981  &lt; 2e-16 ***
ORIGIN_SZPRSZ03       7.674e-01  4.626e-03   165.881  &lt; 2e-16 ***
ORIGIN_SZPRSZ04      -3.771e-01  7.516e-03   -50.168  &lt; 2e-16 ***
ORIGIN_SZPRSZ05       1.327e+00  4.325e-03   306.737  &lt; 2e-16 ***
ORIGIN_SZPRSZ06      -4.081e-01  8.651e-03   -47.172  &lt; 2e-16 ***
ORIGIN_SZPRSZ07      -2.151e+00  1.610e-02  -133.558  &lt; 2e-16 ***
ORIGIN_SZPRSZ08       5.293e-04  6.383e-03     0.083  0.93391    
ORIGIN_SZQTSZ01      -4.144e-01  6.846e-03   -60.539  &lt; 2e-16 ***
ORIGIN_SZQTSZ02      -7.967e-01  6.327e-03  -125.933  &lt; 2e-16 ***
ORIGIN_SZQTSZ03      -2.415e-01  5.681e-03   -42.509  &lt; 2e-16 ***
ORIGIN_SZQTSZ04      -1.013e+00  7.129e-03  -142.123  &lt; 2e-16 ***
ORIGIN_SZQTSZ05      -3.923e-01  5.994e-03   -65.446  &lt; 2e-16 ***
ORIGIN_SZQTSZ06      -5.662e-01  6.481e-03   -87.359  &lt; 2e-16 ***
ORIGIN_SZQTSZ07      -1.558e+00  9.635e-03  -161.662  &lt; 2e-16 ***
ORIGIN_SZQTSZ08      -1.577e-01  5.699e-03   -27.665  &lt; 2e-16 ***
ORIGIN_SZQTSZ09      -6.189e-01  6.633e-03   -93.312  &lt; 2e-16 ***
ORIGIN_SZQTSZ10      -4.511e-01  6.512e-03   -69.271  &lt; 2e-16 ***
ORIGIN_SZQTSZ11      -1.455e+00  9.800e-03  -148.421  &lt; 2e-16 ***
ORIGIN_SZQTSZ12      -1.475e+00  1.044e-02  -141.309  &lt; 2e-16 ***
ORIGIN_SZQTSZ13      -3.529e-01  6.413e-03   -55.038  &lt; 2e-16 ***
ORIGIN_SZQTSZ14      -1.591e+00  9.847e-03  -161.565  &lt; 2e-16 ***
ORIGIN_SZQTSZ15      -8.955e-01  1.027e-02   -87.184  &lt; 2e-16 ***
ORIGIN_SZRCSZ01      -1.375e+00  1.265e-02  -108.704  &lt; 2e-16 ***
ORIGIN_SZRCSZ06      -6.196e-01  8.475e-03   -73.116  &lt; 2e-16 ***
ORIGIN_SZRVSZ01      -3.523e+00  3.237e-02  -108.818  &lt; 2e-16 ***
ORIGIN_SZRVSZ02      -2.912e+00  2.776e-02  -104.868  &lt; 2e-16 ***
ORIGIN_SZRVSZ03      -3.145e+00  2.379e-02  -132.232  &lt; 2e-16 ***
ORIGIN_SZRVSZ04      -3.357e+00  5.567e-02   -60.309  &lt; 2e-16 ***
ORIGIN_SZRVSZ05      -2.438e+00  1.644e-02  -148.272  &lt; 2e-16 ***
ORIGIN_SZSBSZ01       5.890e-01  5.529e-03   106.520  &lt; 2e-16 ***
ORIGIN_SZSBSZ02      -7.098e-01  8.213e-03   -86.432  &lt; 2e-16 ***
ORIGIN_SZSBSZ03       9.634e-01  4.611e-03   208.943  &lt; 2e-16 ***
ORIGIN_SZSBSZ04       7.729e-01  5.289e-03   146.136  &lt; 2e-16 ***
ORIGIN_SZSBSZ05      -9.966e-02  6.543e-03   -15.231  &lt; 2e-16 ***
ORIGIN_SZSBSZ06      -1.778e+00  1.719e-02  -103.427  &lt; 2e-16 ***
ORIGIN_SZSBSZ07      -1.161e+00  1.256e-02   -92.436  &lt; 2e-16 ***
ORIGIN_SZSBSZ08      -1.212e+00  1.222e-02   -99.227  &lt; 2e-16 ***
ORIGIN_SZSBSZ09      -5.783e-01  8.579e-03   -67.412  &lt; 2e-16 ***
ORIGIN_SZSESZ02       9.999e-01  4.409e-03   226.798  &lt; 2e-16 ***
ORIGIN_SZSESZ03       1.214e+00  4.164e-03   291.675  &lt; 2e-16 ***
ORIGIN_SZSESZ04       8.141e-01  4.868e-03   167.238  &lt; 2e-16 ***
ORIGIN_SZSESZ05      -2.186e-01  5.915e-03   -36.961  &lt; 2e-16 ***
ORIGIN_SZSESZ06       7.298e-01  4.689e-03   155.641  &lt; 2e-16 ***
ORIGIN_SZSESZ07      -2.543e+00  1.961e-02  -129.689  &lt; 2e-16 ***
ORIGIN_SZSGSZ01      -1.016e+00  8.550e-03  -118.869  &lt; 2e-16 ***
ORIGIN_SZSGSZ02      -1.120e+00  9.589e-03  -116.799  &lt; 2e-16 ***
ORIGIN_SZSGSZ03       2.169e-01  5.167e-03    41.970  &lt; 2e-16 ***
ORIGIN_SZSGSZ04       2.672e-01  4.792e-03    55.757  &lt; 2e-16 ***
ORIGIN_SZSGSZ05      -1.785e+00  1.060e-02  -168.456  &lt; 2e-16 ***
ORIGIN_SZSGSZ06       4.017e-01  4.541e-03    88.470  &lt; 2e-16 ***
ORIGIN_SZSGSZ07      -6.303e-01  6.235e-03  -101.098  &lt; 2e-16 ***
ORIGIN_SZSKSZ01      -1.928e-01  7.765e-03   -24.826  &lt; 2e-16 ***
ORIGIN_SZSKSZ02       3.870e-01  5.689e-03    68.026  &lt; 2e-16 ***
ORIGIN_SZSKSZ03      -6.815e-01  7.983e-03   -85.369  &lt; 2e-16 ***
ORIGIN_SZSKSZ04      -2.528e+00  2.702e-02   -93.548  &lt; 2e-16 ***
ORIGIN_SZSKSZ05      -1.370e+00  1.552e-02   -88.311  &lt; 2e-16 ***
ORIGIN_SZSLSZ01      -3.218e+00  3.058e-02  -105.238  &lt; 2e-16 ***
ORIGIN_SZSLSZ04      -6.800e-01  7.683e-03   -88.497  &lt; 2e-16 ***
ORIGIN_SZSRSZ01      -2.389e+00  1.583e-02  -150.989  &lt; 2e-16 ***
ORIGIN_SZTHSZ01      -2.183e+00  4.887e-02   -44.666  &lt; 2e-16 ***
ORIGIN_SZTHSZ03      -2.243e+00  2.243e-02  -100.025  &lt; 2e-16 ***
ORIGIN_SZTHSZ04      -2.005e+00  2.869e-02   -69.879  &lt; 2e-16 ***
ORIGIN_SZTHSZ06      -2.276e+00  1.784e-02  -127.557  &lt; 2e-16 ***
ORIGIN_SZTMSZ01       4.015e-01  5.814e-03    69.048  &lt; 2e-16 ***
ORIGIN_SZTMSZ02       2.222e+00  3.795e-03   585.568  &lt; 2e-16 ***
ORIGIN_SZTMSZ03       1.412e+00  4.108e-03   343.608  &lt; 2e-16 ***
ORIGIN_SZTMSZ04       9.106e-01  4.742e-03   192.036  &lt; 2e-16 ***
ORIGIN_SZTMSZ05      -3.259e-01  7.534e-03   -43.253  &lt; 2e-16 ***
ORIGIN_SZTNSZ01      -1.806e+00  1.038e-02  -174.076  &lt; 2e-16 ***
ORIGIN_SZTNSZ02      -1.741e+00  9.778e-03  -178.108  &lt; 2e-16 ***
ORIGIN_SZTNSZ03      -2.277e+00  1.338e-02  -170.199  &lt; 2e-16 ***
ORIGIN_SZTNSZ04      -7.703e-01  7.197e-03  -107.032  &lt; 2e-16 ***
ORIGIN_SZTPSZ01      -6.466e-01  6.287e-03  -102.841  &lt; 2e-16 ***
ORIGIN_SZTPSZ02       4.633e-01  4.347e-03   106.578  &lt; 2e-16 ***
ORIGIN_SZTPSZ03      -5.186e-01  6.085e-03   -85.234  &lt; 2e-16 ***
ORIGIN_SZTPSZ04      -2.900e-01  5.779e-03   -50.190  &lt; 2e-16 ***
ORIGIN_SZTPSZ05      -2.169e-01  6.072e-03   -35.720  &lt; 2e-16 ***
ORIGIN_SZTPSZ06       3.357e-01  5.942e-03    56.486  &lt; 2e-16 ***
ORIGIN_SZTPSZ07      -2.517e-01  6.317e-03   -39.846  &lt; 2e-16 ***
ORIGIN_SZTPSZ08      -1.075e+00  9.109e-03  -118.034  &lt; 2e-16 ***
ORIGIN_SZTPSZ09      -3.708e-01  6.189e-03   -59.903  &lt; 2e-16 ***
ORIGIN_SZTPSZ10      -6.889e-01  7.634e-03   -90.229  &lt; 2e-16 ***
ORIGIN_SZTPSZ11       7.661e-02  5.459e-03    14.033  &lt; 2e-16 ***
ORIGIN_SZTPSZ12      -5.971e-01  6.522e-03   -91.552  &lt; 2e-16 ***
ORIGIN_SZTSSZ01      -3.517e+00  4.739e-02   -74.210  &lt; 2e-16 ***
ORIGIN_SZTSSZ02       3.022e-01  7.334e-03    41.203  &lt; 2e-16 ***
ORIGIN_SZTSSZ03       3.730e-01  7.073e-03    52.733  &lt; 2e-16 ***
ORIGIN_SZTSSZ04       3.610e-01  7.463e-03    48.372  &lt; 2e-16 ***
ORIGIN_SZTSSZ05      -1.103e+00  1.404e-02   -78.566  &lt; 2e-16 ***
ORIGIN_SZTSSZ06      -1.310e+00  1.718e-02   -76.286  &lt; 2e-16 ***
ORIGIN_SZWCSZ01      -1.233e-01  7.861e-03   -15.690  &lt; 2e-16 ***
ORIGIN_SZWCSZ02      -2.872e+00  3.159e-02   -90.911  &lt; 2e-16 ***
ORIGIN_SZWCSZ03      -4.138e+00  1.241e-01   -33.349  &lt; 2e-16 ***
ORIGIN_SZWDSZ01       1.370e+00  4.146e-03   330.448  &lt; 2e-16 ***
ORIGIN_SZWDSZ02       1.041e+00  4.747e-03   219.219  &lt; 2e-16 ***
ORIGIN_SZWDSZ03       2.189e+00  4.035e-03   542.344  &lt; 2e-16 ***
ORIGIN_SZWDSZ04       1.142e+00  4.963e-03   230.074  &lt; 2e-16 ***
ORIGIN_SZWDSZ05       5.160e-01  4.998e-03   103.230  &lt; 2e-16 ***
ORIGIN_SZWDSZ06       1.208e+00  4.611e-03   262.019  &lt; 2e-16 ***
ORIGIN_SZWDSZ07      -3.805e-01  8.034e-03   -47.365  &lt; 2e-16 ***
ORIGIN_SZWDSZ08      -4.839e-01  7.878e-03   -61.426  &lt; 2e-16 ***
ORIGIN_SZWDSZ09       1.475e+00  4.401e-03   335.097  &lt; 2e-16 ***
ORIGIN_SZYSSZ01      -1.552e-01  5.643e-03   -27.496  &lt; 2e-16 ***
ORIGIN_SZYSSZ02       8.958e-01  4.973e-03   180.144  &lt; 2e-16 ***
ORIGIN_SZYSSZ03       1.757e+00  4.275e-03   411.050  &lt; 2e-16 ***
ORIGIN_SZYSSZ04       8.439e-01  4.538e-03   185.955  &lt; 2e-16 ***
ORIGIN_SZYSSZ05      -9.995e-02  5.920e-03   -16.884  &lt; 2e-16 ***
ORIGIN_SZYSSZ06      -1.175e+00  1.079e-02  -108.835  &lt; 2e-16 ***
ORIGIN_SZYSSZ07      -1.202e+00  1.127e-02  -106.642  &lt; 2e-16 ***
ORIGIN_SZYSSZ08       1.244e-02  6.104e-03     2.039  0.04148 *  
ORIGIN_SZYSSZ09       1.385e+00  4.239e-03   326.757  &lt; 2e-16 ***
log(DESTIN_AGE25_64)  2.298e-02  8.832e-05   260.146  &lt; 2e-16 ***
log(dist)            -6.947e-01  1.295e-04 -5363.438  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 60796037  on 14733  degrees of freedom
Residual deviance: 26726668  on 14453  degrees of freedom
AIC: 26818857

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p>We can examine how the constraints hold for destinations this time.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(orcSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, orcSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4165837</code></pre>
</div>
</div>
</section>
<section id="destination-constrained" class="level4">
<h4 class="anchored" data-anchor-id="destination-constrained">Destination constrained</h4>
<p>In this section, we will fit a destination constrained SIM by using the code chunk below.</p>
<p>The general formula of Destination Constrained Spatial Interaction Model</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>decSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>                DESTIN_SZ <span class="sc">+</span> </span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIGIN_AGE25_64) <span class="sc">+</span> </span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(decSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ DESTIN_SZ + log(ORIGIN_AGE25_64) + log(dist), 
    family = poisson(link = "log"), data = SIM_data, na.action = na.exclude)

Coefficients:
                       Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)          10.8110189  0.0033476  3229.499  &lt; 2e-16 ***
DESTIN_SZAMSZ02       0.1775885  0.0041530    42.761  &lt; 2e-16 ***
DESTIN_SZAMSZ03       0.2064091  0.0040888    50.482  &lt; 2e-16 ***
DESTIN_SZAMSZ04      -0.9406455  0.0060637  -155.127  &lt; 2e-16 ***
DESTIN_SZAMSZ05      -1.1578100  0.0061804  -187.337  &lt; 2e-16 ***
DESTIN_SZAMSZ06      -0.8861493  0.0059241  -149.584  &lt; 2e-16 ***
DESTIN_SZAMSZ07      -1.7712447  0.0096070  -184.370  &lt; 2e-16 ***
DESTIN_SZAMSZ08      -1.0707197  0.0067763  -158.009  &lt; 2e-16 ***
DESTIN_SZAMSZ09      -0.9682250  0.0060435  -160.210  &lt; 2e-16 ***
DESTIN_SZAMSZ10       0.2612773  0.0043738    59.737  &lt; 2e-16 ***
DESTIN_SZAMSZ11      -0.3714704  0.0086200   -43.094  &lt; 2e-16 ***
DESTIN_SZAMSZ12       0.0250455  0.0049850     5.024 5.06e-07 ***
DESTIN_SZBDSZ01       0.5154763  0.0037827   136.271  &lt; 2e-16 ***
DESTIN_SZBDSZ02      -0.2843120  0.0049517   -57.417  &lt; 2e-16 ***
DESTIN_SZBDSZ03      -0.0134646  0.0042692    -3.154  0.00161 ** 
DESTIN_SZBDSZ04       1.0014441  0.0034463   290.582  &lt; 2e-16 ***
DESTIN_SZBDSZ05       0.3721573  0.0038992    95.445  &lt; 2e-16 ***
DESTIN_SZBDSZ06       0.2013935  0.0042182    47.744  &lt; 2e-16 ***
DESTIN_SZBDSZ07      -1.0642612  0.0092942  -114.508  &lt; 2e-16 ***
DESTIN_SZBDSZ08      -1.7769370  0.0105721  -168.077  &lt; 2e-16 ***
DESTIN_SZBKSZ01      -1.1944766  0.0065580  -182.141  &lt; 2e-16 ***
DESTIN_SZBKSZ02      -0.2604946  0.0052044   -50.053  &lt; 2e-16 ***
DESTIN_SZBKSZ03      -0.5905775  0.0055618  -106.184  &lt; 2e-16 ***
DESTIN_SZBKSZ04      -0.0521573  0.0048274   -10.804  &lt; 2e-16 ***
DESTIN_SZBKSZ05      -0.8258599  0.0057094  -144.650  &lt; 2e-16 ***
DESTIN_SZBKSZ06      -0.8696763  0.0060934  -142.725  &lt; 2e-16 ***
DESTIN_SZBKSZ07       0.2216292  0.0040334    54.949  &lt; 2e-16 ***
DESTIN_SZBKSZ08      -1.1179375  0.0068749  -162.612  &lt; 2e-16 ***
DESTIN_SZBKSZ09      -0.2888733  0.0049056   -58.886  &lt; 2e-16 ***
DESTIN_SZBLSZ01      -0.4487061  0.0070226   -63.894  &lt; 2e-16 ***
DESTIN_SZBLSZ02       0.6343096  0.0065174    97.326  &lt; 2e-16 ***
DESTIN_SZBLSZ03       1.3492337  0.0074135   181.997  &lt; 2e-16 ***
DESTIN_SZBLSZ04      -0.0339193  0.0131568    -2.578  0.00993 ** 
DESTIN_SZBMSZ01      -0.3497912  0.0046910   -74.567  &lt; 2e-16 ***
DESTIN_SZBMSZ02      -0.5995634  0.0048828  -122.792  &lt; 2e-16 ***
DESTIN_SZBMSZ03      -0.8726401  0.0056851  -153.495  &lt; 2e-16 ***
DESTIN_SZBMSZ04      -0.5350402  0.0048888  -109.442  &lt; 2e-16 ***
DESTIN_SZBMSZ05      -0.4981814  0.0065971   -75.515  &lt; 2e-16 ***
DESTIN_SZBMSZ06      -2.0640198  0.0123050  -167.739  &lt; 2e-16 ***
DESTIN_SZBMSZ07      -0.3100988  0.0045283   -68.480  &lt; 2e-16 ***
DESTIN_SZBMSZ08      -1.2748152  0.0062622  -203.573  &lt; 2e-16 ***
DESTIN_SZBMSZ09      -2.8056325  0.0143532  -195.471  &lt; 2e-16 ***
DESTIN_SZBMSZ10      -1.9166407  0.0089273  -214.693  &lt; 2e-16 ***
DESTIN_SZBMSZ11      -1.7261160  0.0079281  -217.722  &lt; 2e-16 ***
DESTIN_SZBMSZ12      -1.1495908  0.0077721  -147.912  &lt; 2e-16 ***
DESTIN_SZBMSZ13      -0.5428008  0.0050824  -106.799  &lt; 2e-16 ***
DESTIN_SZBMSZ14      -1.1422302  0.0076325  -149.653  &lt; 2e-16 ***
DESTIN_SZBMSZ15      -1.2217517  0.0068685  -177.878  &lt; 2e-16 ***
DESTIN_SZBMSZ16      -2.4074288  0.0107900  -223.116  &lt; 2e-16 ***
DESTIN_SZBMSZ17      -2.6985491  0.0164771  -163.776  &lt; 2e-16 ***
DESTIN_SZBPSZ01      -0.6183085  0.0054605  -113.233  &lt; 2e-16 ***
DESTIN_SZBPSZ02      -1.4579175  0.0083271  -175.080  &lt; 2e-16 ***
DESTIN_SZBPSZ03      -1.0775392  0.0075109  -143.463  &lt; 2e-16 ***
DESTIN_SZBPSZ04      -0.6645303  0.0058070  -114.436  &lt; 2e-16 ***
DESTIN_SZBPSZ05       0.3449386  0.0039504    87.318  &lt; 2e-16 ***
DESTIN_SZBPSZ06      -0.9360064  0.0077394  -120.941  &lt; 2e-16 ***
DESTIN_SZBPSZ07      -0.6850065  0.0077761   -88.091  &lt; 2e-16 ***
DESTIN_SZBSSZ01      -0.3144210  0.0045803   -68.647  &lt; 2e-16 ***
DESTIN_SZBSSZ02      -0.7531935  0.0051075  -147.469  &lt; 2e-16 ***
DESTIN_SZBSSZ03       0.1964072  0.0038255    51.342  &lt; 2e-16 ***
DESTIN_SZBTSZ01       0.0749897  0.0041584    18.033  &lt; 2e-16 ***
DESTIN_SZBTSZ02      -0.8214254  0.0065659  -125.105  &lt; 2e-16 ***
DESTIN_SZBTSZ03      -0.1672596  0.0047942   -34.888  &lt; 2e-16 ***
DESTIN_SZBTSZ04      -1.7727273  0.0103706  -170.938  &lt; 2e-16 ***
DESTIN_SZBTSZ05      -0.8162630  0.0067401  -121.105  &lt; 2e-16 ***
DESTIN_SZBTSZ06      -0.8159130  0.0059754  -136.546  &lt; 2e-16 ***
DESTIN_SZBTSZ07      -2.1139258  0.0105602  -200.178  &lt; 2e-16 ***
DESTIN_SZBTSZ08      -1.3565179  0.0086828  -156.231  &lt; 2e-16 ***
DESTIN_SZCBSZ01      -4.6643129  0.3162417   -14.749  &lt; 2e-16 ***
DESTIN_SZCCSZ01      -1.0088833  0.0080155  -125.866  &lt; 2e-16 ***
DESTIN_SZCHSZ01      -1.1909317  0.0095262  -125.017  &lt; 2e-16 ***
DESTIN_SZCHSZ02       0.0890035  0.0052277    17.025  &lt; 2e-16 ***
DESTIN_SZCHSZ03       1.4883985  0.0039094   380.724  &lt; 2e-16 ***
DESTIN_SZCKSZ01      -0.1684738  0.0047561   -35.422  &lt; 2e-16 ***
DESTIN_SZCKSZ02      -0.4314614  0.0051537   -83.720  &lt; 2e-16 ***
DESTIN_SZCKSZ03       0.6413457  0.0038639   165.983  &lt; 2e-16 ***
DESTIN_SZCKSZ04      -0.6370791  0.0059869  -106.412  &lt; 2e-16 ***
DESTIN_SZCKSZ05      -0.4185112  0.0065348   -64.044  &lt; 2e-16 ***
DESTIN_SZCKSZ06       0.7003888  0.0045139   155.163  &lt; 2e-16 ***
DESTIN_SZCLSZ01       0.3751343  0.0047400    79.143  &lt; 2e-16 ***
DESTIN_SZCLSZ02      -2.2913668  0.0133371  -171.804  &lt; 2e-16 ***
DESTIN_SZCLSZ03      -1.0498490  0.0076548  -137.149  &lt; 2e-16 ***
DESTIN_SZCLSZ04      -0.1118915  0.0044886   -24.928  &lt; 2e-16 ***
DESTIN_SZCLSZ05      -1.3113032  0.0084067  -155.983  &lt; 2e-16 ***
DESTIN_SZCLSZ06       0.1661786  0.0040203    41.334  &lt; 2e-16 ***
DESTIN_SZCLSZ07      -0.6429895  0.0052617  -122.202  &lt; 2e-16 ***
DESTIN_SZCLSZ08      -0.4271702  0.0057208   -74.670  &lt; 2e-16 ***
DESTIN_SZCLSZ09       0.3882136  0.0063758    60.888  &lt; 2e-16 ***
DESTIN_SZDTSZ02      -3.0106480  0.0348374   -86.420  &lt; 2e-16 ***
DESTIN_SZDTSZ03      -1.4195712  0.0144110   -98.506  &lt; 2e-16 ***
DESTIN_SZDTSZ13      -2.2368573  0.0161427  -138.567  &lt; 2e-16 ***
DESTIN_SZGLSZ01       0.0013721  0.0051224     0.268  0.78881    
DESTIN_SZGLSZ02      -0.3376674  0.0046195   -73.097  &lt; 2e-16 ***
DESTIN_SZGLSZ03       0.3659900  0.0038384    95.350  &lt; 2e-16 ***
DESTIN_SZGLSZ04       0.2969928  0.0038026    78.103  &lt; 2e-16 ***
DESTIN_SZGLSZ05       0.1786445  0.0038853    45.980  &lt; 2e-16 ***
DESTIN_SZHGSZ01       0.2979206  0.0038825    76.735  &lt; 2e-16 ***
DESTIN_SZHGSZ02      -0.5701034  0.0051182  -111.388  &lt; 2e-16 ***
DESTIN_SZHGSZ03      -1.0387610  0.0061020  -170.233  &lt; 2e-16 ***
DESTIN_SZHGSZ04      -0.2264881  0.0043617   -51.926  &lt; 2e-16 ***
DESTIN_SZHGSZ05      -0.2287090  0.0044851   -50.993  &lt; 2e-16 ***
DESTIN_SZHGSZ06      -0.7896437  0.0054081  -146.010  &lt; 2e-16 ***
DESTIN_SZHGSZ07       0.2268880  0.0040336    56.249  &lt; 2e-16 ***
DESTIN_SZHGSZ08      -0.4260784  0.0048967   -87.013  &lt; 2e-16 ***
DESTIN_SZHGSZ09       0.1027784  0.0051341    20.019  &lt; 2e-16 ***
DESTIN_SZHGSZ10      -2.8571803  0.0262064  -109.026  &lt; 2e-16 ***
DESTIN_SZJESZ01      -0.0843635  0.0048222   -17.495  &lt; 2e-16 ***
DESTIN_SZJESZ02      -0.5197682  0.0051511  -100.904  &lt; 2e-16 ***
DESTIN_SZJESZ03      -0.6250311  0.0056619  -110.392  &lt; 2e-16 ***
DESTIN_SZJESZ04      -0.3937360  0.0065536   -60.080  &lt; 2e-16 ***
DESTIN_SZJESZ05      -0.9748291  0.0097665   -99.814  &lt; 2e-16 ***
DESTIN_SZJESZ06       0.3642736  0.0040600    89.722  &lt; 2e-16 ***
DESTIN_SZJESZ07      -1.1571882  0.0081557  -141.887  &lt; 2e-16 ***
DESTIN_SZJESZ08      -0.5955747  0.0078071   -76.286  &lt; 2e-16 ***
DESTIN_SZJESZ09      -0.3629500  0.0053966   -67.256  &lt; 2e-16 ***
DESTIN_SZJESZ10       0.7691552  0.0069348   110.912  &lt; 2e-16 ***
DESTIN_SZJESZ11       0.9365743  0.0065801   142.335  &lt; 2e-16 ***
DESTIN_SZJWSZ01      -0.4568805  0.0064536   -70.795  &lt; 2e-16 ***
DESTIN_SZJWSZ02      -0.2880426  0.0051632   -55.788  &lt; 2e-16 ***
DESTIN_SZJWSZ03       0.6680404  0.0039264   170.142  &lt; 2e-16 ***
DESTIN_SZJWSZ04       0.9492158  0.0037186   255.262  &lt; 2e-16 ***
DESTIN_SZJWSZ05      -0.1938053  0.0060810   -31.871  &lt; 2e-16 ***
DESTIN_SZJWSZ06       0.3813164  0.0054551    69.900  &lt; 2e-16 ***
DESTIN_SZJWSZ07      -1.2676010  0.0280038   -45.265  &lt; 2e-16 ***
DESTIN_SZJWSZ08       0.5013149  0.0044573   112.471  &lt; 2e-16 ***
DESTIN_SZJWSZ09       1.4161404  0.0033937   417.291  &lt; 2e-16 ***
DESTIN_SZKLSZ01      -0.6909444  0.0051540  -134.059  &lt; 2e-16 ***
DESTIN_SZKLSZ02      -0.8146023  0.0057129  -142.589  &lt; 2e-16 ***
DESTIN_SZKLSZ03      -1.3956114  0.0065167  -214.161  &lt; 2e-16 ***
DESTIN_SZKLSZ04      -1.9070281  0.0087370  -218.270  &lt; 2e-16 ***
DESTIN_SZKLSZ05      -0.9293576  0.0071070  -130.766  &lt; 2e-16 ***
DESTIN_SZKLSZ06      -2.5402234  0.0362062   -70.160  &lt; 2e-16 ***
DESTIN_SZKLSZ07      -1.2017213  0.0065751  -182.769  &lt; 2e-16 ***
DESTIN_SZKLSZ08      -0.6083433  0.0050916  -119.480  &lt; 2e-16 ***
DESTIN_SZLKSZ01      -1.5186810  0.0204155   -74.389  &lt; 2e-16 ***
DESTIN_SZMDSZ01      -1.4601772  0.0198347   -73.617  &lt; 2e-16 ***
DESTIN_SZMDSZ02      -1.1554609  0.0111345  -103.773  &lt; 2e-16 ***
DESTIN_SZMDSZ03      -2.9919337  0.0250838  -119.277  &lt; 2e-16 ***
DESTIN_SZMPSZ01      -1.1705809  0.0077128  -151.771  &lt; 2e-16 ***
DESTIN_SZMPSZ02      -0.9380957  0.0060321  -155.517  &lt; 2e-16 ***
DESTIN_SZMPSZ03      -0.1761013  0.0046389   -37.962  &lt; 2e-16 ***
DESTIN_SZMUSZ02      -2.4525115  0.0199630  -122.853  &lt; 2e-16 ***
DESTIN_SZNTSZ01      -3.6605524  0.0447752   -81.754  &lt; 2e-16 ***
DESTIN_SZNTSZ02      -2.0082021  0.0108736  -184.686  &lt; 2e-16 ***
DESTIN_SZNTSZ03      -1.2387489  0.0076141  -162.691  &lt; 2e-16 ***
DESTIN_SZNTSZ05      -1.8054361  0.0249540   -72.351  &lt; 2e-16 ***
DESTIN_SZNTSZ06      -2.9500517  0.0428601   -68.830  &lt; 2e-16 ***
DESTIN_SZNVSZ01      -0.4089022  0.0044288   -92.327  &lt; 2e-16 ***
DESTIN_SZNVSZ02      -0.6865452  0.0052770  -130.102  &lt; 2e-16 ***
DESTIN_SZNVSZ03      -0.7333670  0.0054243  -135.199  &lt; 2e-16 ***
DESTIN_SZNVSZ04      -2.2095097  0.0106997  -206.503  &lt; 2e-16 ***
DESTIN_SZNVSZ05      -1.8721104  0.0089058  -210.212  &lt; 2e-16 ***
DESTIN_SZPGSZ01      -1.8756618  0.0153008  -122.586  &lt; 2e-16 ***
DESTIN_SZPGSZ02      -0.9435337  0.0067224  -140.356  &lt; 2e-16 ***
DESTIN_SZPGSZ03       0.3458476  0.0040152    86.134  &lt; 2e-16 ***
DESTIN_SZPGSZ04      -0.0271485  0.0044805    -6.059 1.37e-09 ***
DESTIN_SZPGSZ05      -0.8920273  0.0070730  -126.117  &lt; 2e-16 ***
DESTIN_SZPLSZ01      -0.2153087  0.0068270   -31.538  &lt; 2e-16 ***
DESTIN_SZPLSZ02      -1.3646116  0.0131155  -104.046  &lt; 2e-16 ***
DESTIN_SZPLSZ03      -0.0869245  0.0095838    -9.070  &lt; 2e-16 ***
DESTIN_SZPLSZ04      -0.2574560  0.0093336   -27.584  &lt; 2e-16 ***
DESTIN_SZPLSZ05      -0.7186364  0.0116835   -61.509  &lt; 2e-16 ***
DESTIN_SZPNSZ01       1.1326963  0.0049977   226.643  &lt; 2e-16 ***
DESTIN_SZPNSZ02       1.6516855  0.0064492   256.106  &lt; 2e-16 ***
DESTIN_SZPNSZ03       0.8504093  0.0077034   110.394  &lt; 2e-16 ***
DESTIN_SZPNSZ04       1.6891381  0.0075802   222.836  &lt; 2e-16 ***
DESTIN_SZPNSZ05       0.7402750  0.0115948    63.845  &lt; 2e-16 ***
DESTIN_SZPRSZ01      -1.0257636  0.0084652  -121.175  &lt; 2e-16 ***
DESTIN_SZPRSZ02      -0.2028503  0.0049839   -40.701  &lt; 2e-16 ***
DESTIN_SZPRSZ03       0.5560483  0.0038496   144.442  &lt; 2e-16 ***
DESTIN_SZPRSZ04      -0.6824142  0.0079047   -86.330  &lt; 2e-16 ***
DESTIN_SZPRSZ05       0.0316117  0.0044946     7.033 2.02e-12 ***
DESTIN_SZPRSZ06       0.3706283  0.0052006    71.267  &lt; 2e-16 ***
DESTIN_SZPRSZ07      -1.4740460  0.0117304  -125.661  &lt; 2e-16 ***
DESTIN_SZPRSZ08      -0.7869180  0.0064862  -121.321  &lt; 2e-16 ***
DESTIN_SZQTSZ01      -1.2790095  0.0085392  -149.781  &lt; 2e-16 ***
DESTIN_SZQTSZ02      -1.4989188  0.0073423  -204.149  &lt; 2e-16 ***
DESTIN_SZQTSZ03      -0.9334132  0.0064035  -145.765  &lt; 2e-16 ***
DESTIN_SZQTSZ04      -1.0506142  0.0065335  -160.805  &lt; 2e-16 ***
DESTIN_SZQTSZ05      -0.9765013  0.0058471  -167.006  &lt; 2e-16 ***
DESTIN_SZQTSZ06      -1.2206088  0.0063560  -192.042  &lt; 2e-16 ***
DESTIN_SZQTSZ07      -1.6794007  0.0108727  -154.460  &lt; 2e-16 ***
DESTIN_SZQTSZ08      -0.1214413  0.0047980   -25.311  &lt; 2e-16 ***
DESTIN_SZQTSZ09      -0.5252607  0.0057371   -91.555  &lt; 2e-16 ***
DESTIN_SZQTSZ10      -0.5981644  0.0054192  -110.378  &lt; 2e-16 ***
DESTIN_SZQTSZ11      -0.0766021  0.0053446   -14.333  &lt; 2e-16 ***
DESTIN_SZQTSZ12      -0.6153017  0.0070680   -87.054  &lt; 2e-16 ***
DESTIN_SZQTSZ13      -0.1690535  0.0051315   -32.944  &lt; 2e-16 ***
DESTIN_SZQTSZ14      -0.5398362  0.0062233   -86.744  &lt; 2e-16 ***
DESTIN_SZQTSZ15      -0.1873015  0.0073132   -25.611  &lt; 2e-16 ***
DESTIN_SZRCSZ01      -0.5875494  0.0071798   -81.833  &lt; 2e-16 ***
DESTIN_SZRCSZ06      -2.0856090  0.0188789  -110.473  &lt; 2e-16 ***
DESTIN_SZRVSZ01      -2.6183708  0.0162319  -161.310  &lt; 2e-16 ***
DESTIN_SZRVSZ02      -3.1882190  0.0326141   -97.756  &lt; 2e-16 ***
DESTIN_SZRVSZ03      -2.5981974  0.0135074  -192.353  &lt; 2e-16 ***
DESTIN_SZRVSZ04      -1.9741504  0.0154961  -127.396  &lt; 2e-16 ***
DESTIN_SZRVSZ05      -3.1547734  0.0256310  -123.084  &lt; 2e-16 ***
DESTIN_SZSBSZ01      -0.3097949  0.0060601   -51.121  &lt; 2e-16 ***
DESTIN_SZSBSZ02      -1.1229132  0.0076338  -147.097  &lt; 2e-16 ***
DESTIN_SZSBSZ03       0.6289715  0.0041400   151.926  &lt; 2e-16 ***
DESTIN_SZSBSZ04       0.1419430  0.0051357    27.638  &lt; 2e-16 ***
DESTIN_SZSBSZ05      -0.9256413  0.0071963  -128.628  &lt; 2e-16 ***
DESTIN_SZSBSZ06      -2.3487368  0.0221611  -105.984  &lt; 2e-16 ***
DESTIN_SZSBSZ07      -0.7864630  0.0181706   -43.282  &lt; 2e-16 ***
DESTIN_SZSBSZ08       1.3240051  0.0051598   256.599  &lt; 2e-16 ***
DESTIN_SZSBSZ09       0.8431156  0.0048330   174.449  &lt; 2e-16 ***
DESTIN_SZSESZ02      -0.2385874  0.0046618   -51.180  &lt; 2e-16 ***
DESTIN_SZSESZ03       0.5439188  0.0036932   147.276  &lt; 2e-16 ***
DESTIN_SZSESZ04      -0.6715716  0.0054222  -123.856  &lt; 2e-16 ***
DESTIN_SZSESZ05      -0.3601932  0.0047508   -75.818  &lt; 2e-16 ***
DESTIN_SZSESZ06      -0.6088413  0.0057017  -106.782  &lt; 2e-16 ***
DESTIN_SZSESZ07      -2.9477507  0.0226797  -129.973  &lt; 2e-16 ***
DESTIN_SZSGSZ01      -0.5100640  0.0058280   -87.519  &lt; 2e-16 ***
DESTIN_SZSGSZ02      -0.0439941  0.0051633    -8.520  &lt; 2e-16 ***
DESTIN_SZSGSZ03      -0.3700648  0.0047152   -78.483  &lt; 2e-16 ***
DESTIN_SZSGSZ04      -0.3021335  0.0046865   -64.468  &lt; 2e-16 ***
DESTIN_SZSGSZ05      -2.2253287  0.0097908  -227.288  &lt; 2e-16 ***
DESTIN_SZSGSZ06       0.2963602  0.0037948    78.097  &lt; 2e-16 ***
DESTIN_SZSGSZ07      -0.5940373  0.0051371  -115.637  &lt; 2e-16 ***
DESTIN_SZSISZ01      -1.4528976  0.0257790   -56.360  &lt; 2e-16 ***
DESTIN_SZSKSZ01      -0.0374952  0.0066885    -5.606 2.07e-08 ***
DESTIN_SZSKSZ02       0.7271418  0.0050281   144.617  &lt; 2e-16 ***
DESTIN_SZSKSZ03      -0.0640794  0.0059146   -10.834  &lt; 2e-16 ***
DESTIN_SZSKSZ04      -0.5610767  0.0139676   -40.170  &lt; 2e-16 ***
DESTIN_SZSKSZ05       0.1510974  0.0104871    14.408  &lt; 2e-16 ***
DESTIN_SZSLSZ01      -0.5823031  0.0083356   -69.858  &lt; 2e-16 ***
DESTIN_SZSLSZ04      -0.8166665  0.0070329  -116.122  &lt; 2e-16 ***
DESTIN_SZSRSZ01      -2.3241796  0.0127215  -182.696  &lt; 2e-16 ***
DESTIN_SZTHSZ01      -2.8157635  0.0366840   -76.757  &lt; 2e-16 ***
DESTIN_SZTHSZ03      -2.1005978  0.0250842   -83.742  &lt; 2e-16 ***
DESTIN_SZTHSZ04      -2.1246250  0.0213690   -99.425  &lt; 2e-16 ***
DESTIN_SZTHSZ06      -1.4571092  0.0150031   -97.121  &lt; 2e-16 ***
DESTIN_SZTMSZ01      -0.1234559  0.0055152   -22.385  &lt; 2e-16 ***
DESTIN_SZTMSZ02       1.5961628  0.0032599   489.635  &lt; 2e-16 ***
DESTIN_SZTMSZ03       0.6977233  0.0037138   187.875  &lt; 2e-16 ***
DESTIN_SZTMSZ04       0.8606606  0.0037592   228.947  &lt; 2e-16 ***
DESTIN_SZTMSZ05       0.3750655  0.0051281    73.140  &lt; 2e-16 ***
DESTIN_SZTNSZ01      -1.2624562  0.0066979  -188.485  &lt; 2e-16 ***
DESTIN_SZTNSZ02      -2.0761581  0.0096538  -215.062  &lt; 2e-16 ***
DESTIN_SZTNSZ03      -2.1128125  0.0115717  -182.584  &lt; 2e-16 ***
DESTIN_SZTNSZ04      -1.2417494  0.0068502  -181.271  &lt; 2e-16 ***
DESTIN_SZTPSZ01      -0.7094356  0.0055768  -127.211  &lt; 2e-16 ***
DESTIN_SZTPSZ02       0.1491604  0.0037260    40.032  &lt; 2e-16 ***
DESTIN_SZTPSZ03      -0.4973355  0.0054878   -90.626  &lt; 2e-16 ***
DESTIN_SZTPSZ04      -1.5160395  0.0071592  -211.761  &lt; 2e-16 ***
DESTIN_SZTPSZ05      -0.9196565  0.0056750  -162.054  &lt; 2e-16 ***
DESTIN_SZTPSZ06      -0.2710649  0.0062637   -43.276  &lt; 2e-16 ***
DESTIN_SZTPSZ07      -2.0198681  0.0116556  -173.296  &lt; 2e-16 ***
DESTIN_SZTPSZ08      -1.4881412  0.0085532  -173.987  &lt; 2e-16 ***
DESTIN_SZTPSZ09      -0.5901273  0.0059394   -99.358  &lt; 2e-16 ***
DESTIN_SZTPSZ10      -1.1215711  0.0084488  -132.749  &lt; 2e-16 ***
DESTIN_SZTPSZ11      -0.4837089  0.0050905   -95.022  &lt; 2e-16 ***
DESTIN_SZTPSZ12      -0.8653927  0.0061326  -141.113  &lt; 2e-16 ***
DESTIN_SZTSSZ01      -0.5515103  0.0208541   -26.446  &lt; 2e-16 ***
DESTIN_SZTSSZ02       0.8373778  0.0093757    89.314  &lt; 2e-16 ***
DESTIN_SZTSSZ03       1.7021888  0.0064394   264.340  &lt; 2e-16 ***
DESTIN_SZTSSZ04       1.5355016  0.0067855   226.292  &lt; 2e-16 ***
DESTIN_SZTSSZ05       1.6932319  0.0073725   229.668  &lt; 2e-16 ***
DESTIN_SZTSSZ06       0.4567808  0.0137927    33.118  &lt; 2e-16 ***
DESTIN_SZWCSZ01       1.3967640  0.0045392   307.711  &lt; 2e-16 ***
DESTIN_SZWCSZ02      -0.4560229  0.0122949   -37.090  &lt; 2e-16 ***
DESTIN_SZWCSZ03      -2.0710051  0.0325121   -63.699  &lt; 2e-16 ***
DESTIN_SZWDSZ01       1.5137342  0.0034774   435.310  &lt; 2e-16 ***
DESTIN_SZWDSZ02      -0.3005475  0.0055149   -54.497  &lt; 2e-16 ***
DESTIN_SZWDSZ03       1.2514543  0.0036112   346.550  &lt; 2e-16 ***
DESTIN_SZWDSZ04      -0.1702528  0.0058295   -29.205  &lt; 2e-16 ***
DESTIN_SZWDSZ05      -0.0005419  0.0053911    -0.101  0.91994    
DESTIN_SZWDSZ06       0.5203361  0.0040318   129.058  &lt; 2e-16 ***
DESTIN_SZWDSZ07       0.6006472  0.0061745    97.279  &lt; 2e-16 ***
DESTIN_SZWDSZ08       0.6650867  0.0060867   109.268  &lt; 2e-16 ***
DESTIN_SZWDSZ09       0.6237312  0.0044830   139.132  &lt; 2e-16 ***
DESTIN_SZYSSZ01       1.0471638  0.0038255   273.732  &lt; 2e-16 ***
DESTIN_SZYSSZ02       0.2341114  0.0048213    48.558  &lt; 2e-16 ***
DESTIN_SZYSSZ03      -0.0916446  0.0051335   -17.852  &lt; 2e-16 ***
DESTIN_SZYSSZ04      -0.0085536  0.0048684    -1.757  0.07892 .  
DESTIN_SZYSSZ05      -1.5775071  0.0100297  -157.283  &lt; 2e-16 ***
DESTIN_SZYSSZ06      -1.8130307  0.0098617  -183.846  &lt; 2e-16 ***
DESTIN_SZYSSZ07      -1.1703963  0.0111525  -104.945  &lt; 2e-16 ***
DESTIN_SZYSSZ08       0.5253514  0.0039556   132.813  &lt; 2e-16 ***
DESTIN_SZYSSZ09       0.4353435  0.0038890   111.943  &lt; 2e-16 ***
log(ORIGIN_AGE25_64)  0.2249135  0.0001404  1602.353  &lt; 2e-16 ***
log(dist)            -0.6989356  0.0001287 -5431.279  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 60796037  on 14733  degrees of freedom
Residual deviance: 26208384  on 14452  degrees of freedom
AIC: 26300575

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p>We can examine how the constraints hold for destinations this time.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(decSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, decSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4972985</code></pre>
</div>
</div>
</section>
<section id="doubly-constrained" class="level4">
<h4 class="anchored" data-anchor-id="doubly-constrained">Doubly constrained</h4>
<p>In this section, we will fit a doubly constrained SIM by using the code chunk below.</p>
<p>The general formula of Doubly Constrained Spatial Interaction Model</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>dbcSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>                ORIGIN_SZ <span class="sc">+</span> </span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>                DESTIN_SZ <span class="sc">+</span> </span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dbcSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ ORIGIN_SZ + DESTIN_SZ + log(dist), family = poisson(link = "log"), 
    data = SIM_data, na.action = na.exclude)

Coefficients:
                  Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)     12.4165310  0.0043949  2825.242  &lt; 2e-16 ***
ORIGIN_SZAMSZ02  0.9496891  0.0045740   207.630  &lt; 2e-16 ***
ORIGIN_SZAMSZ03  0.5519174  0.0046672   118.253  &lt; 2e-16 ***
ORIGIN_SZAMSZ04  0.1028140  0.0052468    19.596  &lt; 2e-16 ***
ORIGIN_SZAMSZ05  0.0822549  0.0058663    14.022  &lt; 2e-16 ***
ORIGIN_SZAMSZ06  0.6617809  0.0052580   125.861  &lt; 2e-16 ***
ORIGIN_SZAMSZ07 -0.9508298  0.0097681   -97.340  &lt; 2e-16 ***
ORIGIN_SZAMSZ08 -0.7271779  0.0090946   -79.958  &lt; 2e-16 ***
ORIGIN_SZAMSZ09  0.4896781  0.0055203    88.704  &lt; 2e-16 ***
ORIGIN_SZAMSZ10  0.4819428  0.0048175   100.040  &lt; 2e-16 ***
ORIGIN_SZAMSZ11 -1.7719841  0.0130695  -135.582  &lt; 2e-16 ***
ORIGIN_SZAMSZ12 -1.7679107  0.0108777  -162.526  &lt; 2e-16 ***
ORIGIN_SZBDSZ01  0.8314812  0.0045187   184.010  &lt; 2e-16 ***
ORIGIN_SZBDSZ02  0.4305836  0.0052535    81.961  &lt; 2e-16 ***
ORIGIN_SZBDSZ03  0.8009370  0.0046384   172.676  &lt; 2e-16 ***
ORIGIN_SZBDSZ04  1.4562985  0.0040456   359.971  &lt; 2e-16 ***
ORIGIN_SZBDSZ05  0.4501939  0.0046960    95.867  &lt; 2e-16 ***
ORIGIN_SZBDSZ06  0.7745026  0.0047424   163.314  &lt; 2e-16 ***
ORIGIN_SZBDSZ07 -1.1784123  0.0098105  -120.117  &lt; 2e-16 ***
ORIGIN_SZBDSZ08 -0.9830996  0.0091135  -107.873  &lt; 2e-16 ***
ORIGIN_SZBKSZ01 -0.3042966  0.0067086   -45.359  &lt; 2e-16 ***
ORIGIN_SZBKSZ02  0.4801541  0.0054160    88.655  &lt; 2e-16 ***
ORIGIN_SZBKSZ03  0.7823931  0.0052007   150.440  &lt; 2e-16 ***
ORIGIN_SZBKSZ04 -0.1292545  0.0061735   -20.937  &lt; 2e-16 ***
ORIGIN_SZBKSZ05 -0.0258584  0.0060192    -4.296 1.74e-05 ***
ORIGIN_SZBKSZ06  0.1994719  0.0061206    32.590  &lt; 2e-16 ***
ORIGIN_SZBKSZ07  0.7434860  0.0046598   159.553  &lt; 2e-16 ***
ORIGIN_SZBKSZ08  0.1625007  0.0055219    29.428  &lt; 2e-16 ***
ORIGIN_SZBKSZ09 -0.0864293  0.0059533   -14.518  &lt; 2e-16 ***
ORIGIN_SZBLSZ01 -2.1022485  0.0150316  -139.855  &lt; 2e-16 ***
ORIGIN_SZBLSZ02 -2.9460181  0.0195760  -150.491  &lt; 2e-16 ***
ORIGIN_SZBLSZ03 -4.9412872  0.0398540  -123.985  &lt; 2e-16 ***
ORIGIN_SZBLSZ04 -2.8143593  0.0239209  -117.653  &lt; 2e-16 ***
ORIGIN_SZBMSZ01 -0.0264561  0.0053639    -4.932 8.13e-07 ***
ORIGIN_SZBMSZ02 -0.8656513  0.0068511  -126.353  &lt; 2e-16 ***
ORIGIN_SZBMSZ03 -0.1723467  0.0059613   -28.911  &lt; 2e-16 ***
ORIGIN_SZBMSZ04  0.2169844  0.0053578    40.499  &lt; 2e-16 ***
ORIGIN_SZBMSZ05 -2.0252956  0.0126107  -160.602  &lt; 2e-16 ***
ORIGIN_SZBMSZ06 -1.7642018  0.0163931  -107.619  &lt; 2e-16 ***
ORIGIN_SZBMSZ07 -0.3271629  0.0058137   -56.274  &lt; 2e-16 ***
ORIGIN_SZBMSZ08 -0.2533255  0.0059335   -42.694  &lt; 2e-16 ***
ORIGIN_SZBMSZ09 -0.7712635  0.0087939   -87.704  &lt; 2e-16 ***
ORIGIN_SZBMSZ10 -1.0098048  0.0092519  -109.145  &lt; 2e-16 ***
ORIGIN_SZBMSZ11 -0.3816187  0.0067302   -56.702  &lt; 2e-16 ***
ORIGIN_SZBMSZ12 -0.6666616  0.0095680   -69.676  &lt; 2e-16 ***
ORIGIN_SZBMSZ13 -0.0076108  0.0059040    -1.289  0.19737    
ORIGIN_SZBMSZ14 -0.1682476  0.0069391   -24.246  &lt; 2e-16 ***
ORIGIN_SZBMSZ15  0.0904585  0.0062822    14.399  &lt; 2e-16 ***
ORIGIN_SZBMSZ16 -1.1808741  0.0092258  -127.997  &lt; 2e-16 ***
ORIGIN_SZBMSZ17 -1.7189127  0.0158408  -108.512  &lt; 2e-16 ***
ORIGIN_SZBPSZ01  0.4294645  0.0058051    73.980  &lt; 2e-16 ***
ORIGIN_SZBPSZ02  0.5028906  0.0068169    73.771  &lt; 2e-16 ***
ORIGIN_SZBPSZ03  0.6656178  0.0066126   100.658  &lt; 2e-16 ***
ORIGIN_SZBPSZ04  0.5203612  0.0053224    97.769  &lt; 2e-16 ***
ORIGIN_SZBPSZ05  0.5377769  0.0047907   112.256  &lt; 2e-16 ***
ORIGIN_SZBPSZ06 -1.2327809  0.0094950  -129.835  &lt; 2e-16 ***
ORIGIN_SZBPSZ07 -0.9035255  0.0088739  -101.818  &lt; 2e-16 ***
ORIGIN_SZBSSZ01  0.1210027  0.0053990    22.412  &lt; 2e-16 ***
ORIGIN_SZBSSZ02  0.4618449  0.0048641    94.951  &lt; 2e-16 ***
ORIGIN_SZBSSZ03  0.2160739  0.0047835    45.170  &lt; 2e-16 ***
ORIGIN_SZBTSZ01 -0.1108042  0.0055599   -19.929  &lt; 2e-16 ***
ORIGIN_SZBTSZ02 -0.8911221  0.0079213  -112.498  &lt; 2e-16 ***
ORIGIN_SZBTSZ03 -0.2203980  0.0059325   -37.151  &lt; 2e-16 ***
ORIGIN_SZBTSZ04 -0.6427946  0.0105438   -60.964  &lt; 2e-16 ***
ORIGIN_SZBTSZ05 -1.4662312  0.0111784  -131.166  &lt; 2e-16 ***
ORIGIN_SZBTSZ06 -0.6105884  0.0073456   -83.123  &lt; 2e-16 ***
ORIGIN_SZBTSZ07 -1.9041317  0.0132781  -143.404  &lt; 2e-16 ***
ORIGIN_SZBTSZ08 -1.0627939  0.0095982  -110.728  &lt; 2e-16 ***
ORIGIN_SZCBSZ01 -2.9365941  0.0548632   -53.526  &lt; 2e-16 ***
ORIGIN_SZCCSZ01 -1.5313555  0.0134599  -113.772  &lt; 2e-16 ***
ORIGIN_SZCHSZ01 -1.2034494  0.0119468  -100.734  &lt; 2e-16 ***
ORIGIN_SZCHSZ02 -0.8299415  0.0081984  -101.232  &lt; 2e-16 ***
ORIGIN_SZCHSZ03 -0.5143946  0.0061944   -83.042  &lt; 2e-16 ***
ORIGIN_SZCKSZ01  0.2372583  0.0053612    44.255  &lt; 2e-16 ***
ORIGIN_SZCKSZ02  0.9124836  0.0054472   167.515  &lt; 2e-16 ***
ORIGIN_SZCKSZ03  0.7237808  0.0048401   149.539  &lt; 2e-16 ***
ORIGIN_SZCKSZ04  1.6884022  0.0050169   336.540  &lt; 2e-16 ***
ORIGIN_SZCKSZ05  1.3932005  0.0062346   223.464  &lt; 2e-16 ***
ORIGIN_SZCKSZ06  1.0670053  0.0066112   161.394  &lt; 2e-16 ***
ORIGIN_SZCLSZ01 -0.8602837  0.0079240  -108.567  &lt; 2e-16 ***
ORIGIN_SZCLSZ02 -1.3853421  0.0137444  -100.793  &lt; 2e-16 ***
ORIGIN_SZCLSZ03 -0.8582608  0.0081177  -105.727  &lt; 2e-16 ***
ORIGIN_SZCLSZ04  0.7836027  0.0046427   168.782  &lt; 2e-16 ***
ORIGIN_SZCLSZ05 -1.8121756  0.0148960  -121.655  &lt; 2e-16 ***
ORIGIN_SZCLSZ06  0.8296870  0.0043909   188.955  &lt; 2e-16 ***
ORIGIN_SZCLSZ07 -0.2325219  0.0057432   -40.487  &lt; 2e-16 ***
ORIGIN_SZCLSZ08  0.2714336  0.0062625    43.342  &lt; 2e-16 ***
ORIGIN_SZCLSZ09 -2.2223744  0.0160946  -138.082  &lt; 2e-16 ***
ORIGIN_SZDTSZ02 -4.0704970  0.0834192   -48.796  &lt; 2e-16 ***
ORIGIN_SZDTSZ03 -3.4529031  0.0738295   -46.769  &lt; 2e-16 ***
ORIGIN_SZDTSZ13 -2.8301983  0.0313085   -90.397  &lt; 2e-16 ***
ORIGIN_SZGLSZ01 -1.4674986  0.0093137  -157.563  &lt; 2e-16 ***
ORIGIN_SZGLSZ02  0.2749369  0.0050051    54.931  &lt; 2e-16 ***
ORIGIN_SZGLSZ03  0.0781954  0.0049748    15.718  &lt; 2e-16 ***
ORIGIN_SZGLSZ04  0.8167797  0.0043260   188.808  &lt; 2e-16 ***
ORIGIN_SZGLSZ05  0.5277509  0.0044879   117.595  &lt; 2e-16 ***
ORIGIN_SZHGSZ01  0.2323885  0.0048555    47.861  &lt; 2e-16 ***
ORIGIN_SZHGSZ02  0.5707182  0.0048256   118.268  &lt; 2e-16 ***
ORIGIN_SZHGSZ03  0.4231170  0.0052149    81.136  &lt; 2e-16 ***
ORIGIN_SZHGSZ04  0.9341168  0.0044128   211.681  &lt; 2e-16 ***
ORIGIN_SZHGSZ05  1.2192790  0.0043790   278.437  &lt; 2e-16 ***
ORIGIN_SZHGSZ06  0.0490041  0.0054961     8.916  &lt; 2e-16 ***
ORIGIN_SZHGSZ07  0.6337041  0.0045735   138.559  &lt; 2e-16 ***
ORIGIN_SZHGSZ08  0.0312612  0.0054684     5.717 1.09e-08 ***
ORIGIN_SZHGSZ09 -0.6985397  0.0071800   -97.289  &lt; 2e-16 ***
ORIGIN_SZHGSZ10 -2.9958967  0.0422303   -70.942  &lt; 2e-16 ***
ORIGIN_SZJESZ01  0.4363431  0.0051329    85.010  &lt; 2e-16 ***
ORIGIN_SZJESZ02  0.3460900  0.0051372    67.370  &lt; 2e-16 ***
ORIGIN_SZJESZ03  0.2928005  0.0055108    53.132  &lt; 2e-16 ***
ORIGIN_SZJESZ04 -1.1924298  0.0093540  -127.478  &lt; 2e-16 ***
ORIGIN_SZJESZ05 -2.0178136  0.0139479  -144.668  &lt; 2e-16 ***
ORIGIN_SZJESZ06  0.1637633  0.0050685    32.310  &lt; 2e-16 ***
ORIGIN_SZJESZ07 -1.8227460  0.0119383  -152.680  &lt; 2e-16 ***
ORIGIN_SZJESZ08 -1.1556281  0.0117870   -98.043  &lt; 2e-16 ***
ORIGIN_SZJESZ09  0.4766229  0.0052813    90.248  &lt; 2e-16 ***
ORIGIN_SZJESZ10 -2.6868992  0.0186864  -143.789  &lt; 2e-16 ***
ORIGIN_SZJESZ11 -3.0618150  0.0199755  -153.278  &lt; 2e-16 ***
ORIGIN_SZJWSZ01  0.4417418  0.0068611    64.383  &lt; 2e-16 ***
ORIGIN_SZJWSZ02  0.9738087  0.0047905   203.281  &lt; 2e-16 ***
ORIGIN_SZJWSZ03  1.1548028  0.0045180   255.599  &lt; 2e-16 ***
ORIGIN_SZJWSZ04  0.9078417  0.0046668   194.532  &lt; 2e-16 ***
ORIGIN_SZJWSZ05 -1.7092500  0.0127422  -134.141  &lt; 2e-16 ***
ORIGIN_SZJWSZ06 -1.3284287  0.0109785  -121.002  &lt; 2e-16 ***
ORIGIN_SZJWSZ07 -2.3231549  0.0281427   -82.549  &lt; 2e-16 ***
ORIGIN_SZJWSZ08  1.9386127  0.0046041   421.059  &lt; 2e-16 ***
ORIGIN_SZJWSZ09  1.3987549  0.0042610   328.266  &lt; 2e-16 ***
ORIGIN_SZKLSZ01  0.2617735  0.0050089    52.261  &lt; 2e-16 ***
ORIGIN_SZKLSZ02 -0.4325093  0.0064279   -67.286  &lt; 2e-16 ***
ORIGIN_SZKLSZ03 -0.2787173  0.0060380   -46.161  &lt; 2e-16 ***
ORIGIN_SZKLSZ04 -1.9432693  0.0119163  -163.076  &lt; 2e-16 ***
ORIGIN_SZKLSZ05 -0.5420067  0.0085529   -63.371  &lt; 2e-16 ***
ORIGIN_SZKLSZ06 -4.2949009  0.1857686   -23.120  &lt; 2e-16 ***
ORIGIN_SZKLSZ07 -0.8576946  0.0085178  -100.694  &lt; 2e-16 ***
ORIGIN_SZKLSZ08 -1.3840925  0.0092323  -149.918  &lt; 2e-16 ***
ORIGIN_SZLKSZ01 -2.8108510  0.0392356   -71.640  &lt; 2e-16 ***
ORIGIN_SZMDSZ01 -1.6745388  0.0296543   -56.469  &lt; 2e-16 ***
ORIGIN_SZMDSZ02 -0.8193738  0.0106631   -76.842  &lt; 2e-16 ***
ORIGIN_SZMDSZ03 -1.5088267  0.0172032   -87.706  &lt; 2e-16 ***
ORIGIN_SZMPSZ01 -0.9860154  0.0085053  -115.929  &lt; 2e-16 ***
ORIGIN_SZMPSZ02 -0.5958875  0.0070097   -85.008  &lt; 2e-16 ***
ORIGIN_SZMPSZ03 -0.0490122  0.0054582    -8.980  &lt; 2e-16 ***
ORIGIN_SZMUSZ02 -3.5233367  0.1037749   -33.952  &lt; 2e-16 ***
ORIGIN_SZNTSZ01 -2.6451541  0.0353125   -74.907  &lt; 2e-16 ***
ORIGIN_SZNTSZ02 -2.7710546  0.0232841  -119.011  &lt; 2e-16 ***
ORIGIN_SZNTSZ03 -0.6123404  0.0079083   -77.430  &lt; 2e-16 ***
ORIGIN_SZNTSZ05 -2.9257445  0.0496704   -58.903  &lt; 2e-16 ***
ORIGIN_SZNTSZ06 -3.3260031  0.0557966   -59.609  &lt; 2e-16 ***
ORIGIN_SZNVSZ01  0.6421306  0.0046037   139.482  &lt; 2e-16 ***
ORIGIN_SZNVSZ02 -0.4251550  0.0065890   -64.525  &lt; 2e-16 ***
ORIGIN_SZNVSZ03 -1.0765622  0.0078766  -136.679  &lt; 2e-16 ***
ORIGIN_SZNVSZ04 -1.2289504  0.0091468  -134.358  &lt; 2e-16 ***
ORIGIN_SZNVSZ05 -2.3551389  0.0158219  -148.853  &lt; 2e-16 ***
ORIGIN_SZPGSZ01  0.1518212  0.0154825     9.806  &lt; 2e-16 ***
ORIGIN_SZPGSZ02 -0.4062609  0.0073780   -55.064  &lt; 2e-16 ***
ORIGIN_SZPGSZ03  0.8976913  0.0046122   194.636  &lt; 2e-16 ***
ORIGIN_SZPGSZ04  1.1161685  0.0045850   243.437  &lt; 2e-16 ***
ORIGIN_SZPGSZ05  0.4794249  0.0060213    79.621  &lt; 2e-16 ***
ORIGIN_SZPLSZ01 -0.8322377  0.0107898   -77.132  &lt; 2e-16 ***
ORIGIN_SZPLSZ02 -1.2968937  0.0149841   -86.551  &lt; 2e-16 ***
ORIGIN_SZPLSZ03 -3.2744991  0.0374541   -87.427  &lt; 2e-16 ***
ORIGIN_SZPLSZ04 -3.5423615  0.0372570   -95.079  &lt; 2e-16 ***
ORIGIN_SZPLSZ05 -2.4343705  0.0227807  -106.861  &lt; 2e-16 ***
ORIGIN_SZPNSZ01  0.8052461  0.0056124   143.476  &lt; 2e-16 ***
ORIGIN_SZPNSZ02 -1.8042362  0.0128222  -140.712  &lt; 2e-16 ***
ORIGIN_SZPNSZ03 -2.6363996  0.0200058  -131.782  &lt; 2e-16 ***
ORIGIN_SZPNSZ04 -4.8427070  0.0320126  -151.275  &lt; 2e-16 ***
ORIGIN_SZPNSZ05 -3.6613775  0.0285686  -128.161  &lt; 2e-16 ***
ORIGIN_SZPRSZ01 -0.5645384  0.0117126   -48.199  &lt; 2e-16 ***
ORIGIN_SZPRSZ02  0.9145886  0.0048137   189.998  &lt; 2e-16 ***
ORIGIN_SZPRSZ03  0.4478971  0.0048102    93.113  &lt; 2e-16 ***
ORIGIN_SZPRSZ04 -0.5312444  0.0079019   -67.230  &lt; 2e-16 ***
ORIGIN_SZPRSZ05  1.1462662  0.0045250   253.318  &lt; 2e-16 ***
ORIGIN_SZPRSZ06 -0.7392744  0.0090347   -81.826  &lt; 2e-16 ***
ORIGIN_SZPRSZ07 -2.1667862  0.0162528  -133.318  &lt; 2e-16 ***
ORIGIN_SZPRSZ08 -0.1327079  0.0065712   -20.195  &lt; 2e-16 ***
ORIGIN_SZQTSZ01  0.1062151  0.0071538    14.847  &lt; 2e-16 ***
ORIGIN_SZQTSZ02 -0.4993990  0.0064382   -77.568  &lt; 2e-16 ***
ORIGIN_SZQTSZ03  0.1161844  0.0058822    19.752  &lt; 2e-16 ***
ORIGIN_SZQTSZ04 -0.8102612  0.0072742  -111.389  &lt; 2e-16 ***
ORIGIN_SZQTSZ05 -0.0417272  0.0061917    -6.739 1.59e-11 ***
ORIGIN_SZQTSZ06 -0.2521417  0.0066449   -37.945  &lt; 2e-16 ***
ORIGIN_SZQTSZ07 -1.2395975  0.0097496  -127.143  &lt; 2e-16 ***
ORIGIN_SZQTSZ08 -0.1105467  0.0059364   -18.622  &lt; 2e-16 ***
ORIGIN_SZQTSZ09 -0.5078461  0.0067895   -74.798  &lt; 2e-16 ***
ORIGIN_SZQTSZ10 -0.3866593  0.0066995   -57.714  &lt; 2e-16 ***
ORIGIN_SZQTSZ11 -1.5264609  0.0099770  -152.998  &lt; 2e-16 ***
ORIGIN_SZQTSZ12 -1.3866518  0.0106887  -129.730  &lt; 2e-16 ***
ORIGIN_SZQTSZ13 -0.3764286  0.0066707   -56.430  &lt; 2e-16 ***
ORIGIN_SZQTSZ14 -1.4907399  0.0100120  -148.896  &lt; 2e-16 ***
ORIGIN_SZQTSZ15 -1.0552239  0.0108792   -96.994  &lt; 2e-16 ***
ORIGIN_SZRCSZ01 -1.3136074  0.0126986  -103.445  &lt; 2e-16 ***
ORIGIN_SZRCSZ06 -0.2418276  0.0085509   -28.281  &lt; 2e-16 ***
ORIGIN_SZRVSZ01 -2.9263747  0.0324968   -90.051  &lt; 2e-16 ***
ORIGIN_SZRVSZ02 -2.2980940  0.0278202   -82.605  &lt; 2e-16 ***
ORIGIN_SZRVSZ03 -2.4663765  0.0238674  -103.336  &lt; 2e-16 ***
ORIGIN_SZRVSZ04 -3.1853677  0.0556939   -57.194  &lt; 2e-16 ***
ORIGIN_SZRVSZ05 -1.5695490  0.0166684   -94.163  &lt; 2e-16 ***
ORIGIN_SZSBSZ01  0.7674590  0.0061811   124.163  &lt; 2e-16 ***
ORIGIN_SZSBSZ02 -0.7307279  0.0084105   -86.883  &lt; 2e-16 ***
ORIGIN_SZSBSZ03  0.5920074  0.0050167   118.008  &lt; 2e-16 ***
ORIGIN_SZSBSZ04  0.3684857  0.0058575    62.908  &lt; 2e-16 ***
ORIGIN_SZSBSZ05 -0.0036863  0.0068459    -0.538  0.59026    
ORIGIN_SZSBSZ06 -1.1939284  0.0181541   -65.766  &lt; 2e-16 ***
ORIGIN_SZSBSZ07 -0.4896579  0.0135618   -36.106  &lt; 2e-16 ***
ORIGIN_SZSBSZ08 -2.1221691  0.0127258  -166.762  &lt; 2e-16 ***
ORIGIN_SZSBSZ09 -1.2032410  0.0089611  -134.273  &lt; 2e-16 ***
ORIGIN_SZSESZ02  1.0721820  0.0045336   236.498  &lt; 2e-16 ***
ORIGIN_SZSESZ03  1.0808012  0.0042923   251.801  &lt; 2e-16 ***
ORIGIN_SZSESZ04  1.0137448  0.0050668   200.076  &lt; 2e-16 ***
ORIGIN_SZSESZ05 -0.1678679  0.0060206   -27.882  &lt; 2e-16 ***
ORIGIN_SZSESZ06  0.9165834  0.0048323   189.677  &lt; 2e-16 ***
ORIGIN_SZSESZ07 -2.2499789  0.0196327  -114.603  &lt; 2e-16 ***
ORIGIN_SZSGSZ01 -0.9369800  0.0087282  -107.351  &lt; 2e-16 ***
ORIGIN_SZSGSZ02 -1.1690716  0.0097131  -120.360  &lt; 2e-16 ***
ORIGIN_SZSGSZ03  0.2604352  0.0052709    49.410  &lt; 2e-16 ***
ORIGIN_SZSGSZ04  0.3468823  0.0048897    70.942  &lt; 2e-16 ***
ORIGIN_SZSGSZ05 -1.5927797  0.0106308  -149.827  &lt; 2e-16 ***
ORIGIN_SZSGSZ06  0.3605651  0.0046361    77.774  &lt; 2e-16 ***
ORIGIN_SZSGSZ07 -0.5333873  0.0063119   -84.504  &lt; 2e-16 ***
ORIGIN_SZSKSZ01 -0.2706750  0.0082836   -32.676  &lt; 2e-16 ***
ORIGIN_SZSKSZ02  0.0970953  0.0063378    15.320  &lt; 2e-16 ***
ORIGIN_SZSKSZ03 -0.6954342  0.0082538   -84.256  &lt; 2e-16 ***
ORIGIN_SZSKSZ04 -2.3863580  0.0284607   -83.847  &lt; 2e-16 ***
ORIGIN_SZSKSZ05 -1.5443140  0.0179059   -86.246  &lt; 2e-16 ***
ORIGIN_SZSLSZ01 -2.9450656  0.0307283   -95.842  &lt; 2e-16 ***
ORIGIN_SZSLSZ04 -0.5739349  0.0077851   -73.722  &lt; 2e-16 ***
ORIGIN_SZSRSZ01 -1.6136735  0.0160199  -100.729  &lt; 2e-16 ***
ORIGIN_SZTHSZ01 -2.6034976  0.0489378   -53.200  &lt; 2e-16 ***
ORIGIN_SZTHSZ03 -1.2770601  0.0229815   -55.569  &lt; 2e-16 ***
ORIGIN_SZTHSZ04 -2.0110399  0.0287527   -69.943  &lt; 2e-16 ***
ORIGIN_SZTHSZ06 -1.7720116  0.0180394   -98.230  &lt; 2e-16 ***
ORIGIN_SZTMSZ01  0.1254729  0.0060924    20.595  &lt; 2e-16 ***
ORIGIN_SZTMSZ02  1.6667504  0.0039836   418.403  &lt; 2e-16 ***
ORIGIN_SZTMSZ03  1.0941176  0.0042911   254.976  &lt; 2e-16 ***
ORIGIN_SZTMSZ04  0.3209520  0.0050349    63.746  &lt; 2e-16 ***
ORIGIN_SZTMSZ05 -0.8155124  0.0079342  -102.785  &lt; 2e-16 ***
ORIGIN_SZTNSZ01 -1.4237298  0.0104636  -136.064  &lt; 2e-16 ***
ORIGIN_SZTNSZ02 -1.2718890  0.0098660  -128.916  &lt; 2e-16 ***
ORIGIN_SZTNSZ03 -1.7960517  0.0134675  -133.362  &lt; 2e-16 ***
ORIGIN_SZTNSZ04 -0.3508142  0.0073556   -47.694  &lt; 2e-16 ***
ORIGIN_SZTPSZ01 -0.3841699  0.0064137   -59.898  &lt; 2e-16 ***
ORIGIN_SZTPSZ02  0.5315265  0.0044497   119.451  &lt; 2e-16 ***
ORIGIN_SZTPSZ03 -0.4669723  0.0062160   -75.124  &lt; 2e-16 ***
ORIGIN_SZTPSZ04 -0.0617169  0.0058830   -10.491  &lt; 2e-16 ***
ORIGIN_SZTPSZ05  0.0713309  0.0062133    11.480  &lt; 2e-16 ***
ORIGIN_SZTPSZ06  0.6800356  0.0069456    97.909  &lt; 2e-16 ***
ORIGIN_SZTPSZ07 -0.0432782  0.0064382    -6.722 1.79e-11 ***
ORIGIN_SZTPSZ08 -0.6976429  0.0092416   -75.490  &lt; 2e-16 ***
ORIGIN_SZTPSZ09 -0.3708833  0.0063548   -58.363  &lt; 2e-16 ***
ORIGIN_SZTPSZ10 -0.4063575  0.0077803   -52.229  &lt; 2e-16 ***
ORIGIN_SZTPSZ11  0.1040282  0.0056115    18.538  &lt; 2e-16 ***
ORIGIN_SZTPSZ12 -0.5104672  0.0066261   -77.039  &lt; 2e-16 ***
ORIGIN_SZTSSZ01 -3.5036830  0.0487290   -71.901  &lt; 2e-16 ***
ORIGIN_SZTSSZ02 -0.0386819  0.0094886    -4.077 4.57e-05 ***
ORIGIN_SZTSSZ03 -0.3862387  0.0095139   -40.597  &lt; 2e-16 ***
ORIGIN_SZTSSZ04 -0.6380676  0.0099905   -63.867  &lt; 2e-16 ***
ORIGIN_SZTSSZ05 -2.7354613  0.0162414  -168.425  &lt; 2e-16 ***
ORIGIN_SZTSSZ06 -2.6310865  0.0255772  -102.868  &lt; 2e-16 ***
ORIGIN_SZWCSZ01 -1.1561047  0.0087394  -132.286  &lt; 2e-16 ***
ORIGIN_SZWCSZ02 -2.6956217  0.0319117   -84.471  &lt; 2e-16 ***
ORIGIN_SZWCSZ03 -4.3526889  0.1241082   -35.072  &lt; 2e-16 ***
ORIGIN_SZWDSZ01  0.8712417  0.0043720   199.277  &lt; 2e-16 ***
ORIGIN_SZWDSZ02  0.9119539  0.0050326   181.210  &lt; 2e-16 ***
ORIGIN_SZWDSZ03  1.6205678  0.0045250   358.136  &lt; 2e-16 ***
ORIGIN_SZWDSZ04  1.2081941  0.0054272   222.618  &lt; 2e-16 ***
ORIGIN_SZWDSZ05  0.4284783  0.0052752    81.224  &lt; 2e-16 ***
ORIGIN_SZWDSZ06  0.9018716  0.0049820   181.028  &lt; 2e-16 ***
ORIGIN_SZWDSZ07 -0.6444820  0.0084731   -76.062  &lt; 2e-16 ***
ORIGIN_SZWDSZ08 -0.8764983  0.0082622  -106.085  &lt; 2e-16 ***
ORIGIN_SZWDSZ09  1.3292589  0.0048663   273.158  &lt; 2e-16 ***
ORIGIN_SZYSSZ01 -0.4780462  0.0058489   -81.733  &lt; 2e-16 ***
ORIGIN_SZYSSZ02  0.9323419  0.0054402   171.380  &lt; 2e-16 ***
ORIGIN_SZYSSZ03  2.0577240  0.0046737   440.274  &lt; 2e-16 ***
ORIGIN_SZYSSZ04  0.8697472  0.0047269   184.000  &lt; 2e-16 ***
ORIGIN_SZYSSZ05  0.1662764  0.0060376    27.540  &lt; 2e-16 ***
ORIGIN_SZYSSZ06 -0.8115617  0.0109084   -74.398  &lt; 2e-16 ***
ORIGIN_SZYSSZ07 -0.8971248  0.0119220   -75.250  &lt; 2e-16 ***
ORIGIN_SZYSSZ08 -0.2738680  0.0063553   -43.093  &lt; 2e-16 ***
ORIGIN_SZYSSZ09  1.2274518  0.0044951   273.066  &lt; 2e-16 ***
DESTIN_SZAMSZ02 -0.0516322  0.0042829   -12.055  &lt; 2e-16 ***
DESTIN_SZAMSZ03  0.0801823  0.0041904    19.135  &lt; 2e-16 ***
DESTIN_SZAMSZ04 -0.9282211  0.0061322  -151.368  &lt; 2e-16 ***
DESTIN_SZAMSZ05 -1.0794168  0.0062543  -172.588  &lt; 2e-16 ***
DESTIN_SZAMSZ06 -0.8839603  0.0060851  -145.267  &lt; 2e-16 ***
DESTIN_SZAMSZ07 -1.5835093  0.0096846  -163.508  &lt; 2e-16 ***
DESTIN_SZAMSZ08 -0.9756903  0.0068829  -141.756  &lt; 2e-16 ***
DESTIN_SZAMSZ09 -1.0362692  0.0061651  -168.087  &lt; 2e-16 ***
DESTIN_SZAMSZ10 -0.1227646  0.0044788   -27.410  &lt; 2e-16 ***
DESTIN_SZAMSZ11 -0.4802374  0.0088108   -54.506  &lt; 2e-16 ***
DESTIN_SZAMSZ12  0.2142621  0.0050653    42.300  &lt; 2e-16 ***
DESTIN_SZBDSZ01  0.3582789  0.0039578    90.524  &lt; 2e-16 ***
DESTIN_SZBDSZ02 -0.4368229  0.0051384   -85.012  &lt; 2e-16 ***
DESTIN_SZBDSZ03 -0.1568727  0.0044329   -35.388  &lt; 2e-16 ***
DESTIN_SZBDSZ04  0.6731669  0.0036215   185.882  &lt; 2e-16 ***
DESTIN_SZBDSZ05  0.3647198  0.0040496    90.062  &lt; 2e-16 ***
DESTIN_SZBDSZ06  0.0589240  0.0044352    13.286  &lt; 2e-16 ***
DESTIN_SZBDSZ07 -0.6648168  0.0095742   -69.438  &lt; 2e-16 ***
DESTIN_SZBDSZ08 -1.7214136  0.0106600  -161.483  &lt; 2e-16 ***
DESTIN_SZBKSZ01 -1.2688264  0.0067263  -188.637  &lt; 2e-16 ***
DESTIN_SZBKSZ02 -0.3912129  0.0055446   -70.558  &lt; 2e-16 ***
DESTIN_SZBKSZ03 -0.8663392  0.0058693  -147.605  &lt; 2e-16 ***
DESTIN_SZBKSZ04 -0.1247273  0.0051254   -24.335  &lt; 2e-16 ***
DESTIN_SZBKSZ05 -0.7407774  0.0059120  -125.300  &lt; 2e-16 ***
DESTIN_SZBKSZ06 -0.9934643  0.0063345  -156.834  &lt; 2e-16 ***
DESTIN_SZBKSZ07  0.0882230  0.0042928    20.551  &lt; 2e-16 ***
DESTIN_SZBKSZ08 -1.1134447  0.0070752  -157.372  &lt; 2e-16 ***
DESTIN_SZBKSZ09 -0.1788171  0.0051327   -34.839  &lt; 2e-16 ***
DESTIN_SZBLSZ01 -0.7696433  0.0071898  -107.047  &lt; 2e-16 ***
DESTIN_SZBLSZ02  0.4076650  0.0068001    59.950  &lt; 2e-16 ***
DESTIN_SZBLSZ03  1.5398488  0.0078230   196.836  &lt; 2e-16 ***
DESTIN_SZBLSZ04 -0.3499486  0.0136985   -25.546  &lt; 2e-16 ***
DESTIN_SZBMSZ01 -0.2114705  0.0048311   -43.773  &lt; 2e-16 ***
DESTIN_SZBMSZ02 -0.3316806  0.0049958   -66.391  &lt; 2e-16 ***
DESTIN_SZBMSZ03 -0.5134774  0.0058534   -87.723  &lt; 2e-16 ***
DESTIN_SZBMSZ04 -0.2205274  0.0051028   -43.217  &lt; 2e-16 ***
DESTIN_SZBMSZ05 -0.2101165  0.0067710   -31.032  &lt; 2e-16 ***
DESTIN_SZBMSZ06 -1.3832385  0.0124821  -110.818  &lt; 2e-16 ***
DESTIN_SZBMSZ07 -0.0133462  0.0046787    -2.853  0.00434 ** 
DESTIN_SZBMSZ08 -0.9056756  0.0063868  -141.805  &lt; 2e-16 ***
DESTIN_SZBMSZ09 -2.3175407  0.0144523  -160.358  &lt; 2e-16 ***
DESTIN_SZBMSZ10 -1.3973725  0.0090463  -154.470  &lt; 2e-16 ***
DESTIN_SZBMSZ11 -1.3950206  0.0080459  -173.383  &lt; 2e-16 ***
DESTIN_SZBMSZ12 -0.6882789  0.0081539   -84.411  &lt; 2e-16 ***
DESTIN_SZBMSZ13 -0.2729120  0.0052969   -51.523  &lt; 2e-16 ***
DESTIN_SZBMSZ14 -0.7581980  0.0080215   -94.521  &lt; 2e-16 ***
DESTIN_SZBMSZ15 -0.9323237  0.0071093  -131.142  &lt; 2e-16 ***
DESTIN_SZBMSZ16 -2.0655530  0.0108490  -190.391  &lt; 2e-16 ***
DESTIN_SZBMSZ17 -2.5124893  0.0165366  -151.935  &lt; 2e-16 ***
DESTIN_SZBPSZ01 -0.8203274  0.0057682  -142.216  &lt; 2e-16 ***
DESTIN_SZBPSZ02 -1.5284265  0.0087447  -174.783  &lt; 2e-16 ***
DESTIN_SZBPSZ03 -1.2434382  0.0080852  -153.792  &lt; 2e-16 ***
DESTIN_SZBPSZ04 -0.7778558  0.0060900  -127.727  &lt; 2e-16 ***
DESTIN_SZBPSZ05  0.1782204  0.0042331    42.101  &lt; 2e-16 ***
DESTIN_SZBPSZ06 -0.6758807  0.0079728   -84.773  &lt; 2e-16 ***
DESTIN_SZBPSZ07 -0.5029450  0.0081151   -61.976  &lt; 2e-16 ***
DESTIN_SZBSSZ01 -0.1269916  0.0046949   -27.049  &lt; 2e-16 ***
DESTIN_SZBSSZ02 -0.7536917  0.0051895  -145.233  &lt; 2e-16 ***
DESTIN_SZBSSZ03  0.2747969  0.0039115    70.254  &lt; 2e-16 ***
DESTIN_SZBTSZ01  0.1708577  0.0043381    39.385  &lt; 2e-16 ***
DESTIN_SZBTSZ02 -0.6820190  0.0067243  -101.427  &lt; 2e-16 ***
DESTIN_SZBTSZ03  0.0610599  0.0049825    12.255  &lt; 2e-16 ***
DESTIN_SZBTSZ04 -1.3199639  0.0107063  -123.288  &lt; 2e-16 ***
DESTIN_SZBTSZ05 -0.4174991  0.0069221   -60.314  &lt; 2e-16 ***
DESTIN_SZBTSZ06 -0.5260242  0.0061145   -86.029  &lt; 2e-16 ***
DESTIN_SZBTSZ07 -1.6678047  0.0106335  -156.844  &lt; 2e-16 ***
DESTIN_SZBTSZ08 -0.7999935  0.0089175   -89.711  &lt; 2e-16 ***
DESTIN_SZCBSZ01 -5.6321332  0.3162476   -17.809  &lt; 2e-16 ***
DESTIN_SZCCSZ01 -0.9342781  0.0081409  -114.763  &lt; 2e-16 ***
DESTIN_SZCHSZ01 -1.2808546  0.0096774  -132.355  &lt; 2e-16 ***
DESTIN_SZCHSZ02  0.0067332  0.0054322     1.239  0.21516    
DESTIN_SZCHSZ03  1.0988838  0.0041378   265.570  &lt; 2e-16 ***
DESTIN_SZCKSZ01 -0.3192235  0.0050632   -63.048  &lt; 2e-16 ***
DESTIN_SZCKSZ02 -0.7776453  0.0055279  -140.676  &lt; 2e-16 ***
DESTIN_SZCKSZ03  0.2772358  0.0042541    65.170  &lt; 2e-16 ***
DESTIN_SZCKSZ04 -1.3842048  0.0065159  -212.436  &lt; 2e-16 ***
DESTIN_SZCKSZ05 -1.2051808  0.0076814  -156.897  &lt; 2e-16 ***
DESTIN_SZCKSZ06  0.1321955  0.0061568    21.472  &lt; 2e-16 ***
DESTIN_SZCLSZ01  0.1942449  0.0049977    38.867  &lt; 2e-16 ***
DESTIN_SZCLSZ02 -2.0828648  0.0134597  -154.749  &lt; 2e-16 ***
DESTIN_SZCLSZ03 -0.8823728  0.0078307  -112.681  &lt; 2e-16 ***
DESTIN_SZCLSZ04 -0.2311432  0.0047194   -48.977  &lt; 2e-16 ***
DESTIN_SZCLSZ05 -1.0113430  0.0085536  -118.237  &lt; 2e-16 ***
DESTIN_SZCLSZ06  0.0694682  0.0042166    16.475  &lt; 2e-16 ***
DESTIN_SZCLSZ07 -0.4953961  0.0054184   -91.429  &lt; 2e-16 ***
DESTIN_SZCLSZ08 -0.3849563  0.0061404   -62.693  &lt; 2e-16 ***
DESTIN_SZCLSZ09  0.4201808  0.0067112    62.609  &lt; 2e-16 ***
DESTIN_SZDTSZ02 -2.6513032  0.0348725   -76.029  &lt; 2e-16 ***
DESTIN_SZDTSZ03 -1.5192228  0.0144477  -105.153  &lt; 2e-16 ***
DESTIN_SZDTSZ13 -2.2041951  0.0161726  -136.292  &lt; 2e-16 ***
DESTIN_SZGLSZ01 -0.0139744  0.0052464    -2.664  0.00773 ** 
DESTIN_SZGLSZ02 -0.2850816  0.0047467   -60.059  &lt; 2e-16 ***
DESTIN_SZGLSZ03  0.3511872  0.0039473    88.969  &lt; 2e-16 ***
DESTIN_SZGLSZ04  0.2909117  0.0039436    73.769  &lt; 2e-16 ***
DESTIN_SZGLSZ05  0.1845361  0.0040011    46.121  &lt; 2e-16 ***
DESTIN_SZHGSZ01  0.1418382  0.0039875    35.571  &lt; 2e-16 ***
DESTIN_SZHGSZ02 -0.7233151  0.0052374  -138.105  &lt; 2e-16 ***
DESTIN_SZHGSZ03 -1.1918463  0.0062129  -191.834  &lt; 2e-16 ***
DESTIN_SZHGSZ04 -0.4380360  0.0044839   -97.691  &lt; 2e-16 ***
DESTIN_SZHGSZ05 -0.5671024  0.0046427  -122.149  &lt; 2e-16 ***
DESTIN_SZHGSZ06 -0.8271411  0.0054935  -150.566  &lt; 2e-16 ***
DESTIN_SZHGSZ07  0.0721800  0.0041589    17.356  &lt; 2e-16 ***
DESTIN_SZHGSZ08 -0.4297429  0.0050021   -85.913  &lt; 2e-16 ***
DESTIN_SZHGSZ09 -0.2085461  0.0052544   -39.690  &lt; 2e-16 ***
DESTIN_SZHGSZ10 -2.9169699  0.0262698  -111.039  &lt; 2e-16 ***
DESTIN_SZJESZ01 -0.2822473  0.0051166   -55.163  &lt; 2e-16 ***
DESTIN_SZJESZ02 -0.6761389  0.0053635  -126.063  &lt; 2e-16 ***
DESTIN_SZJESZ03 -0.7371756  0.0058983  -124.980  &lt; 2e-16 ***
DESTIN_SZJESZ04 -0.4593491  0.0067970   -67.581  &lt; 2e-16 ***
DESTIN_SZJESZ05 -1.1418012  0.0099049  -115.277  &lt; 2e-16 ***
DESTIN_SZJESZ06  0.1759680  0.0042791    41.123  &lt; 2e-16 ***
DESTIN_SZJESZ07 -1.2260587  0.0082714  -148.229  &lt; 2e-16 ***
DESTIN_SZJESZ08 -0.8547001  0.0080417  -106.283  &lt; 2e-16 ***
DESTIN_SZJESZ09 -0.4306353  0.0057006   -75.542  &lt; 2e-16 ***
DESTIN_SZJESZ10  0.6584971  0.0073664    89.392  &lt; 2e-16 ***
DESTIN_SZJESZ11  0.9661208  0.0070491   137.056  &lt; 2e-16 ***
DESTIN_SZJWSZ01 -0.9128436  0.0069529  -131.290  &lt; 2e-16 ***
DESTIN_SZJWSZ02 -0.7285851  0.0054839  -132.859  &lt; 2e-16 ***
DESTIN_SZJWSZ03  0.2601455  0.0043215    60.198  &lt; 2e-16 ***
DESTIN_SZJWSZ04  0.6860274  0.0041135   166.775  &lt; 2e-16 ***
DESTIN_SZJWSZ05 -0.4684576  0.0062875   -74.506  &lt; 2e-16 ***
DESTIN_SZJWSZ06 -0.2459774  0.0057575   -42.723  &lt; 2e-16 ***
DESTIN_SZJWSZ07 -1.8854234  0.0287721   -65.529  &lt; 2e-16 ***
DESTIN_SZJWSZ08 -0.5523308  0.0051054  -108.186  &lt; 2e-16 ***
DESTIN_SZJWSZ09  0.8818747  0.0037800   233.301  &lt; 2e-16 ***
DESTIN_SZKLSZ01 -0.5814386  0.0052711  -110.308  &lt; 2e-16 ***
DESTIN_SZKLSZ02 -0.7090577  0.0058161  -121.914  &lt; 2e-16 ***
DESTIN_SZKLSZ03 -1.2191910  0.0065984  -184.772  &lt; 2e-16 ***
DESTIN_SZKLSZ04 -1.6961428  0.0087866  -193.038  &lt; 2e-16 ***
DESTIN_SZKLSZ05 -0.6927144  0.0073574   -94.153  &lt; 2e-16 ***
DESTIN_SZKLSZ06 -2.2967464  0.0362605   -63.340  &lt; 2e-16 ***
DESTIN_SZKLSZ07 -0.9536980  0.0066777  -142.819  &lt; 2e-16 ***
DESTIN_SZKLSZ08 -0.4565596  0.0051736   -88.249  &lt; 2e-16 ***
DESTIN_SZLKSZ01 -1.7277135  0.0207336   -83.329  &lt; 2e-16 ***
DESTIN_SZMDSZ01 -1.7155417  0.0210080   -81.661  &lt; 2e-16 ***
DESTIN_SZMDSZ02 -1.3694928  0.0114174  -119.948  &lt; 2e-16 ***
DESTIN_SZMDSZ03 -2.7183729  0.0252678  -107.582  &lt; 2e-16 ***
DESTIN_SZMPSZ01 -0.8051991  0.0078564  -102.490  &lt; 2e-16 ***
DESTIN_SZMPSZ02 -0.7627000  0.0061386  -124.246  &lt; 2e-16 ***
DESTIN_SZMPSZ03 -0.0649484  0.0047787   -13.591  &lt; 2e-16 ***
DESTIN_SZMUSZ02 -1.9549128  0.0200160   -97.667  &lt; 2e-16 ***
DESTIN_SZNTSZ01 -3.3048398  0.0448053   -73.760  &lt; 2e-16 ***
DESTIN_SZNTSZ02 -1.6454847  0.0109337  -150.497  &lt; 2e-16 ***
DESTIN_SZNTSZ03 -1.1389723  0.0077396  -147.161  &lt; 2e-16 ***
DESTIN_SZNTSZ05 -2.0264109  0.0250226   -80.983  &lt; 2e-16 ***
DESTIN_SZNTSZ06 -3.3496282  0.0428989   -78.082  &lt; 2e-16 ***
DESTIN_SZNVSZ01 -0.3407614  0.0045493   -74.905  &lt; 2e-16 ***
DESTIN_SZNVSZ02 -0.4987695  0.0053942   -92.465  &lt; 2e-16 ***
DESTIN_SZNVSZ03 -0.4936107  0.0055158   -89.491  &lt; 2e-16 ***
DESTIN_SZNVSZ04 -1.9141281  0.0107557  -177.964  &lt; 2e-16 ***
DESTIN_SZNVSZ05 -1.5378263  0.0089577  -171.677  &lt; 2e-16 ***
DESTIN_SZPGSZ01 -1.7744485  0.0194346   -91.304  &lt; 2e-16 ***
DESTIN_SZPGSZ02 -0.9282918  0.0069006  -134.523  &lt; 2e-16 ***
DESTIN_SZPGSZ03  0.0885025  0.0042145    21.000  &lt; 2e-16 ***
DESTIN_SZPGSZ04 -0.3879375  0.0046862   -82.784  &lt; 2e-16 ***
DESTIN_SZPGSZ05 -0.9649873  0.0074625  -129.311  &lt; 2e-16 ***
DESTIN_SZPLSZ01 -0.6159175  0.0070845   -86.939  &lt; 2e-16 ***
DESTIN_SZPLSZ02 -1.7551386  0.0133081  -131.885  &lt; 2e-16 ***
DESTIN_SZPLSZ03 -0.1378379  0.0098704   -13.965  &lt; 2e-16 ***
DESTIN_SZPLSZ04 -0.1411200  0.0096446   -14.632  &lt; 2e-16 ***
DESTIN_SZPLSZ05 -0.8483196  0.0119048   -71.259  &lt; 2e-16 ***
DESTIN_SZPNSZ01 -0.1579087  0.0057330   -27.544  &lt; 2e-16 ***
DESTIN_SZPNSZ02  1.0243480  0.0076680   133.587  &lt; 2e-16 ***
DESTIN_SZPNSZ03  0.0451598  0.0081444     5.545 2.94e-08 ***
DESTIN_SZPNSZ04  1.8941928  0.0087479   216.530  &lt; 2e-16 ***
DESTIN_SZPNSZ05  1.0341581  0.0130830    79.046  &lt; 2e-16 ***
DESTIN_SZPRSZ01 -1.4038513  0.0086911  -161.527  &lt; 2e-16 ***
DESTIN_SZPRSZ02 -0.4942539  0.0052403   -94.319  &lt; 2e-16 ***
DESTIN_SZPRSZ03  0.4219510  0.0040281   104.751  &lt; 2e-16 ***
DESTIN_SZPRSZ04 -0.4841099  0.0083498   -57.979  &lt; 2e-16 ***
DESTIN_SZPRSZ05 -0.2988481  0.0047512   -62.899  &lt; 2e-16 ***
DESTIN_SZPRSZ06  0.0012333  0.0054530     0.226  0.82108    
DESTIN_SZPRSZ07 -1.1417482  0.0118845   -96.070  &lt; 2e-16 ***
DESTIN_SZPRSZ08 -0.8259249  0.0066757  -123.720  &lt; 2e-16 ***
DESTIN_SZQTSZ01 -1.2134330  0.0089222  -136.002  &lt; 2e-16 ***
DESTIN_SZQTSZ02 -1.2397956  0.0074512  -166.388  &lt; 2e-16 ***
DESTIN_SZQTSZ03 -0.7448659  0.0066511  -111.992  &lt; 2e-16 ***
DESTIN_SZQTSZ04 -0.6243112  0.0066812   -93.443  &lt; 2e-16 ***
DESTIN_SZQTSZ05 -0.6102589  0.0060458  -100.940  &lt; 2e-16 ***
DESTIN_SZQTSZ06 -0.9164592  0.0065095  -140.788  &lt; 2e-16 ***
DESTIN_SZQTSZ07 -1.4600643  0.0109976  -132.762  &lt; 2e-16 ***
DESTIN_SZQTSZ08  0.0004582  0.0050178     0.091  0.92724    
DESTIN_SZQTSZ09 -0.5226213  0.0058901   -88.728  &lt; 2e-16 ***
DESTIN_SZQTSZ10 -0.3867082  0.0055876   -69.208  &lt; 2e-16 ***
DESTIN_SZQTSZ11  0.0260589  0.0055065     4.732 2.22e-06 ***
DESTIN_SZQTSZ12 -0.3387634  0.0072779   -46.547  &lt; 2e-16 ***
DESTIN_SZQTSZ13 -0.0512118  0.0053664    -9.543  &lt; 2e-16 ***
DESTIN_SZQTSZ14 -0.2555346  0.0063792   -40.057  &lt; 2e-16 ***
DESTIN_SZQTSZ15 -0.1820651  0.0077537   -23.481  &lt; 2e-16 ***
DESTIN_SZRCSZ01 -0.4641196  0.0072515   -64.003  &lt; 2e-16 ***
DESTIN_SZRCSZ06 -2.0929548  0.0189106  -110.676  &lt; 2e-16 ***
DESTIN_SZRVSZ01 -1.7885682  0.0163492  -109.398  &lt; 2e-16 ***
DESTIN_SZRVSZ02 -3.1669721  0.0326320   -97.051  &lt; 2e-16 ***
DESTIN_SZRVSZ03 -2.0306835  0.0135749  -149.591  &lt; 2e-16 ***
DESTIN_SZRVSZ04 -1.5113470  0.0155637   -97.107  &lt; 2e-16 ***
DESTIN_SZRVSZ05 -2.3683855  0.0259334   -91.326  &lt; 2e-16 ***
DESTIN_SZSBSZ01 -0.5841063  0.0068588   -85.162  &lt; 2e-16 ***
DESTIN_SZSBSZ02 -1.0777704  0.0078288  -137.667  &lt; 2e-16 ***
DESTIN_SZSBSZ03  0.4734371  0.0045880   103.190  &lt; 2e-16 ***
DESTIN_SZSBSZ04  0.0546094  0.0057517     9.494  &lt; 2e-16 ***
DESTIN_SZSBSZ05 -0.9588198  0.0075242  -127.431  &lt; 2e-16 ***
DESTIN_SZSBSZ06 -1.8528944  0.0234040   -79.170  &lt; 2e-16 ***
DESTIN_SZSBSZ07 -1.8403768  0.0195878   -93.955  &lt; 2e-16 ***
DESTIN_SZSBSZ08  0.9205969  0.0055698   165.285  &lt; 2e-16 ***
DESTIN_SZSBSZ09  0.5166486  0.0051939    99.472  &lt; 2e-16 ***
DESTIN_SZSESZ02 -0.5728211  0.0048270  -118.669  &lt; 2e-16 ***
DESTIN_SZSESZ03  0.2554787  0.0038335    66.645  &lt; 2e-16 ***
DESTIN_SZSESZ04 -0.8982794  0.0056698  -158.432  &lt; 2e-16 ***
DESTIN_SZSESZ05 -0.4661655  0.0048578   -95.962  &lt; 2e-16 ***
DESTIN_SZSESZ06 -0.8392849  0.0059198  -141.777  &lt; 2e-16 ***
DESTIN_SZSESZ07 -3.2182325  0.0227089  -141.717  &lt; 2e-16 ***
DESTIN_SZSGSZ01 -0.2751206  0.0059581   -46.176  &lt; 2e-16 ***
DESTIN_SZSGSZ02 -0.2951806  0.0052515   -56.209  &lt; 2e-16 ***
DESTIN_SZSGSZ03 -0.4469508  0.0048181   -92.766  &lt; 2e-16 ***
DESTIN_SZSGSZ04 -0.2842809  0.0047961   -59.274  &lt; 2e-16 ***
DESTIN_SZSGSZ05 -2.0643753  0.0098252  -210.109  &lt; 2e-16 ***
DESTIN_SZSGSZ06  0.2501247  0.0038873    64.343  &lt; 2e-16 ***
DESTIN_SZSGSZ07 -0.5743750  0.0052184  -110.067  &lt; 2e-16 ***
DESTIN_SZSISZ01 -1.1030669  0.0259113   -42.571  &lt; 2e-16 ***
DESTIN_SZSKSZ01 -0.5462538  0.0071443   -76.460  &lt; 2e-16 ***
DESTIN_SZSKSZ02  0.2965180  0.0056707    52.290  &lt; 2e-16 ***
DESTIN_SZSKSZ03 -0.4521490  0.0062177   -72.719  &lt; 2e-16 ***
DESTIN_SZSKSZ04 -0.6665145  0.0148252   -44.958  &lt; 2e-16 ***
DESTIN_SZSKSZ05 -0.1474142  0.0121958   -12.087  &lt; 2e-16 ***
DESTIN_SZSLSZ01 -0.8855715  0.0084587  -104.693  &lt; 2e-16 ***
DESTIN_SZSLSZ04 -1.1787840  0.0071355  -165.200  &lt; 2e-16 ***
DESTIN_SZSRSZ01 -1.6435064  0.0128822  -127.580  &lt; 2e-16 ***
DESTIN_SZTHSZ01 -3.4388625  0.0367651   -93.536  &lt; 2e-16 ***
DESTIN_SZTHSZ03 -2.5809435  0.0256853  -100.483  &lt; 2e-16 ***
DESTIN_SZTHSZ04 -2.4887189  0.0214441  -116.056  &lt; 2e-16 ***
DESTIN_SZTHSZ06 -1.7965101  0.0152160  -118.067  &lt; 2e-16 ***
DESTIN_SZTMSZ01 -0.3251891  0.0058067   -56.002  &lt; 2e-16 ***
DESTIN_SZTMSZ02  1.1558743  0.0034703   333.080  &lt; 2e-16 ***
DESTIN_SZTMSZ03  0.4525619  0.0039244   115.319  &lt; 2e-16 ***
DESTIN_SZTMSZ04  0.8223271  0.0040060   205.274  &lt; 2e-16 ***
DESTIN_SZTMSZ05  0.3880619  0.0054308    71.456  &lt; 2e-16 ***
DESTIN_SZTNSZ01 -0.9533112  0.0067853  -140.496  &lt; 2e-16 ***
DESTIN_SZTNSZ02 -1.5909451  0.0097396  -163.348  &lt; 2e-16 ***
DESTIN_SZTNSZ03 -1.6470771  0.0116598  -141.261  &lt; 2e-16 ***
DESTIN_SZTNSZ04 -1.0686173  0.0069848  -152.993  &lt; 2e-16 ***
DESTIN_SZTPSZ01 -0.5180183  0.0056886   -91.063  &lt; 2e-16 ***
DESTIN_SZTPSZ02  0.2160781  0.0038283    56.443  &lt; 2e-16 ***
DESTIN_SZTPSZ03 -0.2479956  0.0056651   -43.776  &lt; 2e-16 ***
DESTIN_SZTPSZ04 -1.5015463  0.0072444  -207.271  &lt; 2e-16 ***
DESTIN_SZTPSZ05 -0.9551144  0.0057981  -164.729  &lt; 2e-16 ***
DESTIN_SZTPSZ06 -0.4846634  0.0074621   -64.950  &lt; 2e-16 ***
DESTIN_SZTPSZ07 -1.9753440  0.0118295  -166.984  &lt; 2e-16 ***
DESTIN_SZTPSZ08 -1.3455063  0.0086909  -154.817  &lt; 2e-16 ***
DESTIN_SZTPSZ09 -0.3556620  0.0061296   -58.024  &lt; 2e-16 ***
DESTIN_SZTPSZ10 -1.3213501  0.0085951  -153.733  &lt; 2e-16 ***
DESTIN_SZTPSZ11 -0.3877006  0.0052409   -73.977  &lt; 2e-16 ***
DESTIN_SZTPSZ12 -0.7064020  0.0062472  -113.075  &lt; 2e-16 ***
DESTIN_SZTSSZ01 -0.8827157  0.0218327   -40.431  &lt; 2e-16 ***
DESTIN_SZTSSZ02 -0.6067055  0.0115514   -52.522  &lt; 2e-16 ***
DESTIN_SZTSSZ03  0.4380259  0.0086774    50.479  &lt; 2e-16 ***
DESTIN_SZTSSZ04  0.4902124  0.0089922    54.515  &lt; 2e-16 ***
DESTIN_SZTSSZ05  1.4336278  0.0093410   153.477  &lt; 2e-16 ***
DESTIN_SZTSSZ06  0.9223573  0.0209024    44.127  &lt; 2e-16 ***
DESTIN_SZWCSZ01  1.1559309  0.0051787   223.208  &lt; 2e-16 ***
DESTIN_SZWCSZ02 -1.2664455  0.0126131  -100.407  &lt; 2e-16 ***
DESTIN_SZWCSZ03 -2.7360882  0.0325753   -83.993  &lt; 2e-16 ***
DESTIN_SZWDSZ01  0.8193492  0.0037301   219.657  &lt; 2e-16 ***
DESTIN_SZWDSZ02 -0.7852474  0.0058655  -133.875  &lt; 2e-16 ***
DESTIN_SZWDSZ03  0.5742422  0.0041884   137.104  &lt; 2e-16 ***
DESTIN_SZWDSZ04 -0.8391525  0.0065075  -128.951  &lt; 2e-16 ***
DESTIN_SZWDSZ05 -0.3510692  0.0057253   -61.319  &lt; 2e-16 ***
DESTIN_SZWDSZ06  0.1358804  0.0043968    30.905  &lt; 2e-16 ***
DESTIN_SZWDSZ07 -0.2207379  0.0066369   -33.259  &lt; 2e-16 ***
DESTIN_SZWDSZ08 -0.0264655  0.0065065    -4.068 4.75e-05 ***
DESTIN_SZWDSZ09 -0.2065828  0.0050524   -40.888  &lt; 2e-16 ***
DESTIN_SZYSSZ01  0.7467996  0.0040979   182.238  &lt; 2e-16 ***
DESTIN_SZYSSZ02 -0.3002718  0.0053434   -56.195  &lt; 2e-16 ***
DESTIN_SZYSSZ03 -1.1087686  0.0057219  -193.778  &lt; 2e-16 ***
DESTIN_SZYSSZ04 -0.3748076  0.0051481   -72.805  &lt; 2e-16 ***
DESTIN_SZYSSZ05 -1.7909654  0.0102064  -175.475  &lt; 2e-16 ***
DESTIN_SZYSSZ06 -1.8519179  0.0099601  -185.933  &lt; 2e-16 ***
DESTIN_SZYSSZ07 -0.9246626  0.0118101   -78.294  &lt; 2e-16 ***
DESTIN_SZYSSZ08  0.4403129  0.0041268   106.697  &lt; 2e-16 ***
DESTIN_SZYSSZ09  0.0267012  0.0041393     6.451 1.11e-10 ***
log(dist)       -0.6721961  0.0001353 -4969.566  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 60796037  on 14733  degrees of freedom
Residual deviance: 20988409  on 14175  degrees of freedom
AIC: 21081154

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p>We can examine how the constraints hold for destinations this time.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(dbcSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, dbcSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5739638</code></pre>
</div>
</div>
<p>Notice that there is a relatively greater improvement in the R^2 value.</p>
</section>
<section id="model-comparison" class="level4">
<h4 class="anchored" data-anchor-id="model-comparison">Model comparison</h4>
<p>Another useful model performance measure for continuous dependent variable is Root Mean Squared Error. In this sub-section, you will learn how to use compare_performance() of performance package</p>
<p>First of all, let us create a list called model_list by using the code chun below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>model_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">unconstrained=</span>uncSIM,</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">originConstrained=</span>orcSIM,</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">destinationConstrained=</span>decSIM,</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">doublyConstrained=</span>dbcSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will compute the RMSE of all the models in model_list file by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(model_list,</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="st">"RMSE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                   | Model |     RMSE
-----------------------------------------
unconstrained          |   glm | 4288.012
originConstrained      |   glm | 3659.954
destinationConstrained |   glm | 3389.556
doublyConstrained      |   glm | 3252.297</code></pre>
</div>
</div>
<p>The print above reveals that doubly constrained SIM is the best model among all the four SIMs because it has the smallest RMSE value of 1487.111.</p>
</section>
<section id="visualising-fitted" class="level4">
<h4 class="anchored" data-anchor-id="visualising-fitted">Visualising fitted</h4>
<p>In this section, you will learn how to visualise the observed values and the fitted values.</p>
<p>Firstly we will extract the fitted values from each model by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(uncSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will join the values to SIM_data data frame.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">uncTRIPS =</span> uncSIM.fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Repeat the same step by for Origin Constrained SIM (i.e.&nbsp;orcSIM)</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(orcSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">orcTRIPS =</span> orcSIM.fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Repeat the same step by for Destination Constrained SIM (i.e.&nbsp;decSIM)</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(decSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">decTRIPS =</span> decSIM.fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Repeat the same step by for Doubly Constrained SIM (i.e.&nbsp;dbcSIM)</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dbcSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dbcTRIPS =</span> dbcSIM.fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>unc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> uncTRIPS,</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>orc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> orcTRIPS,</span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a>dec_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> decTRIPS,</span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-19"><a href="#cb168-19" aria-hidden="true" tabindex="-1"></a>dbc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb168-20"><a href="#cb168-20" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> dbcTRIPS,</span>
<span id="cb168-21"><a href="#cb168-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb168-22"><a href="#cb168-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb168-23"><a href="#cb168-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb168-24"><a href="#cb168-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-25"><a href="#cb168-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(unc_p, orc_p, dec_p, dbc_p,</span>
<span id="cb168-26"><a href="#cb168-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb168-27"><a href="#cb168-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-115-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="calibrating-spatial-interaction-models-schoolbusiness" class="level2">
<h2 class="anchored" data-anchor-id="calibrating-spatial-interaction-models-schoolbusiness">18 Calibrating Spatial Interaction Models (School/Business)</h2>
<section id="origin--production--constrained-model" class="level3">
<h3 class="anchored" data-anchor-id="origin--production--constrained-model">Origin- (Production-) constrained Model</h3>
<p>Figure below shows the general formula of the origin-constrained model.</p>
<p><img src="Formula.jpg" class="img-fluid" width="269"></p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>orcSIM_Poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>                ORIGIN_SZ <span class="sc">+</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(SCHOOL_COUNT) <span class="sc">+</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(BUSINESS_COUNT) <span class="sc">+</span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> inter_zonal_flow,</span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(orcSIM_Poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ ORIGIN_SZ + log(SCHOOL_COUNT) + log(BUSINESS_COUNT) + 
    log(dist) - 1, family = poisson(link = "log"), data = inter_zonal_flow, 
    na.action = na.exclude)

Coefficients:
                      Estimate Std. Error  z value Pr(&gt;|z|)    
ORIGIN_SZAMSZ01     13.8759118  0.0074904  1852.49   &lt;2e-16 ***
ORIGIN_SZAMSZ02     14.5354276  0.0072736  1998.37   &lt;2e-16 ***
ORIGIN_SZAMSZ03     14.0838225  0.0074971  1878.56   &lt;2e-16 ***
ORIGIN_SZAMSZ04     13.7229696  0.0077073  1780.52   &lt;2e-16 ***
ORIGIN_SZAMSZ05     13.6493707  0.0081192  1681.12   &lt;2e-16 ***
ORIGIN_SZAMSZ06     13.9780522  0.0075780  1844.55   &lt;2e-16 ***
ORIGIN_SZAMSZ07     12.4704536  0.0113924  1094.62   &lt;2e-16 ***
ORIGIN_SZAMSZ08     12.7308641  0.0110300  1154.20   &lt;2e-16 ***
ORIGIN_SZAMSZ09     13.9784749  0.0078864  1772.47   &lt;2e-16 ***
ORIGIN_SZAMSZ10     14.2295781  0.0074293  1915.34   &lt;2e-16 ***
ORIGIN_SZAMSZ11     12.2706786  0.0142673   860.06   &lt;2e-16 ***
ORIGIN_SZAMSZ12     12.2131708  0.0124893   977.89   &lt;2e-16 ***
ORIGIN_SZBDSZ01     14.7066154  0.0076455  1923.56   &lt;2e-16 ***
ORIGIN_SZBDSZ02     14.1682851  0.0080947  1750.32   &lt;2e-16 ***
ORIGIN_SZBDSZ03     14.4834171  0.0077681  1864.48   &lt;2e-16 ***
ORIGIN_SZBDSZ04     15.3032611  0.0074279  2060.24   &lt;2e-16 ***
ORIGIN_SZBDSZ05     14.3360714  0.0078791  1819.52   &lt;2e-16 ***
ORIGIN_SZBDSZ06     14.5605029  0.0078765  1848.59   &lt;2e-16 ***
ORIGIN_SZBDSZ07     12.8980821  0.0115668  1115.10   &lt;2e-16 ***
ORIGIN_SZBDSZ08     12.9198079  0.0110547  1168.72   &lt;2e-16 ***
ORIGIN_SZBKSZ01     13.1770643  0.0089107  1478.79   &lt;2e-16 ***
ORIGIN_SZBKSZ02     14.0603000  0.0077142  1822.65   &lt;2e-16 ***
ORIGIN_SZBKSZ03     14.1950330  0.0076217  1862.46   &lt;2e-16 ***
ORIGIN_SZBKSZ04     13.4160976  0.0084440  1588.83   &lt;2e-16 ***
ORIGIN_SZBKSZ05     13.2525351  0.0088732  1493.55   &lt;2e-16 ***
ORIGIN_SZBKSZ06     13.7102179  0.0080589  1701.25   &lt;2e-16 ***
ORIGIN_SZBKSZ07     14.3744672  0.0072546  1981.43   &lt;2e-16 ***
ORIGIN_SZBKSZ08     13.8446725  0.0077676  1782.37   &lt;2e-16 ***
ORIGIN_SZBKSZ09     13.6463047  0.0081884  1666.54   &lt;2e-16 ***
ORIGIN_SZBLSZ01     11.8642160  0.0161192   736.03   &lt;2e-16 ***
ORIGIN_SZBLSZ02     11.6204446  0.0201628   576.33   &lt;2e-16 ***
ORIGIN_SZBLSZ03     10.5864123  0.0465464   227.44   &lt;2e-16 ***
ORIGIN_SZBLSZ04     11.9015453  0.0241016   493.81   &lt;2e-16 ***
ORIGIN_SZBMSZ01     13.9649530  0.0079517  1756.23   &lt;2e-16 ***
ORIGIN_SZBMSZ02     12.8259985  0.0087252  1469.99   &lt;2e-16 ***
ORIGIN_SZBMSZ03     13.6030784  0.0077997  1744.05   &lt;2e-16 ***
ORIGIN_SZBMSZ04     13.8755839  0.0072830  1905.21   &lt;2e-16 ***
ORIGIN_SZBMSZ05     11.2792851  0.0177284   636.23   &lt;2e-16 ***
ORIGIN_SZBMSZ06     11.2772526  0.0190059   593.36   &lt;2e-16 ***
ORIGIN_SZBMSZ07     13.3197067  0.0080484  1654.95   &lt;2e-16 ***
ORIGIN_SZBMSZ08     13.4728130  0.0078099  1725.10   &lt;2e-16 ***
ORIGIN_SZBMSZ09     13.0153314  0.0102252  1272.87   &lt;2e-16 ***
ORIGIN_SZBMSZ10     12.6814613  0.0104409  1214.60   &lt;2e-16 ***
ORIGIN_SZBMSZ11     13.0926840  0.0084369  1551.83   &lt;2e-16 ***
ORIGIN_SZBMSZ12     12.9343914  0.0108637  1190.60   &lt;2e-16 ***
ORIGIN_SZBMSZ13     13.7280366  0.0081645  1681.44   &lt;2e-16 ***
ORIGIN_SZBMSZ14     13.4679365  0.0083588  1611.23   &lt;2e-16 ***
ORIGIN_SZBMSZ15     13.6318858  0.0080705  1689.09   &lt;2e-16 ***
ORIGIN_SZBMSZ16     12.6256956  0.0108220  1166.67   &lt;2e-16 ***
ORIGIN_SZBMSZ17     11.9763368  0.0169510   706.53   &lt;2e-16 ***
ORIGIN_SZBPSZ01     14.1231882  0.0078858  1790.95   &lt;2e-16 ***
ORIGIN_SZBPSZ02     13.7923719  0.0083882  1644.25   &lt;2e-16 ***
ORIGIN_SZBPSZ03     13.8201589  0.0083122  1662.63   &lt;2e-16 ***
ORIGIN_SZBPSZ04     14.1773651  0.0077415  1831.34   &lt;2e-16 ***
ORIGIN_SZBPSZ05     14.2670369  0.0074071  1926.13   &lt;2e-16 ***
ORIGIN_SZBPSZ06     12.5294262  0.0111669  1122.01   &lt;2e-16 ***
ORIGIN_SZBPSZ07     12.8142013  0.0109019  1175.41   &lt;2e-16 ***
ORIGIN_SZBSSZ01     13.6498558  0.0083706  1630.69   &lt;2e-16 ***
ORIGIN_SZBSSZ02     14.0757801  0.0076232  1846.45   &lt;2e-16 ***
ORIGIN_SZBSSZ03     13.4615900  0.0079625  1690.63   &lt;2e-16 ***
ORIGIN_SZBTSZ01     13.5745300  0.0085869  1580.84   &lt;2e-16 ***
ORIGIN_SZBTSZ02     12.7842484  0.0103436  1235.96   &lt;2e-16 ***
ORIGIN_SZBTSZ03     13.1295319  0.0092848  1414.09   &lt;2e-16 ***
ORIGIN_SZBTSZ04     12.6036459  0.0119474  1054.93   &lt;2e-16 ***
ORIGIN_SZBTSZ05     12.2909846  0.0136419   900.97   &lt;2e-16 ***
ORIGIN_SZBTSZ06     12.4327849  0.0112432  1105.80   &lt;2e-16 ***
ORIGIN_SZBTSZ07     11.3106527  0.0154099   733.99   &lt;2e-16 ***
ORIGIN_SZBTSZ08     12.6497639  0.0124482  1016.20   &lt;2e-16 ***
ORIGIN_SZCBSZ01     11.1296947  0.0552922   201.29   &lt;2e-16 ***
ORIGIN_SZCCSZ01     11.8784765  0.0155550   763.64   &lt;2e-16 ***
ORIGIN_SZCHSZ01     13.3179490  0.0136200   977.82   &lt;2e-16 ***
ORIGIN_SZCHSZ02     13.4392461  0.0100958  1331.18   &lt;2e-16 ***
ORIGIN_SZCHSZ03     14.3099433  0.0093474  1530.90   &lt;2e-16 ***
ORIGIN_SZCKSZ01     13.9068636  0.0077099  1803.77   &lt;2e-16 ***
ORIGIN_SZCKSZ02     14.2444921  0.0078028  1825.57   &lt;2e-16 ***
ORIGIN_SZCKSZ03     14.5513715  0.0072553  2005.61   &lt;2e-16 ***
ORIGIN_SZCKSZ04     15.0591349  0.0073966  2035.96   &lt;2e-16 ***
ORIGIN_SZCKSZ05     14.7919062  0.0076784  1926.42   &lt;2e-16 ***
ORIGIN_SZCKSZ06     14.0643863  0.0093266  1507.99   &lt;2e-16 ***
ORIGIN_SZCLSZ01     13.0481337  0.0098123  1329.77   &lt;2e-16 ***
ORIGIN_SZCLSZ02     12.2911464  0.0148442   828.01   &lt;2e-16 ***
ORIGIN_SZCLSZ03     12.9137055  0.0099981  1291.61   &lt;2e-16 ***
ORIGIN_SZCLSZ04     14.5597116  0.0073186  1989.41   &lt;2e-16 ***
ORIGIN_SZCLSZ05     12.2057626  0.0158110   771.98   &lt;2e-16 ***
ORIGIN_SZCLSZ06     14.7390953  0.0070864  2079.90   &lt;2e-16 ***
ORIGIN_SZCLSZ07     13.5785907  0.0080149  1694.16   &lt;2e-16 ***
ORIGIN_SZCLSZ08     14.0988721  0.0081691  1725.88   &lt;2e-16 ***
ORIGIN_SZCLSZ09     12.4734117  0.0175924   709.02   &lt;2e-16 ***
ORIGIN_SZDTSZ02      9.8255678  0.0836124   117.51   &lt;2e-16 ***
ORIGIN_SZDTSZ03     10.5986032  0.0739930   143.24   &lt;2e-16 ***
ORIGIN_SZDTSZ13     10.8148639  0.0318061   340.02   &lt;2e-16 ***
ORIGIN_SZGLSZ01     12.2894974  0.0112632  1091.12   &lt;2e-16 ***
ORIGIN_SZGLSZ02     13.9527920  0.0077582  1798.46   &lt;2e-16 ***
ORIGIN_SZGLSZ03     13.6681449  0.0081471  1677.67   &lt;2e-16 ***
ORIGIN_SZGLSZ04     14.5749709  0.0073945  1971.07   &lt;2e-16 ***
ORIGIN_SZGLSZ05     14.4092563  0.0075705  1903.34   &lt;2e-16 ***
ORIGIN_SZHGSZ01     14.0602822  0.0073669  1908.59   &lt;2e-16 ***
ORIGIN_SZHGSZ02     14.2377896  0.0073401  1939.71   &lt;2e-16 ***
ORIGIN_SZHGSZ03     13.9271509  0.0077355  1800.42   &lt;2e-16 ***
ORIGIN_SZHGSZ04     14.7009594  0.0071185  2065.17   &lt;2e-16 ***
ORIGIN_SZHGSZ05     14.9250179  0.0071292  2093.52   &lt;2e-16 ***
ORIGIN_SZHGSZ06     13.5104790  0.0081399  1659.79   &lt;2e-16 ***
ORIGIN_SZHGSZ07     14.1617040  0.0075549  1874.50   &lt;2e-16 ***
ORIGIN_SZHGSZ08     13.7738644  0.0080571  1709.54   &lt;2e-16 ***
ORIGIN_SZHGSZ09     12.7333236  0.0088349  1441.24   &lt;2e-16 ***
ORIGIN_SZHGSZ10     10.9032387  0.0425085   256.50   &lt;2e-16 ***
ORIGIN_SZJESZ01     14.1278611  0.0075295  1876.35   &lt;2e-16 ***
ORIGIN_SZJESZ02     14.0221979  0.0074926  1871.48   &lt;2e-16 ***
ORIGIN_SZJESZ03     13.9621153  0.0076813  1817.67   &lt;2e-16 ***
ORIGIN_SZJESZ04     12.3716383  0.0115949  1066.99   &lt;2e-16 ***
ORIGIN_SZJESZ05     11.7445761  0.0151012   777.72   &lt;2e-16 ***
ORIGIN_SZJESZ06     14.1880341  0.0072871  1946.99   &lt;2e-16 ***
ORIGIN_SZJESZ07     12.0920589  0.0131180   921.79   &lt;2e-16 ***
ORIGIN_SZJESZ08     12.5027033  0.0132557   943.19   &lt;2e-16 ***
ORIGIN_SZJESZ09     14.3970286  0.0077815  1850.16   &lt;2e-16 ***
ORIGIN_SZJESZ10     12.3523184  0.0201014   614.50   &lt;2e-16 ***
ORIGIN_SZJESZ11     12.0403673  0.0206859   582.06   &lt;2e-16 ***
ORIGIN_SZJWSZ01     14.0292221  0.0088729  1581.13   &lt;2e-16 ***
ORIGIN_SZJWSZ02     14.6981454  0.0073252  2006.51   &lt;2e-16 ***
ORIGIN_SZJWSZ03     14.9512978  0.0072806  2053.58   &lt;2e-16 ***
ORIGIN_SZJWSZ04     14.3951803  0.0075675  1902.23   &lt;2e-16 ***
ORIGIN_SZJWSZ05     12.0668568  0.0142010   849.72   &lt;2e-16 ***
ORIGIN_SZJWSZ06     12.6274118  0.0123567  1021.91   &lt;2e-16 ***
ORIGIN_SZJWSZ07     11.3858796  0.0283941   401.00   &lt;2e-16 ***
ORIGIN_SZJWSZ08     15.7176882  0.0070898  2216.94   &lt;2e-16 ***
ORIGIN_SZJWSZ09     15.6130361  0.0069086  2259.96   &lt;2e-16 ***
ORIGIN_SZKLSZ01     14.0462416  0.0076197  1843.40   &lt;2e-16 ***
ORIGIN_SZKLSZ02     13.2683918  0.0085218  1556.99   &lt;2e-16 ***
ORIGIN_SZKLSZ03     13.5134591  0.0081565  1656.78   &lt;2e-16 ***
ORIGIN_SZKLSZ04     11.8480554  0.0133182   889.61   &lt;2e-16 ***
ORIGIN_SZKLSZ05     12.5840606  0.0123478  1019.14   &lt;2e-16 ***
ORIGIN_SZKLSZ06      8.1863857  0.1858029    44.06   &lt;2e-16 ***
ORIGIN_SZKLSZ07     12.9378899  0.0102148  1266.59   &lt;2e-16 ***
ORIGIN_SZKLSZ08     12.1820931  0.0117049  1040.77   &lt;2e-16 ***
ORIGIN_SZLKSZ01     10.9886222  0.0403171   272.56   &lt;2e-16 ***
ORIGIN_SZMDSZ01     11.5856289  0.0293768   394.38   &lt;2e-16 ***
ORIGIN_SZMDSZ02     12.5432771  0.0121537  1032.06   &lt;2e-16 ***
ORIGIN_SZMDSZ03     11.7009204  0.0179832   650.66   &lt;2e-16 ***
ORIGIN_SZMPSZ01     12.8771121  0.0104341  1234.13   &lt;2e-16 ***
ORIGIN_SZMPSZ02     13.2034788  0.0092024  1434.79   &lt;2e-16 ***
ORIGIN_SZMPSZ03     13.9338231  0.0081802  1703.35   &lt;2e-16 ***
ORIGIN_SZMUSZ02     10.6890643  0.1038774   102.90   &lt;2e-16 ***
ORIGIN_SZNTSZ01     11.0686833  0.0357176   309.89   &lt;2e-16 ***
ORIGIN_SZNTSZ02     10.7234122  0.0240260   446.32   &lt;2e-16 ***
ORIGIN_SZNTSZ03     13.1941817  0.0094268  1399.64   &lt;2e-16 ***
ORIGIN_SZNTSZ05     10.7471592  0.0498458   215.61   &lt;2e-16 ***
ORIGIN_SZNTSZ06     10.0262464  0.0559457   179.21   &lt;2e-16 ***
ORIGIN_SZNVSZ01     14.1912013  0.0073568  1928.98   &lt;2e-16 ***
ORIGIN_SZNVSZ02     13.2287052  0.0087708  1508.27   &lt;2e-16 ***
ORIGIN_SZNVSZ03     12.7219830  0.0100730  1262.98   &lt;2e-16 ***
ORIGIN_SZNVSZ04     12.5352635  0.0109965  1139.93   &lt;2e-16 ***
ORIGIN_SZNVSZ05     11.2131520  0.0179301   625.38   &lt;2e-16 ***
ORIGIN_SZPGSZ01     13.2234307  0.0136490   968.82   &lt;2e-16 ***
ORIGIN_SZPGSZ02     13.1649561  0.0095162  1383.43   &lt;2e-16 ***
ORIGIN_SZPGSZ03     14.2183875  0.0076265  1864.33   &lt;2e-16 ***
ORIGIN_SZPGSZ04     14.7489951  0.0073791  1998.74   &lt;2e-16 ***
ORIGIN_SZPGSZ05     13.9672450  0.0083807  1666.59   &lt;2e-16 ***
ORIGIN_SZPLSZ01     12.8822512  0.0134872   955.15   &lt;2e-16 ***
ORIGIN_SZPLSZ02     12.4327419  0.0162099   766.99   &lt;2e-16 ***
ORIGIN_SZPLSZ03     12.1750378  0.0376454   323.41   &lt;2e-16 ***
ORIGIN_SZPLSZ04     11.1929602  0.0375233   298.29   &lt;2e-16 ***
ORIGIN_SZPLSZ05     11.7567239  0.0233729   503.01   &lt;2e-16 ***
ORIGIN_SZPNSZ01     15.0336896  0.0076546  1964.02   &lt;2e-16 ***
ORIGIN_SZPNSZ02     13.6947261  0.0129910  1054.17   &lt;2e-16 ***
ORIGIN_SZPNSZ03     12.0339221  0.0203250   592.08   &lt;2e-16 ***
ORIGIN_SZPNSZ04     11.0915642  0.0341040   325.23   &lt;2e-16 ***
ORIGIN_SZPNSZ05     12.1452068  0.0283283   428.73   &lt;2e-16 ***
ORIGIN_SZPRSZ01     13.2162023  0.0134387   983.45   &lt;2e-16 ***
ORIGIN_SZPRSZ02     14.8100926  0.0076247  1942.38   &lt;2e-16 ***
ORIGIN_SZPRSZ03     14.4810894  0.0076049  1904.19   &lt;2e-16 ***
ORIGIN_SZPRSZ04     13.3664448  0.0097079  1376.86   &lt;2e-16 ***
ORIGIN_SZPRSZ05     15.0309314  0.0075694  1985.75   &lt;2e-16 ***
ORIGIN_SZPRSZ06     12.7355312  0.0132362   962.17   &lt;2e-16 ***
ORIGIN_SZPRSZ07     11.6785110  0.0172955   675.23   &lt;2e-16 ***
ORIGIN_SZPRSZ08     13.6950076  0.0088524  1547.05   &lt;2e-16 ***
ORIGIN_SZQTSZ01     13.6931372  0.0088413  1548.78   &lt;2e-16 ***
ORIGIN_SZQTSZ02     13.1785605  0.0084103  1566.95   &lt;2e-16 ***
ORIGIN_SZQTSZ03     13.7493394  0.0080557  1706.79   &lt;2e-16 ***
ORIGIN_SZQTSZ04     12.8225798  0.0092765  1382.27   &lt;2e-16 ***
ORIGIN_SZQTSZ05     13.2633493  0.0085302  1554.87   &lt;2e-16 ***
ORIGIN_SZQTSZ06     13.3393214  0.0087163  1530.39   &lt;2e-16 ***
ORIGIN_SZQTSZ07     12.5421710  0.0111765  1122.19   &lt;2e-16 ***
ORIGIN_SZQTSZ08     13.4116163  0.0085711  1564.74   &lt;2e-16 ***
ORIGIN_SZQTSZ09     13.1821156  0.0091038  1447.97   &lt;2e-16 ***
ORIGIN_SZQTSZ10     13.4732192  0.0087489  1539.99   &lt;2e-16 ***
ORIGIN_SZQTSZ11     11.4995885  0.0155829   737.96   &lt;2e-16 ***
ORIGIN_SZQTSZ12     11.0991775  0.0196240   565.59   &lt;2e-16 ***
ORIGIN_SZQTSZ13     13.2663587  0.0099152  1337.98   &lt;2e-16 ***
ORIGIN_SZQTSZ14     12.1596672  0.0135404   898.03   &lt;2e-16 ***
ORIGIN_SZQTSZ15     13.0066626  0.0136737   951.22   &lt;2e-16 ***
ORIGIN_SZRCSZ01     12.5612951  0.0136851   917.88   &lt;2e-16 ***
ORIGIN_SZRCSZ06     13.1916014  0.0098815  1334.97   &lt;2e-16 ***
ORIGIN_SZRVSZ01     11.2914261  0.0328017   344.23   &lt;2e-16 ***
ORIGIN_SZRVSZ02     10.8991672  0.0281762   386.82   &lt;2e-16 ***
ORIGIN_SZRVSZ03     11.1105257  0.0250954   442.73   &lt;2e-16 ***
ORIGIN_SZRVSZ04     10.4371853  0.0558999   186.71   &lt;2e-16 ***
ORIGIN_SZRVSZ05     11.7591231  0.0172220   682.79   &lt;2e-16 ***
ORIGIN_SZSBSZ01     13.9014869  0.0086710  1603.21   &lt;2e-16 ***
ORIGIN_SZSBSZ02     13.0060962  0.0100962  1288.22   &lt;2e-16 ***
ORIGIN_SZSBSZ03     14.5191916  0.0075244  1929.62   &lt;2e-16 ***
ORIGIN_SZSBSZ04     14.4790167  0.0078993  1832.95   &lt;2e-16 ***
ORIGIN_SZSBSZ05     13.4913889  0.0089162  1513.13   &lt;2e-16 ***
ORIGIN_SZSBSZ06     12.5600456  0.0181680   691.33   &lt;2e-16 ***
ORIGIN_SZSBSZ07     13.2314203  0.0138087   958.19   &lt;2e-16 ***
ORIGIN_SZSBSZ08     12.5354319  0.0153805   815.02   &lt;2e-16 ***
ORIGIN_SZSBSZ09     12.8844915  0.0107355  1200.17   &lt;2e-16 ***
ORIGIN_SZSESZ02     14.7111995  0.0072887  2018.37   &lt;2e-16 ***
ORIGIN_SZSESZ03     14.8278570  0.0071028  2087.62   &lt;2e-16 ***
ORIGIN_SZSESZ04     14.3515915  0.0076004  1888.28   &lt;2e-16 ***
ORIGIN_SZSESZ05     13.2938257  0.0084088  1580.93   &lt;2e-16 ***
ORIGIN_SZSESZ06     14.3166576  0.0077130  1856.17   &lt;2e-16 ***
ORIGIN_SZSESZ07     11.3237634  0.0205108   552.09   &lt;2e-16 ***
ORIGIN_SZSGSZ01     12.7843048  0.0105480  1212.01   &lt;2e-16 ***
ORIGIN_SZSGSZ02     12.4509314  0.0118236  1053.06   &lt;2e-16 ***
ORIGIN_SZSGSZ03     13.8640226  0.0078157  1773.87   &lt;2e-16 ***
ORIGIN_SZSGSZ04     14.0112155  0.0076615  1828.78   &lt;2e-16 ***
ORIGIN_SZSGSZ05     12.0051566  0.0122573   979.43   &lt;2e-16 ***
ORIGIN_SZSGSZ06     14.1776944  0.0074229  1909.99   &lt;2e-16 ***
ORIGIN_SZSGSZ07     13.1194860  0.0085804  1529.01   &lt;2e-16 ***
ORIGIN_SZSKSZ01     13.4532640  0.0106970  1257.67   &lt;2e-16 ***
ORIGIN_SZSKSZ02     14.3351719  0.0085439  1677.83   &lt;2e-16 ***
ORIGIN_SZSKSZ03     13.0178977  0.0102998  1263.90   &lt;2e-16 ***
ORIGIN_SZSKSZ04     11.6242498  0.0283309   410.30   &lt;2e-16 ***
ORIGIN_SZSKSZ05     12.6616623  0.0168978   749.31   &lt;2e-16 ***
ORIGIN_SZSLSZ01     10.4842025  0.0335478   312.52   &lt;2e-16 ***
ORIGIN_SZSLSZ04     13.0502436  0.0099302  1314.20   &lt;2e-16 ***
ORIGIN_SZSRSZ01     11.5920190  0.0170742   678.92   &lt;2e-16 ***
ORIGIN_SZTHSZ01     11.0980533  0.0493219   225.01   &lt;2e-16 ***
ORIGIN_SZTHSZ03     12.1698830  0.0231356   526.02   &lt;2e-16 ***
ORIGIN_SZTHSZ04     11.1141308  0.0292428   380.06   &lt;2e-16 ***
ORIGIN_SZTHSZ06     11.7287284  0.0192332   609.82   &lt;2e-16 ***
ORIGIN_SZTMSZ01     14.0109293  0.0084835  1651.54   &lt;2e-16 ***
ORIGIN_SZTMSZ02     15.6329503  0.0073463  2128.01   &lt;2e-16 ***
ORIGIN_SZTMSZ03     15.0426577  0.0074532  2018.28   &lt;2e-16 ***
ORIGIN_SZTMSZ04     14.3182228  0.0081152  1764.38   &lt;2e-16 ***
ORIGIN_SZTMSZ05     12.6587734  0.0131138   965.30   &lt;2e-16 ***
ORIGIN_SZTNSZ01     11.7954382  0.0141073   836.12   &lt;2e-16 ***
ORIGIN_SZTNSZ02     12.1633043  0.0113564  1071.06   &lt;2e-16 ***
ORIGIN_SZTNSZ03     11.6668144  0.0146847   794.49   &lt;2e-16 ***
ORIGIN_SZTNSZ04     13.2044892  0.0094755  1393.54   &lt;2e-16 ***
ORIGIN_SZTPSZ01     13.0850080  0.0088530  1478.03   &lt;2e-16 ***
ORIGIN_SZTPSZ02     14.2935494  0.0071768  1991.63   &lt;2e-16 ***
ORIGIN_SZTPSZ03     13.2224902  0.0083306  1587.22   &lt;2e-16 ***
ORIGIN_SZTPSZ04     13.5213630  0.0078013  1733.23   &lt;2e-16 ***
ORIGIN_SZTPSZ05     13.6800847  0.0081451  1679.56   &lt;2e-16 ***
ORIGIN_SZTPSZ06     14.1796965  0.0076888  1844.20   &lt;2e-16 ***
ORIGIN_SZTPSZ07     13.7355471  0.0082800  1658.88   &lt;2e-16 ***
ORIGIN_SZTPSZ08     12.7792329  0.0112145  1139.53   &lt;2e-16 ***
ORIGIN_SZTPSZ09     13.1226779  0.0088603  1481.07   &lt;2e-16 ***
ORIGIN_SZTPSZ10     13.0107245  0.0095582  1361.21   &lt;2e-16 ***
ORIGIN_SZTPSZ11     13.8315866  0.0079639  1736.78   &lt;2e-16 ***
ORIGIN_SZTPSZ12     13.2462660  0.0087967  1505.83   &lt;2e-16 ***
ORIGIN_SZTSSZ01     11.1228890  0.0483741   229.94   &lt;2e-16 ***
ORIGIN_SZTSSZ02     14.2819074  0.0104726  1363.74   &lt;2e-16 ***
ORIGIN_SZTSSZ03     13.9080761  0.0105549  1317.69   &lt;2e-16 ***
ORIGIN_SZTSSZ04     13.8503947  0.0111350  1243.86   &lt;2e-16 ***
ORIGIN_SZTSSZ05     13.0646079  0.0165824   787.86   &lt;2e-16 ***
ORIGIN_SZTSSZ06     13.8947882  0.0193165   719.32   &lt;2e-16 ***
ORIGIN_SZWCSZ01     13.3924270  0.0112685  1188.48   &lt;2e-16 ***
ORIGIN_SZWCSZ02     11.4063739  0.0334617   340.88   &lt;2e-16 ***
ORIGIN_SZWCSZ03      8.7432151  0.1242106    70.39   &lt;2e-16 ***
ORIGIN_SZWDSZ01     15.1583947  0.0070174  2160.12   &lt;2e-16 ***
ORIGIN_SZWDSZ02     14.5723102  0.0075132  1939.56   &lt;2e-16 ***
ORIGIN_SZWDSZ03     15.0145245  0.0074738  2008.95   &lt;2e-16 ***
ORIGIN_SZWDSZ04     14.7812052  0.0078845  1874.71   &lt;2e-16 ***
ORIGIN_SZWDSZ05     14.1614082  0.0080856  1751.44   &lt;2e-16 ***
ORIGIN_SZWDSZ06     14.4310869  0.0078278  1843.58   &lt;2e-16 ***
ORIGIN_SZWDSZ07     12.8237244  0.0103270  1241.77   &lt;2e-16 ***
ORIGIN_SZWDSZ08     13.0389815  0.0101115  1289.52   &lt;2e-16 ***
ORIGIN_SZWDSZ09     14.8701012  0.0074871  1986.10   &lt;2e-16 ***
ORIGIN_SZYSSZ01     13.4626134  0.0082824  1625.46   &lt;2e-16 ***
ORIGIN_SZYSSZ02     14.4539607  0.0077879  1855.94   &lt;2e-16 ***
ORIGIN_SZYSSZ03     15.3457280  0.0073992  2073.96   &lt;2e-16 ***
ORIGIN_SZYSSZ04     14.6684743  0.0075019  1955.29   &lt;2e-16 ***
ORIGIN_SZYSSZ05     13.6731906  0.0086081  1588.41   &lt;2e-16 ***
ORIGIN_SZYSSZ06     12.6980598  0.0132979   954.89   &lt;2e-16 ***
ORIGIN_SZYSSZ07     12.0882526  0.0155832   775.72   &lt;2e-16 ***
ORIGIN_SZYSSZ08     13.5978353  0.0087067  1561.76   &lt;2e-16 ***
ORIGIN_SZYSSZ09     14.7337065  0.0073217  2012.33   &lt;2e-16 ***
log(SCHOOL_COUNT)    0.3384458  0.0004554   743.17   &lt;2e-16 ***
log(BUSINESS_COUNT) -1.4522449  0.0014421 -1007.05   &lt;2e-16 ***
log(dist)           -0.6219840  0.0010834  -574.12   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 189463537  on 14471  degrees of freedom
Residual deviance:  15434816  on 14189  degrees of freedom
AIC: 15524519

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p><img src="orcSIM_Poisson.png" class="img-fluid" width="315"></p>
<ul>
<li>the ⍺1 and ⍺2 of SCHOOL_COUNT and BUSINESS_COUNT are 0.3384458 and -1.452245 respectively.</li>
<li>𝛽, the distance decay parameter is -0.621984</li>
<li>there are a series of parameters which are the vector of 𝜇𝑖 values associated with the origin constraints.</li>
</ul>
<p>Next, let us examine how well the proportion of variance in the dependent variable (i.e.&nbsp;TRIPS) that can be explained by the explanatory variables.</p>
<section id="goodness-of-fit" class="level4">
<h4 class="anchored" data-anchor-id="goodness-of-fit">Goodness of fit</h4>
<p>In statistical modelling, the next question we would like to answer is how well the proportion of variance in the dependent variable (i.e.&nbsp;TRIPS) that can be explained by the explanatory variables.</p>
<p>In order to provide answer to this question, R-squared statistics will be used. However, R-squared is not an output of glm(). Hence we will write a function called CalcRSquared by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>CalcRSquared <span class="ot">&lt;-</span> <span class="cf">function</span>(observed, estimated){</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">cor</span>(observed, estimated)</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>  R2 <span class="ot">&lt;-</span> r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  R2</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>NOw, we can examine how the constraints hold for destinations this time.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(orcSIM_Poisson<span class="sc">$</span>data<span class="sc">$</span>TRIPS, orcSIM_Poisson<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.442874</code></pre>
</div>
</div>
<p>With reference to the R-Squared above, we can conclude that the model accounts for about 44% of the variation of flows in the systems. Not bad, but not brilliant either.</p>
</section>
</section>
<section id="doubly-constrained-model" class="level3">
<h3 class="anchored" data-anchor-id="doubly-constrained-model">Doubly constrained model</h3>
<p>In this section, we will fit a doubly constrained SIM by using the general formula shown below:</p>
<p><img src="Doubly constrained model.png" class="img-fluid" width="294"></p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>dbcSIM_Poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>                ORIGIN_SZ <span class="sc">+</span> </span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>                DESTIN_SZ <span class="sc">+</span></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> inter_zonal_flow,</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dbcSIM_Poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ ORIGIN_SZ + DESTIN_SZ + log(dist), family = poisson(link = "log"), 
    data = inter_zonal_flow, na.action = na.exclude)

Coefficients:
                  Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)     21.8312374  0.0059160  3690.190  &lt; 2e-16 ***
ORIGIN_SZAMSZ02  0.5263502  0.0048031   109.585  &lt; 2e-16 ***
ORIGIN_SZAMSZ03  0.3139982  0.0049254    63.751  &lt; 2e-16 ***
ORIGIN_SZAMSZ04 -0.2146257  0.0053639   -40.013  &lt; 2e-16 ***
ORIGIN_SZAMSZ05 -0.1890446  0.0060386   -31.306  &lt; 2e-16 ***
ORIGIN_SZAMSZ06  0.1539201  0.0054401    28.294  &lt; 2e-16 ***
ORIGIN_SZAMSZ07 -0.9826565  0.0098676   -99.584  &lt; 2e-16 ***
ORIGIN_SZAMSZ08 -0.4488417  0.0093070   -48.226  &lt; 2e-16 ***
ORIGIN_SZAMSZ09  0.0713474  0.0057402    12.429  &lt; 2e-16 ***
ORIGIN_SZAMSZ10  0.4313742  0.0050370    85.641  &lt; 2e-16 ***
ORIGIN_SZAMSZ11 -1.4712226  0.0131178  -112.154  &lt; 2e-16 ***
ORIGIN_SZAMSZ12 -1.7250733  0.0111603  -154.573  &lt; 2e-16 ***
ORIGIN_SZBDSZ01  0.8810576  0.0048168   182.914  &lt; 2e-16 ***
ORIGIN_SZBDSZ02  0.1100240  0.0055529    19.814  &lt; 2e-16 ***
ORIGIN_SZBDSZ03  0.3606166  0.0050672    71.167  &lt; 2e-16 ***
ORIGIN_SZBDSZ04  1.4624347  0.0044212   330.781  &lt; 2e-16 ***
ORIGIN_SZBDSZ05  0.6207557  0.0050843   122.092  &lt; 2e-16 ***
ORIGIN_SZBDSZ06  0.6712973  0.0051953   129.214  &lt; 2e-16 ***
ORIGIN_SZBDSZ07 -1.2338669  0.0100775  -122.437  &lt; 2e-16 ***
ORIGIN_SZBDSZ08 -1.0444562  0.0094555  -110.460  &lt; 2e-16 ***
ORIGIN_SZBKSZ01 -0.2838426  0.0071354   -39.780  &lt; 2e-16 ***
ORIGIN_SZBKSZ02  0.5550522  0.0059014    94.054  &lt; 2e-16 ***
ORIGIN_SZBKSZ03  0.7396640  0.0056796   130.231  &lt; 2e-16 ***
ORIGIN_SZBKSZ04 -0.2242451  0.0067482   -33.230  &lt; 2e-16 ***
ORIGIN_SZBKSZ05 -0.2371614  0.0069386   -34.180  &lt; 2e-16 ***
ORIGIN_SZBKSZ06 -0.1413812  0.0065035   -21.739  &lt; 2e-16 ***
ORIGIN_SZBKSZ07  0.7089989  0.0051843   136.758  &lt; 2e-16 ***
ORIGIN_SZBKSZ08 -0.0907065  0.0059157   -15.333  &lt; 2e-16 ***
ORIGIN_SZBKSZ09 -0.1775146  0.0063302   -28.042  &lt; 2e-16 ***
ORIGIN_SZBLSZ01 -2.3684539  0.0154280  -153.516  &lt; 2e-16 ***
ORIGIN_SZBLSZ02 -2.8078475  0.0197839  -141.926  &lt; 2e-16 ***
ORIGIN_SZBLSZ03 -3.3122763  0.0466091   -71.065  &lt; 2e-16 ***
ORIGIN_SZBLSZ04 -2.6770542  0.0241793  -110.717  &lt; 2e-16 ***
ORIGIN_SZBMSZ01  0.0618035  0.0059400    10.405  &lt; 2e-16 ***
ORIGIN_SZBMSZ02 -1.3535767  0.0073741  -183.557  &lt; 2e-16 ***
ORIGIN_SZBMSZ03 -0.7569095  0.0063187  -119.790  &lt; 2e-16 ***
ORIGIN_SZBMSZ04 -0.2949304  0.0059603   -49.483  &lt; 2e-16 ***
ORIGIN_SZBMSZ05 -2.6131992  0.0172376  -151.599  &lt; 2e-16 ***
ORIGIN_SZBMSZ06 -3.0315024  0.0185502  -163.422  &lt; 2e-16 ***
ORIGIN_SZBMSZ07 -0.6962524  0.0064068  -108.674  &lt; 2e-16 ***
ORIGIN_SZBMSZ08 -0.9310730  0.0064541  -144.261  &lt; 2e-16 ***
ORIGIN_SZBMSZ09 -1.2911253  0.0092047  -140.268  &lt; 2e-16 ***
ORIGIN_SZBMSZ10 -1.6687004  0.0095708  -174.353  &lt; 2e-16 ***
ORIGIN_SZBMSZ11 -1.1152794  0.0072027  -154.841  &lt; 2e-16 ***
ORIGIN_SZBMSZ12 -1.5323954  0.0099932  -153.344  &lt; 2e-16 ***
ORIGIN_SZBMSZ13 -0.6267376  0.0065863   -95.158  &lt; 2e-16 ***
ORIGIN_SZBMSZ14 -1.0475467  0.0072472  -144.544  &lt; 2e-16 ***
ORIGIN_SZBMSZ15 -0.5049444  0.0067390   -74.929  &lt; 2e-16 ***
ORIGIN_SZBMSZ16 -1.5282897  0.0099545  -153.527  &lt; 2e-16 ***
ORIGIN_SZBMSZ17 -1.5722349  0.0161533   -97.332  &lt; 2e-16 ***
ORIGIN_SZBPSZ01  0.5814175  0.0062904    92.429  &lt; 2e-16 ***
ORIGIN_SZBPSZ02  0.0875442  0.0072190    12.127  &lt; 2e-16 ***
ORIGIN_SZBPSZ03  0.3358227  0.0070460    47.662  &lt; 2e-16 ***
ORIGIN_SZBPSZ04  0.6507586  0.0057726   112.733  &lt; 2e-16 ***
ORIGIN_SZBPSZ05  0.9502124  0.0052971   179.384  &lt; 2e-16 ***
ORIGIN_SZBPSZ06 -1.0480314  0.0098191  -106.734  &lt; 2e-16 ***
ORIGIN_SZBPSZ07 -0.5467931  0.0091676   -59.644  &lt; 2e-16 ***
ORIGIN_SZBSSZ01  0.2998334  0.0059193    50.654  &lt; 2e-16 ***
ORIGIN_SZBSSZ02  0.2841036  0.0050863    55.856  &lt; 2e-16 ***
ORIGIN_SZBSSZ03 -0.2331505  0.0056565   -41.218  &lt; 2e-16 ***
ORIGIN_SZBTSZ01  0.0987284  0.0063715    15.495  &lt; 2e-16 ***
ORIGIN_SZBTSZ02 -0.6261229  0.0084604   -74.006  &lt; 2e-16 ***
ORIGIN_SZBTSZ03 -0.4326963  0.0073452   -58.909  &lt; 2e-16 ***
ORIGIN_SZBTSZ04 -1.4998668  0.0110013  -136.336  &lt; 2e-16 ***
ORIGIN_SZBTSZ05 -0.9564768  0.0122202   -78.270  &lt; 2e-16 ***
ORIGIN_SZBTSZ06 -1.2853131  0.0099328  -129.401  &lt; 2e-16 ***
ORIGIN_SZBTSZ07 -2.3870991  0.0144589  -165.096  &lt; 2e-16 ***
ORIGIN_SZBTSZ08 -1.3715855  0.0113825  -120.499  &lt; 2e-16 ***
ORIGIN_SZCBSZ01 -3.5940232  0.0548979   -65.467  &lt; 2e-16 ***
ORIGIN_SZCCSZ01 -0.7008220  0.0140373   -49.926  &lt; 2e-16 ***
ORIGIN_SZCHSZ01 -0.9109524  0.0122869   -74.140  &lt; 2e-16 ***
ORIGIN_SZCHSZ02 -0.8566547  0.0088749   -96.526  &lt; 2e-16 ***
ORIGIN_SZCHSZ03  1.1153731  0.0066136   168.650  &lt; 2e-16 ***
ORIGIN_SZCKSZ01  0.3001815  0.0058548    51.271  &lt; 2e-16 ***
ORIGIN_SZCKSZ02  0.7185711  0.0060595   118.585  &lt; 2e-16 ***
ORIGIN_SZCKSZ03  1.1389824  0.0053179   214.178  &lt; 2e-16 ***
ORIGIN_SZCKSZ04  1.6281772  0.0054761   297.324  &lt; 2e-16 ***
ORIGIN_SZCKSZ05  0.8338470  0.0064178   129.927  &lt; 2e-16 ***
ORIGIN_SZCKSZ06  0.6528993  0.0082375    79.259  &lt; 2e-16 ***
ORIGIN_SZCLSZ01 -0.7174758  0.0082123   -87.366  &lt; 2e-16 ***
ORIGIN_SZCLSZ02 -1.7513100  0.0139062  -125.938  &lt; 2e-16 ***
ORIGIN_SZCLSZ03 -1.0362873  0.0085485  -121.224  &lt; 2e-16 ***
ORIGIN_SZCLSZ04  0.6160017  0.0051276   120.136  &lt; 2e-16 ***
ORIGIN_SZCLSZ05 -2.1005122  0.0150228  -139.821  &lt; 2e-16 ***
ORIGIN_SZCLSZ06  0.7252108  0.0049447   146.665  &lt; 2e-16 ***
ORIGIN_SZCLSZ07 -0.5343482  0.0062500   -85.496  &lt; 2e-16 ***
ORIGIN_SZCLSZ08 -0.2153408  0.0067571   -31.869  &lt; 2e-16 ***
ORIGIN_SZCLSZ09 -1.8019961  0.0169078  -106.578  &lt; 2e-16 ***
ORIGIN_SZDTSZ02 -3.9057711  0.0834668   -46.794  &lt; 2e-16 ***
ORIGIN_SZDTSZ03 -3.4152419  0.0738650   -46.236  &lt; 2e-16 ***
ORIGIN_SZDTSZ13 -3.0183438  0.0315257   -95.742  &lt; 2e-16 ***
ORIGIN_SZGLSZ01 -1.7812384  0.0099367  -179.258  &lt; 2e-16 ***
ORIGIN_SZGLSZ02 -0.1074991  0.0054325   -19.788  &lt; 2e-16 ***
ORIGIN_SZGLSZ03 -0.2461106  0.0057176   -43.045  &lt; 2e-16 ***
ORIGIN_SZGLSZ04  0.8657186  0.0046413   186.524  &lt; 2e-16 ***
ORIGIN_SZGLSZ05  0.5871393  0.0047939   122.477  &lt; 2e-16 ***
ORIGIN_SZHGSZ01  0.3543819  0.0050461    70.229  &lt; 2e-16 ***
ORIGIN_SZHGSZ02  0.4218178  0.0050820    83.003  &lt; 2e-16 ***
ORIGIN_SZHGSZ03  0.2411309  0.0054241    44.456  &lt; 2e-16 ***
ORIGIN_SZHGSZ04  0.8180622  0.0046153   177.252  &lt; 2e-16 ***
ORIGIN_SZHGSZ05  1.2173687  0.0045655   266.647  &lt; 2e-16 ***
ORIGIN_SZHGSZ06 -0.1826300  0.0058214   -31.372  &lt; 2e-16 ***
ORIGIN_SZHGSZ07  0.3172839  0.0050733    62.540  &lt; 2e-16 ***
ORIGIN_SZHGSZ08 -0.1151369  0.0057067   -20.176  &lt; 2e-16 ***
ORIGIN_SZHGSZ09 -1.2873441  0.0091690  -140.401  &lt; 2e-16 ***
ORIGIN_SZHGSZ10 -3.3783178  0.0424682   -79.549  &lt; 2e-16 ***
ORIGIN_SZJESZ01  0.4859234  0.0055927    86.885  &lt; 2e-16 ***
ORIGIN_SZJESZ02  0.1766088  0.0055800    31.650  &lt; 2e-16 ***
ORIGIN_SZJESZ03 -0.2177441  0.0059535   -36.574  &lt; 2e-16 ***
ORIGIN_SZJESZ04 -1.5532182  0.0104526  -148.597  &lt; 2e-16 ***
ORIGIN_SZJESZ05 -2.3332926  0.0142701  -163.509  &lt; 2e-16 ***
ORIGIN_SZJESZ06  0.3007382  0.0055019    54.661  &lt; 2e-16 ***
ORIGIN_SZJESZ07 -1.9687994  0.0121092  -162.587  &lt; 2e-16 ***
ORIGIN_SZJESZ08 -1.3032070  0.0122024  -106.800  &lt; 2e-16 ***
ORIGIN_SZJESZ09  0.5762635  0.0058766    98.061  &lt; 2e-16 ***
ORIGIN_SZJESZ10 -1.4423113  0.0194773   -74.051  &lt; 2e-16 ***
ORIGIN_SZJESZ11 -1.9720897  0.0200811   -98.206  &lt; 2e-16 ***
ORIGIN_SZJWSZ01  0.3808627  0.0071357    53.374  &lt; 2e-16 ***
ORIGIN_SZJWSZ02  0.7963999  0.0053150   149.840  &lt; 2e-16 ***
ORIGIN_SZJWSZ03  1.5429636  0.0049961   308.834  &lt; 2e-16 ***
ORIGIN_SZJWSZ04  0.6410760  0.0056711   113.042  &lt; 2e-16 ***
ORIGIN_SZJWSZ05 -2.1571049  0.0133584  -161.479  &lt; 2e-16 ***
ORIGIN_SZJWSZ06 -1.5174532  0.0113384  -133.833  &lt; 2e-16 ***
ORIGIN_SZJWSZ07 -2.7089963  0.0280439   -96.598  &lt; 2e-16 ***
ORIGIN_SZJWSZ08  1.5343415  0.0051711   296.713  &lt; 2e-16 ***
ORIGIN_SZJWSZ09  1.8837410  0.0048845   385.656  &lt; 2e-16 ***
ORIGIN_SZKLSZ01  0.1081286  0.0053307    20.284  &lt; 2e-16 ***
ORIGIN_SZKLSZ02 -0.8844695  0.0067728  -130.591  &lt; 2e-16 ***
ORIGIN_SZKLSZ03 -0.6872640  0.0062857  -109.337  &lt; 2e-16 ***
ORIGIN_SZKLSZ04 -2.2090319  0.0122440  -180.418  &lt; 2e-16 ***
ORIGIN_SZKLSZ05 -1.1728726  0.0110765  -105.888  &lt; 2e-16 ***
ORIGIN_SZKLSZ06 -6.1162315  0.1857789   -32.922  &lt; 2e-16 ***
ORIGIN_SZKLSZ07 -1.4082749  0.0092299  -152.578  &lt; 2e-16 ***
ORIGIN_SZKLSZ08 -1.7781551  0.0104682  -169.862  &lt; 2e-16 ***
ORIGIN_SZLKSZ01 -2.0531568  0.0398803   -51.483  &lt; 2e-16 ***
ORIGIN_SZMDSZ01 -0.8825639  0.0287621   -30.685  &lt; 2e-16 ***
ORIGIN_SZMDSZ02 -0.6219993  0.0107388   -57.921  &lt; 2e-16 ***
ORIGIN_SZMDSZ03 -2.0840156  0.0173117  -120.382  &lt; 2e-16 ***
ORIGIN_SZMPSZ01 -0.9659093  0.0086972  -111.060  &lt; 2e-16 ***
ORIGIN_SZMPSZ02 -1.0411153  0.0073403  -141.836  &lt; 2e-16 ***
ORIGIN_SZMPSZ03  0.0001659  0.0059401     0.028 0.977719    
ORIGIN_SZMUSZ02 -3.7599031  0.1037937   -36.225  &lt; 2e-16 ***
ORIGIN_SZNTSZ01 -3.0388366  0.0355325   -85.523  &lt; 2e-16 ***
ORIGIN_SZNTSZ02 -3.4230640  0.0235902  -145.106  &lt; 2e-16 ***
ORIGIN_SZNTSZ03 -0.9094796  0.0082551  -110.172  &lt; 2e-16 ***
ORIGIN_SZNTSZ05 -4.0861681  0.0499630   -81.784  &lt; 2e-16 ***
ORIGIN_SZNTSZ06 -3.9497128  0.0565388   -69.858  &lt; 2e-16 ***
ORIGIN_SZNVSZ01  0.3235636  0.0049439    65.447  &lt; 2e-16 ***
ORIGIN_SZNVSZ02 -0.6946748  0.0070536   -98.485  &lt; 2e-16 ***
ORIGIN_SZNVSZ03 -1.0540196  0.0083781  -125.806  &lt; 2e-16 ***
ORIGIN_SZNVSZ04 -0.9897977  0.0093463  -105.903  &lt; 2e-16 ***
ORIGIN_SZNVSZ05 -2.2578432  0.0169180  -133.458  &lt; 2e-16 ***
ORIGIN_SZPGSZ01  0.2399827  0.0130436    18.398  &lt; 2e-16 ***
ORIGIN_SZPGSZ02 -0.3352342  0.0078451   -42.732  &lt; 2e-16 ***
ORIGIN_SZPGSZ03  0.9515148  0.0051376   185.207  &lt; 2e-16 ***
ORIGIN_SZPGSZ04  1.3998952  0.0047991   291.697  &lt; 2e-16 ***
ORIGIN_SZPGSZ05  0.4451629  0.0063423    70.189  &lt; 2e-16 ***
ORIGIN_SZPLSZ01 -0.9705918  0.0122781   -79.050  &lt; 2e-16 ***
ORIGIN_SZPLSZ02 -1.0670151  0.0153358   -69.577  &lt; 2e-16 ***
ORIGIN_SZPLSZ03 -2.1229124  0.0373527   -56.834  &lt; 2e-16 ***
ORIGIN_SZPLSZ04 -3.0911932  0.0371296   -83.254  &lt; 2e-16 ***
ORIGIN_SZPLSZ05 -2.1705708  0.0226085   -96.007  &lt; 2e-16 ***
ORIGIN_SZPNSZ01  0.9052637  0.0065952   137.262  &lt; 2e-16 ***
ORIGIN_SZPNSZ02 -0.1720425  0.0125658   -13.691  &lt; 2e-16 ***
ORIGIN_SZPNSZ03 -2.3973459  0.0201408  -119.029  &lt; 2e-16 ***
ORIGIN_SZPNSZ04 -3.4483689  0.0343741  -100.319  &lt; 2e-16 ***
ORIGIN_SZPNSZ05 -2.0588530  0.0282328   -72.924  &lt; 2e-16 ***
ORIGIN_SZPRSZ01 -0.6399015  0.0120470   -53.117  &lt; 2e-16 ***
ORIGIN_SZPRSZ02  0.8122270  0.0050886   159.617  &lt; 2e-16 ***
ORIGIN_SZPRSZ03  0.3990960  0.0051810    77.031  &lt; 2e-16 ***
ORIGIN_SZPRSZ04 -0.8485348  0.0079236  -107.089  &lt; 2e-16 ***
ORIGIN_SZPRSZ05  0.8008791  0.0048532   165.021  &lt; 2e-16 ***
ORIGIN_SZPRSZ06 -1.4498806  0.0121422  -119.408  &lt; 2e-16 ***
ORIGIN_SZPRSZ07 -3.2025045  0.0167118  -191.631  &lt; 2e-16 ***
ORIGIN_SZPRSZ08 -0.5862269  0.0067255   -87.165  &lt; 2e-16 ***
ORIGIN_SZQTSZ01 -0.1859270  0.0075531   -24.616  &lt; 2e-16 ***
ORIGIN_SZQTSZ02 -0.8715122  0.0068124  -127.929  &lt; 2e-16 ***
ORIGIN_SZQTSZ03 -0.1259816  0.0064796   -19.443  &lt; 2e-16 ***
ORIGIN_SZQTSZ04 -1.4620032  0.0079848  -183.098  &lt; 2e-16 ***
ORIGIN_SZQTSZ05 -0.6675643  0.0069616   -95.892  &lt; 2e-16 ***
ORIGIN_SZQTSZ06 -0.8190026  0.0072713  -112.634  &lt; 2e-16 ***
ORIGIN_SZQTSZ07 -1.5189403  0.0099864  -152.101  &lt; 2e-16 ***
ORIGIN_SZQTSZ08 -0.4976238  0.0067874   -73.316  &lt; 2e-16 ***
ORIGIN_SZQTSZ09 -0.9006162  0.0075978  -118.536  &lt; 2e-16 ***
ORIGIN_SZQTSZ10 -0.6690184  0.0071574   -93.473  &lt; 2e-16 ***
ORIGIN_SZQTSZ11 -2.5203437  0.0147000  -171.452  &lt; 2e-16 ***
ORIGIN_SZQTSZ12 -3.0461675  0.0190193  -160.162  &lt; 2e-16 ***
ORIGIN_SZQTSZ13 -0.7501068  0.0084481   -88.791  &lt; 2e-16 ***
ORIGIN_SZQTSZ14 -1.9321849  0.0126114  -153.209  &lt; 2e-16 ***
ORIGIN_SZQTSZ15 -0.9576828  0.0127157   -75.315  &lt; 2e-16 ***
ORIGIN_SZRCSZ01 -1.8167951  0.0129234  -140.582  &lt; 2e-16 ***
ORIGIN_SZRCSZ06 -0.5560563  0.0090507   -61.438  &lt; 2e-16 ***
ORIGIN_SZRVSZ01 -2.8862570  0.0325532   -88.663  &lt; 2e-16 ***
ORIGIN_SZRVSZ02 -3.1555662  0.0281279  -112.186  &lt; 2e-16 ***
ORIGIN_SZRVSZ03 -2.9836089  0.0248449  -120.089  &lt; 2e-16 ***
ORIGIN_SZRVSZ04 -3.5520422  0.0561371   -63.274  &lt; 2e-16 ***
ORIGIN_SZRVSZ05 -2.5866584  0.0180382  -143.399  &lt; 2e-16 ***
ORIGIN_SZSBSZ01  0.2867444  0.0071098    40.331  &lt; 2e-16 ***
ORIGIN_SZSBSZ02 -0.9012334  0.0087262  -103.278  &lt; 2e-16 ***
ORIGIN_SZSBSZ03  0.8311038  0.0055422   149.958  &lt; 2e-16 ***
ORIGIN_SZSBSZ04  0.4044170  0.0062047    65.179  &lt; 2e-16 ***
ORIGIN_SZSBSZ05 -0.2661845  0.0074162   -35.892  &lt; 2e-16 ***
ORIGIN_SZSBSZ06 -0.9023075  0.0175046   -51.547  &lt; 2e-16 ***
ORIGIN_SZSBSZ07  0.0505870  0.0131317     3.852 0.000117 ***
ORIGIN_SZSBSZ08 -1.1158011  0.0145416   -76.732  &lt; 2e-16 ***
ORIGIN_SZSBSZ09 -0.9682835  0.0095396  -101.501  &lt; 2e-16 ***
ORIGIN_SZSESZ02  1.1452735  0.0047810   239.548  &lt; 2e-16 ***
ORIGIN_SZSESZ03  1.2815277  0.0045677   280.564  &lt; 2e-16 ***
ORIGIN_SZSESZ04  0.8085857  0.0052756   153.269  &lt; 2e-16 ***
ORIGIN_SZSESZ05 -0.2329413  0.0063113   -36.909  &lt; 2e-16 ***
ORIGIN_SZSESZ06  1.0576879  0.0049909   211.925  &lt; 2e-16 ***
ORIGIN_SZSESZ07 -2.3165908  0.0196831  -117.695  &lt; 2e-16 ***
ORIGIN_SZSGSZ01 -0.6606350  0.0088079   -75.005  &lt; 2e-16 ***
ORIGIN_SZSGSZ02 -1.3638984  0.0104040  -131.094  &lt; 2e-16 ***
ORIGIN_SZSGSZ03  0.1152591  0.0054649    21.091  &lt; 2e-16 ***
ORIGIN_SZSGSZ04  0.2954067  0.0050865    58.077  &lt; 2e-16 ***
ORIGIN_SZSGSZ05 -2.0792678  0.0109882  -189.227  &lt; 2e-16 ***
ORIGIN_SZSGSZ06  0.4563227  0.0048880    93.356  &lt; 2e-16 ***
ORIGIN_SZSGSZ07 -0.8955254  0.0067100  -133.461  &lt; 2e-16 ***
ORIGIN_SZSKSZ01 -0.3184402  0.0093032   -34.229  &lt; 2e-16 ***
ORIGIN_SZSKSZ02  1.1160484  0.0063851   174.790  &lt; 2e-16 ***
ORIGIN_SZSKSZ03 -0.2566692  0.0086021   -29.838  &lt; 2e-16 ***
ORIGIN_SZSKSZ04 -1.5781827  0.0279394   -56.486  &lt; 2e-16 ***
ORIGIN_SZSKSZ05 -0.2724361  0.0163597   -16.653  &lt; 2e-16 ***
ORIGIN_SZSLSZ01 -2.4458625  0.0330301   -74.050  &lt; 2e-16 ***
ORIGIN_SZSLSZ04 -0.0987076  0.0079626   -12.396  &lt; 2e-16 ***
ORIGIN_SZSRSZ01 -2.2584977  0.0176647  -127.854  &lt; 2e-16 ***
ORIGIN_SZTHSZ01 -2.5878524  0.0489998   -52.814  &lt; 2e-16 ***
ORIGIN_SZTHSZ03 -0.8101746  0.0226814   -35.720  &lt; 2e-16 ***
ORIGIN_SZTHSZ04 -2.4186655  0.0288663   -83.789  &lt; 2e-16 ***
ORIGIN_SZTHSZ06 -1.7080541  0.0186353   -91.657  &lt; 2e-16 ***
ORIGIN_SZTMSZ01 -0.2193476  0.0061823   -35.480  &lt; 2e-16 ***
ORIGIN_SZTMSZ02  1.7772464  0.0043394   409.558  &lt; 2e-16 ***
ORIGIN_SZTMSZ03  1.0051343  0.0046055   218.249  &lt; 2e-16 ***
ORIGIN_SZTMSZ04  0.1642370  0.0055078    29.819  &lt; 2e-16 ***
ORIGIN_SZTMSZ05 -1.2878706  0.0114828  -112.157  &lt; 2e-16 ***
ORIGIN_SZTNSZ01 -1.7163504  0.0131268  -130.751  &lt; 2e-16 ***
ORIGIN_SZTNSZ02 -1.6508988  0.0103851  -158.968  &lt; 2e-16 ***
ORIGIN_SZTNSZ03 -2.1545577  0.0137947  -156.187  &lt; 2e-16 ***
ORIGIN_SZTNSZ04 -0.3949120  0.0078496   -50.310  &lt; 2e-16 ***
ORIGIN_SZTPSZ01 -0.8058100  0.0069916  -115.253  &lt; 2e-16 ***
ORIGIN_SZTPSZ02  0.5369060  0.0047272   113.577  &lt; 2e-16 ***
ORIGIN_SZTPSZ03 -0.7779333  0.0064278  -121.027  &lt; 2e-16 ***
ORIGIN_SZTPSZ04 -0.8153581  0.0061387  -132.823  &lt; 2e-16 ***
ORIGIN_SZTPSZ05 -0.5073676  0.0067771   -74.865  &lt; 2e-16 ***
ORIGIN_SZTPSZ06  0.0847301  0.0065717    12.893  &lt; 2e-16 ***
ORIGIN_SZTPSZ07 -0.5839519  0.0066148   -88.280  &lt; 2e-16 ***
ORIGIN_SZTPSZ08 -1.0577941  0.0098480  -107.412  &lt; 2e-16 ***
ORIGIN_SZTPSZ09 -0.9067707  0.0071367  -127.057  &lt; 2e-16 ***
ORIGIN_SZTPSZ10 -1.1362091  0.0080905  -140.438  &lt; 2e-16 ***
ORIGIN_SZTPSZ11 -0.2374621  0.0059472   -39.928  &lt; 2e-16 ***
ORIGIN_SZTPSZ12 -0.8028874  0.0069663  -115.253  &lt; 2e-16 ***
ORIGIN_SZTSSZ01 -2.7809271  0.0482843   -57.595  &lt; 2e-16 ***
ORIGIN_SZTSSZ02  0.0425804  0.0105088     4.052 5.08e-05 ***
ORIGIN_SZTSSZ03  0.1142369  0.0109412    10.441  &lt; 2e-16 ***
ORIGIN_SZTSSZ04 -0.6186261  0.0116324   -53.181  &lt; 2e-16 ***
ORIGIN_SZTSSZ05 -1.0846732  0.0173555   -62.497  &lt; 2e-16 ***
ORIGIN_SZTSSZ06  0.3980173  0.0198100    20.092  &lt; 2e-16 ***
ORIGIN_SZWCSZ01  1.3545143  0.0092002   147.227  &lt; 2e-16 ***
ORIGIN_SZWCSZ02 -2.9863278  0.0330906   -90.247  &lt; 2e-16 ***
ORIGIN_SZWCSZ03 -5.0504916  0.1241385   -40.684  &lt; 2e-16 ***
ORIGIN_SZWDSZ01  1.5238429  0.0049404   308.448  &lt; 2e-16 ***
ORIGIN_SZWDSZ02  0.2832576  0.0056218    50.386  &lt; 2e-16 ***
ORIGIN_SZWDSZ03  1.3702524  0.0053266   257.245  &lt; 2e-16 ***
ORIGIN_SZWDSZ04  1.0248225  0.0059272   172.903  &lt; 2e-16 ***
ORIGIN_SZWDSZ05  0.2356778  0.0060587    38.899  &lt; 2e-16 ***
ORIGIN_SZWDSZ06  0.3146925  0.0059919    52.520  &lt; 2e-16 ***
ORIGIN_SZWDSZ07 -1.4971897  0.0091243  -164.088  &lt; 2e-16 ***
ORIGIN_SZWDSZ08 -0.8894079  0.0087414  -101.747  &lt; 2e-16 ***
ORIGIN_SZWDSZ09  1.4437633  0.0053160   271.590  &lt; 2e-16 ***
ORIGIN_SZYSSZ01 -0.2519398  0.0064443   -39.095  &lt; 2e-16 ***
ORIGIN_SZYSSZ02  0.8726785  0.0057658   151.354  &lt; 2e-16 ***
ORIGIN_SZYSSZ03  1.7868139  0.0050674   352.611  &lt; 2e-16 ***
ORIGIN_SZYSSZ04  0.8418040  0.0051738   162.704  &lt; 2e-16 ***
ORIGIN_SZYSSZ05  0.4292096  0.0062520    68.652  &lt; 2e-16 ***
ORIGIN_SZYSSZ06 -0.7459961  0.0119123   -62.624  &lt; 2e-16 ***
ORIGIN_SZYSSZ07 -0.8422281  0.0144559   -58.262  &lt; 2e-16 ***
ORIGIN_SZYSSZ08  0.1829428  0.0067885    26.949  &lt; 2e-16 ***
ORIGIN_SZYSSZ09  1.1159712  0.0050760   219.853  &lt; 2e-16 ***
DESTIN_SZAMSZ02  0.0694567  0.0045966    15.111  &lt; 2e-16 ***
DESTIN_SZAMSZ03  0.0760100  0.0044639    17.028  &lt; 2e-16 ***
DESTIN_SZAMSZ04 -1.1306391  0.0064373  -175.639  &lt; 2e-16 ***
DESTIN_SZAMSZ05 -1.0751133  0.0065164  -164.985  &lt; 2e-16 ***
DESTIN_SZAMSZ06 -0.9624298  0.0065937  -145.962  &lt; 2e-16 ***
DESTIN_SZAMSZ07 -1.5060319  0.0097616  -154.281  &lt; 2e-16 ***
DESTIN_SZAMSZ08 -0.4813202  0.0069794   -68.963  &lt; 2e-16 ***
DESTIN_SZAMSZ09 -1.0220675  0.0066313  -154.129  &lt; 2e-16 ***
DESTIN_SZAMSZ10  0.1235142  0.0047044    26.255  &lt; 2e-16 ***
DESTIN_SZAMSZ11 -0.8917993  0.0088519  -100.746  &lt; 2e-16 ***
DESTIN_SZAMSZ12  0.0195208  0.0051704     3.775 0.000160 ***
DESTIN_SZBDSZ01  0.9736349  0.0042757   227.713  &lt; 2e-16 ***
DESTIN_SZBDSZ02 -0.1969470  0.0055284   -35.625  &lt; 2e-16 ***
DESTIN_SZBDSZ03  0.1266471  0.0050786    24.938  &lt; 2e-16 ***
DESTIN_SZBDSZ04  1.1608485  0.0041956   276.684  &lt; 2e-16 ***
DESTIN_SZBDSZ05  0.9293840  0.0044412   209.265  &lt; 2e-16 ***
DESTIN_SZBDSZ06  0.4090567  0.0050300    81.323  &lt; 2e-16 ***
DESTIN_SZBDSZ07 -0.8171478  0.0098945   -82.586  &lt; 2e-16 ***
DESTIN_SZBDSZ08 -1.5895287  0.0111632  -142.391  &lt; 2e-16 ***
DESTIN_SZBKSZ01 -1.3793311  0.0072145  -191.189  &lt; 2e-16 ***
DESTIN_SZBKSZ02 -0.5253670  0.0061879   -84.903  &lt; 2e-16 ***
DESTIN_SZBKSZ03 -1.0095362  0.0065426  -154.301  &lt; 2e-16 ***
DESTIN_SZBKSZ04 -0.5662858  0.0056453  -100.311  &lt; 2e-16 ***
DESTIN_SZBKSZ05 -0.9406607  0.0070597  -133.244  &lt; 2e-16 ***
DESTIN_SZBKSZ06 -1.3129276  0.0067414  -194.755  &lt; 2e-16 ***
DESTIN_SZBKSZ07  0.0120605  0.0049284     2.447 0.014400 *  
DESTIN_SZBKSZ08 -1.3658471  0.0075109  -181.849  &lt; 2e-16 ***
DESTIN_SZBKSZ09 -0.1771310  0.0055645   -31.832  &lt; 2e-16 ***
DESTIN_SZBLSZ01 -0.8175223  0.0075645  -108.074  &lt; 2e-16 ***
DESTIN_SZBLSZ02  0.1631280  0.0071753    22.735  &lt; 2e-16 ***
DESTIN_SZBLSZ03  1.2598494  0.0081706   154.194  &lt; 2e-16 ***
DESTIN_SZBLSZ04 -0.5642975  0.0137827   -40.943  &lt; 2e-16 ***
DESTIN_SZBMSZ01  0.6921844  0.0054211   127.684  &lt; 2e-16 ***
DESTIN_SZBMSZ02 -0.1209392  0.0055362   -21.845  &lt; 2e-16 ***
DESTIN_SZBMSZ03 -0.2373881  0.0062427   -38.027  &lt; 2e-16 ***
DESTIN_SZBMSZ04 -0.0407117  0.0058001    -7.019 2.23e-12 ***
DESTIN_SZBMSZ05 -0.2363309  0.0075967   -31.110  &lt; 2e-16 ***
DESTIN_SZBMSZ06 -1.1930710  0.0134761   -88.532  &lt; 2e-16 ***
DESTIN_SZBMSZ07  0.4625103  0.0051864    89.178  &lt; 2e-16 ***
DESTIN_SZBMSZ08 -0.8604731  0.0069899  -123.102  &lt; 2e-16 ***
DESTIN_SZBMSZ09 -2.1290239  0.0154841  -137.498  &lt; 2e-16 ***
DESTIN_SZBMSZ10 -1.4617153  0.0094014  -155.478  &lt; 2e-16 ***
DESTIN_SZBMSZ11 -1.3234050  0.0085506  -154.773  &lt; 2e-16 ***
DESTIN_SZBMSZ12 -0.8399230  0.0085361   -98.397  &lt; 2e-16 ***
DESTIN_SZBMSZ13  0.1366529  0.0059697    22.891  &lt; 2e-16 ***
DESTIN_SZBMSZ14 -1.0491968  0.0083021  -126.378  &lt; 2e-16 ***
DESTIN_SZBMSZ15 -0.6726684  0.0076276   -88.189  &lt; 2e-16 ***
DESTIN_SZBMSZ16 -1.4011734  0.0116569  -120.201  &lt; 2e-16 ***
DESTIN_SZBMSZ17 -1.5682752  0.0167333   -93.722  &lt; 2e-16 ***
DESTIN_SZBPSZ01 -1.1120017  0.0063197  -175.959  &lt; 2e-16 ***
DESTIN_SZBPSZ02 -2.0833466  0.0091139  -228.590  &lt; 2e-16 ***
DESTIN_SZBPSZ03 -1.6937265  0.0087437  -193.709  &lt; 2e-16 ***
DESTIN_SZBPSZ04 -0.7964999  0.0066129  -120.447  &lt; 2e-16 ***
DESTIN_SZBPSZ05  0.2109118  0.0048815    43.206  &lt; 2e-16 ***
DESTIN_SZBPSZ06 -1.1808365  0.0083657  -141.152  &lt; 2e-16 ***
DESTIN_SZBPSZ07 -0.2077428  0.0084543   -24.572  &lt; 2e-16 ***
DESTIN_SZBSSZ01  0.3164175  0.0050682    62.431  &lt; 2e-16 ***
DESTIN_SZBSSZ02 -0.4852688  0.0057001   -85.134  &lt; 2e-16 ***
DESTIN_SZBSSZ03  0.4130432  0.0043061    95.921  &lt; 2e-16 ***
DESTIN_SZBTSZ01  0.6215095  0.0048914   127.061  &lt; 2e-16 ***
DESTIN_SZBTSZ02 -0.0145076  0.0071799    -2.021 0.043324 *  
DESTIN_SZBTSZ03  0.4919981  0.0058498    84.105  &lt; 2e-16 ***
DESTIN_SZBTSZ04 -0.6957555  0.0114078   -60.989  &lt; 2e-16 ***
DESTIN_SZBTSZ05  0.3329814  0.0073568    45.262  &lt; 2e-16 ***
DESTIN_SZBTSZ06 -0.1333295  0.0073965   -18.026  &lt; 2e-16 ***
DESTIN_SZBTSZ07 -1.4449581  0.0113186  -127.663  &lt; 2e-16 ***
DESTIN_SZBTSZ08 -0.7079056  0.0103797   -68.201  &lt; 2e-16 ***
DESTIN_SZCBSZ01 -5.7344725  0.3162767   -18.131  &lt; 2e-16 ***
DESTIN_SZCCSZ01 -0.0009541  0.0083381    -0.114 0.908900    
DESTIN_SZCHSZ01 -0.2083016  0.0099054   -21.029  &lt; 2e-16 ***
DESTIN_SZCHSZ02  0.5369606  0.0057531    93.334  &lt; 2e-16 ***
DESTIN_SZCHSZ03  2.5530638  0.0043945   580.971  &lt; 2e-16 ***
DESTIN_SZCKSZ01 -0.5725975  0.0056507  -101.333  &lt; 2e-16 ***
DESTIN_SZCKSZ02 -1.1181852  0.0063287  -176.685  &lt; 2e-16 ***
DESTIN_SZCKSZ03  0.1156680  0.0049440    23.396  &lt; 2e-16 ***
DESTIN_SZCKSZ04 -0.8647725  0.0071003  -121.794  &lt; 2e-16 ***
DESTIN_SZCKSZ05 -1.1641791  0.0076248  -152.684  &lt; 2e-16 ***
DESTIN_SZCKSZ06 -0.4397612  0.0073040   -60.208  &lt; 2e-16 ***
DESTIN_SZCLSZ01  0.1930552  0.0053752    35.916  &lt; 2e-16 ***
DESTIN_SZCLSZ02 -2.0436501  0.0136039  -150.225  &lt; 2e-16 ***
DESTIN_SZCLSZ03 -0.9338571  0.0082908  -112.638  &lt; 2e-16 ***
DESTIN_SZCLSZ04  0.0532041  0.0053276     9.987  &lt; 2e-16 ***
DESTIN_SZCLSZ05 -1.0782781  0.0088184  -122.276  &lt; 2e-16 ***
DESTIN_SZCLSZ06  0.4068171  0.0049068    82.910  &lt; 2e-16 ***
DESTIN_SZCLSZ07 -0.3579507  0.0060289   -59.373  &lt; 2e-16 ***
DESTIN_SZCLSZ08 -0.2487993  0.0066588   -37.364  &lt; 2e-16 ***
DESTIN_SZCLSZ09  0.1611080  0.0071178    22.635  &lt; 2e-16 ***
DESTIN_SZDTSZ02 -1.7308348  0.0349466   -49.528  &lt; 2e-16 ***
DESTIN_SZDTSZ03 -0.5994253  0.0146230   -40.992  &lt; 2e-16 ***
DESTIN_SZDTSZ13 -1.3685031  0.0162803   -84.059  &lt; 2e-16 ***
DESTIN_SZGLSZ01 -0.0910001  0.0055275   -16.463  &lt; 2e-16 ***
DESTIN_SZGLSZ02 -0.0692224  0.0052840   -13.100  &lt; 2e-16 ***
DESTIN_SZGLSZ03  0.6493421  0.0043446   149.459  &lt; 2e-16 ***
DESTIN_SZGLSZ04  0.9327947  0.0043674   213.583  &lt; 2e-16 ***
DESTIN_SZGLSZ05  0.8161728  0.0043625   187.087  &lt; 2e-16 ***
DESTIN_SZHGSZ01  0.0658625  0.0042516    15.491  &lt; 2e-16 ***
DESTIN_SZHGSZ02 -0.8134329  0.0056721  -143.409  &lt; 2e-16 ***
DESTIN_SZHGSZ03 -1.3546132  0.0066257  -204.448  &lt; 2e-16 ***
DESTIN_SZHGSZ04 -0.4500588  0.0048448   -92.895  &lt; 2e-16 ***
DESTIN_SZHGSZ05 -0.5026431  0.0050996   -98.566  &lt; 2e-16 ***
DESTIN_SZHGSZ06 -0.8673686  0.0059530  -145.704  &lt; 2e-16 ***
DESTIN_SZHGSZ07  0.0560490  0.0047702    11.750  &lt; 2e-16 ***
DESTIN_SZHGSZ08 -0.0443189  0.0052599    -8.426  &lt; 2e-16 ***
DESTIN_SZHGSZ09 -0.0126355  0.0054966    -2.299 0.021518 *  
DESTIN_SZHGSZ10 -3.5821793  0.0263281  -136.059  &lt; 2e-16 ***
DESTIN_SZJESZ01 -0.3704281  0.0056684   -65.350  &lt; 2e-16 ***
DESTIN_SZJESZ02 -0.7369159  0.0058686  -125.570  &lt; 2e-16 ***
DESTIN_SZJESZ03 -0.8985484  0.0063627  -141.222  &lt; 2e-16 ***
DESTIN_SZJESZ04 -1.0511995  0.0073996  -142.061  &lt; 2e-16 ***
DESTIN_SZJESZ05 -1.5324974  0.0102612  -149.349  &lt; 2e-16 ***
DESTIN_SZJESZ06  0.3105267  0.0048241    64.370  &lt; 2e-16 ***
DESTIN_SZJESZ07 -1.3234483  0.0085497  -154.795  &lt; 2e-16 ***
DESTIN_SZJESZ08 -0.6559742  0.0083174   -78.867  &lt; 2e-16 ***
DESTIN_SZJESZ09  0.2663752  0.0063370    42.035  &lt; 2e-16 ***
DESTIN_SZJESZ10  0.8529026  0.0076067   112.126  &lt; 2e-16 ***
DESTIN_SZJESZ11  0.5559641  0.0074629    74.497  &lt; 2e-16 ***
DESTIN_SZJWSZ01 -0.9790971  0.0071830  -136.308  &lt; 2e-16 ***
DESTIN_SZJWSZ02 -0.8746590  0.0060179  -145.342  &lt; 2e-16 ***
DESTIN_SZJWSZ03  0.5689062  0.0049105   115.855  &lt; 2e-16 ***
DESTIN_SZJWSZ04  0.4520963  0.0050302    89.876  &lt; 2e-16 ***
DESTIN_SZJWSZ05 -1.0249671  0.0067371  -152.137  &lt; 2e-16 ***
DESTIN_SZJWSZ06 -0.7451483  0.0062189  -119.819  &lt; 2e-16 ***
DESTIN_SZJWSZ07 -2.8453099  0.0287335   -99.024  &lt; 2e-16 ***
DESTIN_SZJWSZ08 -0.3372309  0.0058003   -58.141  &lt; 2e-16 ***
DESTIN_SZJWSZ09  1.0505330  0.0045908   228.832  &lt; 2e-16 ***
DESTIN_SZKLSZ01 -0.2334836  0.0057970   -40.277  &lt; 2e-16 ***
DESTIN_SZKLSZ02 -0.5416148  0.0061432   -88.164  &lt; 2e-16 ***
DESTIN_SZKLSZ03 -0.8026495  0.0068745  -116.757  &lt; 2e-16 ***
DESTIN_SZKLSZ04 -1.2918594  0.0090197  -143.227  &lt; 2e-16 ***
DESTIN_SZKLSZ05 -0.4069101  0.0087812   -46.339  &lt; 2e-16 ***
DESTIN_SZKLSZ06 -2.5333101  0.0363215   -69.747  &lt; 2e-16 ***
DESTIN_SZKLSZ07 -0.6623343  0.0070761   -93.601  &lt; 2e-16 ***
DESTIN_SZKLSZ08 -0.1408205  0.0054965   -25.620  &lt; 2e-16 ***
DESTIN_SZLKSZ01 -1.2639235  0.0208254   -60.691  &lt; 2e-16 ***
DESTIN_SZMDSZ01 -1.5655800  0.0202787   -77.203  &lt; 2e-16 ***
DESTIN_SZMDSZ02 -0.9767682  0.0114687   -85.168  &lt; 2e-16 ***
DESTIN_SZMDSZ03 -3.3328109  0.0254294  -131.061  &lt; 2e-16 ***
DESTIN_SZMPSZ01 -0.4552859  0.0080666   -56.441  &lt; 2e-16 ***
DESTIN_SZMPSZ02 -0.5386560  0.0064620   -83.358  &lt; 2e-16 ***
DESTIN_SZMPSZ03  0.4952000  0.0052295    94.694  &lt; 2e-16 ***
DESTIN_SZMUSZ02 -1.4434175  0.0202509   -71.277  &lt; 2e-16 ***
DESTIN_SZNTSZ01 -2.9194067  0.0449654   -64.926  &lt; 2e-16 ***
DESTIN_SZNTSZ02 -1.3780179  0.0112867  -122.092  &lt; 2e-16 ***
DESTIN_SZNTSZ03 -0.5044699  0.0080449   -62.707  &lt; 2e-16 ***
DESTIN_SZNTSZ05 -2.0017134  0.0258750   -77.361  &lt; 2e-16 ***
DESTIN_SZNTSZ06 -3.8120537  0.0434271   -87.781  &lt; 2e-16 ***
DESTIN_SZNVSZ01 -0.1071506  0.0051026   -20.999  &lt; 2e-16 ***
DESTIN_SZNVSZ02 -0.0274710  0.0057611    -4.768 1.86e-06 ***
DESTIN_SZNVSZ03  0.1076352  0.0057909    18.587  &lt; 2e-16 ***
DESTIN_SZNVSZ04 -1.2087250  0.0110438  -109.448  &lt; 2e-16 ***
DESTIN_SZNVSZ05 -1.0058290  0.0092167  -109.131  &lt; 2e-16 ***
DESTIN_SZPGSZ01 -1.2029931  0.0163170   -73.726  &lt; 2e-16 ***
DESTIN_SZPGSZ02 -1.2878671  0.0074139  -173.709  &lt; 2e-16 ***
DESTIN_SZPGSZ03 -0.1520894  0.0048629   -31.275  &lt; 2e-16 ***
DESTIN_SZPGSZ04 -0.1985959  0.0050374   -39.424  &lt; 2e-16 ***
DESTIN_SZPGSZ05 -1.5290983  0.0082617  -185.083  &lt; 2e-16 ***
DESTIN_SZPLSZ01 -0.3567934  0.0074298   -48.022  &lt; 2e-16 ***
DESTIN_SZPLSZ02 -1.7114351  0.0134462  -127.280  &lt; 2e-16 ***
DESTIN_SZPLSZ03 -0.3241427  0.0098895   -32.776  &lt; 2e-16 ***
DESTIN_SZPLSZ04 -1.7117196  0.0119003  -143.838  &lt; 2e-16 ***
DESTIN_SZPLSZ05 -0.5086379  0.0120051   -42.368  &lt; 2e-16 ***
DESTIN_SZPNSZ01  0.2026781  0.0068977    29.383  &lt; 2e-16 ***
DESTIN_SZPNSZ02  0.8313754  0.0078544   105.848  &lt; 2e-16 ***
DESTIN_SZPNSZ03 -0.4041254  0.0086586   -46.673  &lt; 2e-16 ***
DESTIN_SZPNSZ04  1.5814539  0.0093641   168.885  &lt; 2e-16 ***
DESTIN_SZPNSZ05  1.1823430  0.0129843    91.059  &lt; 2e-16 ***
DESTIN_SZPRSZ01 -1.1057553  0.0088197  -125.374  &lt; 2e-16 ***
DESTIN_SZPRSZ02  0.0895099  0.0056308    15.897  &lt; 2e-16 ***
DESTIN_SZPRSZ03  0.6921925  0.0043977   157.397  &lt; 2e-16 ***
DESTIN_SZPRSZ04 -0.2848336  0.0084725   -33.619  &lt; 2e-16 ***
DESTIN_SZPRSZ05  0.1744480  0.0053553    32.575  &lt; 2e-16 ***
DESTIN_SZPRSZ06  0.4279206  0.0058735    72.856  &lt; 2e-16 ***
DESTIN_SZPRSZ07 -1.5123108  0.0124303  -121.664  &lt; 2e-16 ***
DESTIN_SZPRSZ08 -0.5650226  0.0068530   -82.449  &lt; 2e-16 ***
DESTIN_SZQTSZ01 -0.5952360  0.0090505   -65.769  &lt; 2e-16 ***
DESTIN_SZQTSZ02 -0.7728170  0.0078910   -97.937  &lt; 2e-16 ***
DESTIN_SZQTSZ03 -0.5066812  0.0073996   -68.474  &lt; 2e-16 ***
DESTIN_SZQTSZ04 -0.6398414  0.0075411   -84.847  &lt; 2e-16 ***
DESTIN_SZQTSZ05 -0.4354527  0.0069345   -62.795  &lt; 2e-16 ***
DESTIN_SZQTSZ06 -0.6597391  0.0071919   -91.733  &lt; 2e-16 ***
DESTIN_SZQTSZ07 -0.9392696  0.0112518   -83.477  &lt; 2e-16 ***
DESTIN_SZQTSZ08  0.4617774  0.0057011    80.998  &lt; 2e-16 ***
DESTIN_SZQTSZ09 -0.3174497  0.0065890   -48.178  &lt; 2e-16 ***
DESTIN_SZQTSZ10  0.1993449  0.0059923    33.267  &lt; 2e-16 ***
DESTIN_SZQTSZ11  0.2551535  0.0061885    41.230  &lt; 2e-16 ***
DESTIN_SZQTSZ12 -0.1662603  0.0086701   -19.176  &lt; 2e-16 ***
DESTIN_SZQTSZ13  0.5500978  0.0063091    87.192  &lt; 2e-16 ***
DESTIN_SZQTSZ14  0.5364435  0.0070157    76.463  &lt; 2e-16 ***
DESTIN_SZQTSZ15  1.3611043  0.0081643   166.715  &lt; 2e-16 ***
DESTIN_SZRCSZ01 -0.1034049  0.0076769   -13.470  &lt; 2e-16 ***
DESTIN_SZRCSZ06 -1.0633902  0.0189846   -56.013  &lt; 2e-16 ***
DESTIN_SZRVSZ01 -1.5486221  0.0165272   -93.701  &lt; 2e-16 ***
DESTIN_SZRVSZ02 -2.4092611  0.0326906   -73.699  &lt; 2e-16 ***
DESTIN_SZRVSZ03 -1.5172079  0.0139258  -108.950  &lt; 2e-16 ***
DESTIN_SZRVSZ04 -1.1663615  0.0157430   -74.088  &lt; 2e-16 ***
DESTIN_SZRVSZ05 -2.2404292  0.0281339   -79.634  &lt; 2e-16 ***
DESTIN_SZSBSZ01 -1.3783780  0.0096022  -143.549  &lt; 2e-16 ***
DESTIN_SZSBSZ02 -1.4445213  0.0081630  -176.959  &lt; 2e-16 ***
DESTIN_SZSBSZ03  0.5149906  0.0051663    99.683  &lt; 2e-16 ***
DESTIN_SZSBSZ04  0.2389086  0.0060765    39.317  &lt; 2e-16 ***
DESTIN_SZSBSZ05 -1.2737442  0.0082818  -153.801  &lt; 2e-16 ***
DESTIN_SZSBSZ06 -1.8683520  0.0227277   -82.206  &lt; 2e-16 ***
DESTIN_SZSBSZ07 -0.5993154  0.0184895   -32.414  &lt; 2e-16 ***
DESTIN_SZSBSZ08  0.8156302  0.0059840   136.302  &lt; 2e-16 ***
DESTIN_SZSBSZ09  0.0900611  0.0057054    15.785  &lt; 2e-16 ***
DESTIN_SZSESZ02 -0.6397704  0.0052491  -121.882  &lt; 2e-16 ***
DESTIN_SZSESZ03  0.1714103  0.0042357    40.468  &lt; 2e-16 ***
DESTIN_SZSESZ04 -1.0596175  0.0059865  -177.002  &lt; 2e-16 ***
DESTIN_SZSESZ05 -0.8071891  0.0051229  -157.566  &lt; 2e-16 ***
DESTIN_SZSESZ06 -0.5580934  0.0066216   -84.284  &lt; 2e-16 ***
DESTIN_SZSESZ07 -3.1448863  0.0227788  -138.062  &lt; 2e-16 ***
DESTIN_SZSGSZ01 -0.1795225  0.0060127   -29.857  &lt; 2e-16 ***
DESTIN_SZSGSZ02 -0.2986570  0.0053561   -55.760  &lt; 2e-16 ***
DESTIN_SZSGSZ03 -0.4074671  0.0050609   -80.513  &lt; 2e-16 ***
DESTIN_SZSGSZ04 -0.1505164  0.0050931   -29.553  &lt; 2e-16 ***
DESTIN_SZSGSZ05 -1.9908372  0.0101448  -196.242  &lt; 2e-16 ***
DESTIN_SZSGSZ06  0.6715268  0.0041161   163.148  &lt; 2e-16 ***
DESTIN_SZSGSZ07 -0.4494757  0.0055319   -81.252  &lt; 2e-16 ***
DESTIN_SZSISZ01 -0.5517983  0.0261860   -21.072  &lt; 2e-16 ***
DESTIN_SZSKSZ01 -0.4749154  0.0079257   -59.921  &lt; 2e-16 ***
DESTIN_SZSKSZ02  0.9400302  0.0057218   164.290  &lt; 2e-16 ***
DESTIN_SZSKSZ03 -0.2800377  0.0066081   -42.378  &lt; 2e-16 ***
DESTIN_SZSKSZ04 -1.2570212  0.0145351   -86.482  &lt; 2e-16 ***
DESTIN_SZSKSZ05 -0.2600474  0.0112800   -23.054  &lt; 2e-16 ***
DESTIN_SZSLSZ01 -0.7775604  0.0085818   -90.606  &lt; 2e-16 ***
DESTIN_SZSLSZ04 -0.8586515  0.0073142  -117.396  &lt; 2e-16 ***
DESTIN_SZSRSZ01 -1.1370887  0.0142148   -79.993  &lt; 2e-16 ***
DESTIN_SZTHSZ01 -4.3259988  0.0368554  -117.378  &lt; 2e-16 ***
DESTIN_SZTHSZ03 -2.6632914  0.0252720  -105.385  &lt; 2e-16 ***
DESTIN_SZTHSZ04 -3.1000906  0.0216372  -143.276  &lt; 2e-16 ***
DESTIN_SZTHSZ06 -2.5952642  0.0156340  -166.001  &lt; 2e-16 ***
DESTIN_SZTMSZ01 -0.2092828  0.0059257   -35.318  &lt; 2e-16 ***
DESTIN_SZTMSZ02  1.8238139  0.0039155   465.798  &lt; 2e-16 ***
DESTIN_SZTMSZ03  0.8518259  0.0043636   195.210  &lt; 2e-16 ***
DESTIN_SZTMSZ04  1.0222812  0.0043466   235.191  &lt; 2e-16 ***
DESTIN_SZTMSZ05  0.6323777  0.0060058   105.294  &lt; 2e-16 ***
DESTIN_SZTNSZ01 -0.3336078  0.0074388   -44.847  &lt; 2e-16 ***
DESTIN_SZTNSZ02 -1.0820469  0.0101689  -106.408  &lt; 2e-16 ***
DESTIN_SZTNSZ03 -1.4186505  0.0119906  -118.313  &lt; 2e-16 ***
DESTIN_SZTNSZ04 -0.3058199  0.0074743   -40.916  &lt; 2e-16 ***
DESTIN_SZTPSZ01 -0.4872299  0.0061571   -79.133  &lt; 2e-16 ***
DESTIN_SZTPSZ02  0.7158441  0.0041312   173.278  &lt; 2e-16 ***
DESTIN_SZTPSZ03 -0.4314229  0.0059917   -72.004  &lt; 2e-16 ***
DESTIN_SZTPSZ04 -1.5898245  0.0076083  -208.959  &lt; 2e-16 ***
DESTIN_SZTPSZ05 -1.0445550  0.0062363  -167.497  &lt; 2e-16 ***
DESTIN_SZTPSZ06 -0.4319582  0.0070100   -61.621  &lt; 2e-16 ***
DESTIN_SZTPSZ07 -2.1602303  0.0120352  -179.493  &lt; 2e-16 ***
DESTIN_SZTPSZ08 -1.1920493  0.0093083  -128.063  &lt; 2e-16 ***
DESTIN_SZTPSZ09 -0.2022481  0.0071137   -28.431  &lt; 2e-16 ***
DESTIN_SZTPSZ10 -1.2464793  0.0090124  -138.308  &lt; 2e-16 ***
DESTIN_SZTPSZ11 -0.0808445  0.0056019   -14.432  &lt; 2e-16 ***
DESTIN_SZTPSZ12 -0.6784376  0.0066340  -102.267  &lt; 2e-16 ***
DESTIN_SZTSSZ01 -1.5845062  0.0222086   -71.346  &lt; 2e-16 ***
DESTIN_SZTSSZ02 -0.1886010  0.0146338   -12.888  &lt; 2e-16 ***
DESTIN_SZTSSZ03  0.6525526  0.0092450    70.585  &lt; 2e-16 ***
DESTIN_SZTSSZ04  0.5285464  0.0100182    52.759  &lt; 2e-16 ***
DESTIN_SZTSSZ05  1.4670106  0.0104357   140.577  &lt; 2e-16 ***
DESTIN_SZTSSZ06  2.5043588  0.0167444   149.564  &lt; 2e-16 ***
DESTIN_SZWCSZ01  1.9787931  0.0054306   364.375  &lt; 2e-16 ***
DESTIN_SZWCSZ02 -2.2593108  0.0127916  -176.624  &lt; 2e-16 ***
DESTIN_SZWCSZ03 -3.1897655  0.0326927   -97.568  &lt; 2e-16 ***
DESTIN_SZWDSZ01  1.0476108  0.0044629   234.738  &lt; 2e-16 ***
DESTIN_SZWDSZ02 -1.3176990  0.0065894  -199.973  &lt; 2e-16 ***
DESTIN_SZWDSZ03  0.3432057  0.0052496    65.377  &lt; 2e-16 ***
DESTIN_SZWDSZ04 -0.7895927  0.0073392  -107.586  &lt; 2e-16 ***
DESTIN_SZWDSZ05 -0.8751665  0.0072946  -119.975  &lt; 2e-16 ***
DESTIN_SZWDSZ06 -0.2106221  0.0053027   -39.720  &lt; 2e-16 ***
DESTIN_SZWDSZ07 -1.6050834  0.0071754  -223.692  &lt; 2e-16 ***
DESTIN_SZWDSZ08 -0.5124717  0.0069223   -74.032  &lt; 2e-16 ***
DESTIN_SZWDSZ09  0.3813542  0.0054697    69.721  &lt; 2e-16 ***
DESTIN_SZYSSZ01  0.0853753  0.0046572    18.332  &lt; 2e-16 ***
DESTIN_SZYSSZ02 -0.3227172  0.0057351   -56.271  &lt; 2e-16 ***
DESTIN_SZYSSZ03 -0.4151283  0.0066299   -62.615  &lt; 2e-16 ***
DESTIN_SZYSSZ04 -0.4637327  0.0058206   -79.671  &lt; 2e-16 ***
DESTIN_SZYSSZ05 -1.5888242  0.0111001  -143.136  &lt; 2e-16 ***
DESTIN_SZYSSZ06 -1.4606209  0.0107759  -135.545  &lt; 2e-16 ***
DESTIN_SZYSSZ07 -0.7839065  0.0144357   -54.304  &lt; 2e-16 ***
DESTIN_SZYSSZ08  0.6265412  0.0045504   137.691  &lt; 2e-16 ***
DESTIN_SZYSSZ09  0.1520067  0.0048092    31.607  &lt; 2e-16 ***
log(dist)       -1.8468315  0.0004608 -4008.033  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 47094011  on 14470  degrees of freedom
Residual deviance: 10420261  on 13912  degrees of freedom
AIC: 10510518

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p><img src="dbcSIM_Poisson.png" width="324" height="23"></p>
<p>(β=−1.8468315) indicates a negative exponential relationship between distance and the phenomenon being modeled.</p>
<p>The negative sign suggests a decrease in the phenomenon as distance increases. In other words, the phenomenon tends to diminish or decay as you move farther away from a certain point.</p>
<p>The magnitude of the value indicates the rate of decay. In your case, a larger negative value (β) suggests a faster decay—meaning the effect diminishes rapidly with distance.</p>
<section id="goodness-of-fit-1" class="level4">
<h4 class="anchored" data-anchor-id="goodness-of-fit-1">Goodness of fit</h4>
<p>In statistical modelling, the next question we would like to answer is how well the proportion of variance in the dependent variable (i.e.&nbsp;TRIPS) that can be explained by the explanatory variables.</p>
<p>In order to provide answer to this question, R-squared statistics will be used. However, R-squared is not an output of glm(). Hence we will write a function called CalcRSquared by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>CalcRSquared <span class="ot">&lt;-</span> <span class="cf">function</span>(observed, estimated){</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">cor</span>(observed, estimated)</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>  R2 <span class="ot">&lt;-</span> r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>  R2</span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, we can examine how the constraints hold for destinations this time.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(orcSIM_Poisson<span class="sc">$</span>data<span class="sc">$</span>TRIPS, orcSIM_Poisson<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.442874</code></pre>
</div>
</div>
<p>With reference to the R-Squared above, we can conclude that the model accounts for about 44% of the variation of flows in the systems. Not bad, but not brilliant either.</p>
<p>Next, let us examine how well the proportion of variance in the dependent variable (i.e.&nbsp;TRIPS) that can be explained by the explanatory variables.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(dbcSIM_Poisson<span class="sc">$</span>data<span class="sc">$</span>TRIPS,</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>             dbcSIM_Poisson<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7001882</code></pre>
</div>
</div>
<p>Notice that there is a relatively greater improvement in the R-Squared value.</p>
</section>
</section>
</section>
<section id="model-comparison-1" class="level2">
<h2 class="anchored" data-anchor-id="model-comparison-1">19 Model comparison</h2>
<section id="statistical-measures" class="level3">
<h3 class="anchored" data-anchor-id="statistical-measures">Statistical measures</h3>
<p>Another useful model performance measure for continuous dependent variable is Root Mean Squared Error. In this sub-section, you will learn how to use compare_performance() of performance package</p>
<p>First of all, let us create a list called model_list by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>model_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Origin_Constrained =</span> orcSIM_Poisson,</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Doubly_Constrained =</span> dbcSIM_Poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will compute the RMSE of all the models in model_list file by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(model_list,</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="st">"RMSE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name               | Model |     RMSE
-------------------------------------
Origin_Constrained |   glm | 2597.617
Doubly_Constrained |   glm | 1906.694</code></pre>
</div>
</div>
<p>The print above reveals that doubly constrained SIM is the best model among the two SIMs because it has the smallest RMSE value of 1906.694.</p>
</section>
<section id="visualising-fitted-values" class="level3">
<h3 class="anchored" data-anchor-id="visualising-fitted-values">Visualising fitted values</h3>
<p>In this section, you will learn how to visualise the observed values and the fitted values.</p>
<p>Firstly we will extract the fitted values from Origin-constrained Model by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(orcSIM_Poisson<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will append the fitted values into inter_zonal_flow data frame by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>inter_zonal_flow <span class="ot">&lt;-</span> inter_zonal_flow <span class="sc">%&gt;%</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">orcTRIPS =</span> <span class="st">"orcSIM_Poisson.fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dbcSIM_Poisson<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>inter_zonal_flow <span class="ot">&lt;-</span> inter_zonal_flow <span class="sc">%&gt;%</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dbcTRIPS =</span> <span class="st">"dbcSIM_Poisson.fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, two scatterplots will be created by using geom_point() and other appropriate functions of ggplot2 package.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>orc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> inter_zonal_flow,</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> orcTRIPS,</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm) <span class="sc">+</span></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">150000</span>),</span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">150000</span>))</span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a>dbc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> inter_zonal_flow,</span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> dbcTRIPS,</span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm) <span class="sc">+</span></span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">150000</span>),</span>
<span id="cb189-15"><a href="#cb189-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">150000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, we will put all the graphs into a single visual for better comparison by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(orc_p, dbc_p,</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-130-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Observation: There is still one outlier. By removing the outlier, the result could change as the line could either become less steep or steeper.</p>
</section>
</section>
<section id="identify-outlier" class="level2">
<h2 class="anchored" data-anchor-id="identify-outlier">20 Identify Outlier</h2>
<p><img src="Outlier.png" class="img-fluid" width="523"></p>
<p>Remove the outlier under Row 7569.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>inter_zonal_flow <span class="ot">&lt;-</span> inter_zonal_flow[<span class="sc">-</span><span class="dv">7569</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="re-calibrating-spatial-interaction-models-schoolbusiness" class="level2">
<h2 class="anchored" data-anchor-id="re-calibrating-spatial-interaction-models-schoolbusiness">21 Re-Calibrating Spatial Interaction Models (School/Business)</h2>
<section id="origin--production--constrained-model-1" class="level3">
<h3 class="anchored" data-anchor-id="origin--production--constrained-model-1">Origin- (Production-) constrained Model</h3>
<p>Figure below shows the general formula of the origin-constrained model.</p>
<p><img src="Formula.jpg" class="img-fluid" width="269"></p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>orcSIM_Poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>                ORIGIN_SZ <span class="sc">+</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(SCHOOL_COUNT) <span class="sc">+</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(BUSINESS_COUNT) <span class="sc">+</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> inter_zonal_flow,</span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(orcSIM_Poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ ORIGIN_SZ + log(SCHOOL_COUNT) + log(BUSINESS_COUNT) + 
    log(dist) - 1, family = poisson(link = "log"), data = inter_zonal_flow, 
    na.action = na.exclude)

Coefficients:
                     Estimate Std. Error  z value Pr(&gt;|z|)    
ORIGIN_SZAMSZ01     13.669109   0.007515  1818.87   &lt;2e-16 ***
ORIGIN_SZAMSZ02     14.326012   0.007298  1963.05   &lt;2e-16 ***
ORIGIN_SZAMSZ03     13.874078   0.007521  1844.73   &lt;2e-16 ***
ORIGIN_SZAMSZ04     13.515938   0.007731  1748.32   &lt;2e-16 ***
ORIGIN_SZAMSZ05     13.441985   0.008143  1650.68   &lt;2e-16 ***
ORIGIN_SZAMSZ06     13.775797   0.007603  1811.91   &lt;2e-16 ***
ORIGIN_SZAMSZ07     12.256151   0.011411  1074.04   &lt;2e-16 ***
ORIGIN_SZAMSZ08     12.508994   0.011049  1132.17   &lt;2e-16 ***
ORIGIN_SZAMSZ09     13.768281   0.007909  1740.79   &lt;2e-16 ***
ORIGIN_SZAMSZ10     14.019300   0.007454  1880.82   &lt;2e-16 ***
ORIGIN_SZAMSZ11     12.053692   0.014281   844.02   &lt;2e-16 ***
ORIGIN_SZAMSZ12     12.002456   0.012504   959.92   &lt;2e-16 ***
ORIGIN_SZBDSZ01     14.487083   0.007671  1888.57   &lt;2e-16 ***
ORIGIN_SZBDSZ02     13.955863   0.008119  1719.01   &lt;2e-16 ***
ORIGIN_SZBDSZ03     14.269071   0.007793  1830.95   &lt;2e-16 ***
ORIGIN_SZBDSZ04     15.082914   0.007457  2022.77   &lt;2e-16 ***
ORIGIN_SZBDSZ05     14.115364   0.007904  1785.76   &lt;2e-16 ***
ORIGIN_SZBDSZ06     14.343305   0.007905  1814.45   &lt;2e-16 ***
ORIGIN_SZBDSZ07     12.685334   0.011585  1095.01   &lt;2e-16 ***
ORIGIN_SZBDSZ08     12.708719   0.011076  1147.36   &lt;2e-16 ***
ORIGIN_SZBKSZ01     12.963425   0.008932  1451.36   &lt;2e-16 ***
ORIGIN_SZBKSZ02     13.850000   0.007736  1790.28   &lt;2e-16 ***
ORIGIN_SZBKSZ03     13.987895   0.007645  1829.60   &lt;2e-16 ***
ORIGIN_SZBKSZ04     13.207361   0.008467  1559.93   &lt;2e-16 ***
ORIGIN_SZBKSZ05     13.031111   0.008897  1464.59   &lt;2e-16 ***
ORIGIN_SZBKSZ06     13.509092   0.008079  1672.06   &lt;2e-16 ***
ORIGIN_SZBKSZ07     14.162741   0.007281  1945.27   &lt;2e-16 ***
ORIGIN_SZBKSZ08     13.635249   0.007793  1749.72   &lt;2e-16 ***
ORIGIN_SZBKSZ09     13.431641   0.008211  1635.72   &lt;2e-16 ***
ORIGIN_SZBLSZ01     11.647955   0.016132   722.02   &lt;2e-16 ***
ORIGIN_SZBLSZ02     11.404752   0.020172   565.38   &lt;2e-16 ***
ORIGIN_SZBLSZ03     10.364555   0.046539   222.71   &lt;2e-16 ***
ORIGIN_SZBLSZ04     11.678106   0.024106   484.45   &lt;2e-16 ***
ORIGIN_SZBMSZ01     13.743173   0.007978  1722.75   &lt;2e-16 ***
ORIGIN_SZBMSZ02     12.617440   0.008746  1442.65   &lt;2e-16 ***
ORIGIN_SZBMSZ03     13.395900   0.007821  1712.81   &lt;2e-16 ***
ORIGIN_SZBMSZ04     13.674796   0.007305  1872.09   &lt;2e-16 ***
ORIGIN_SZBMSZ05     11.076332   0.017737   624.47   &lt;2e-16 ***
ORIGIN_SZBMSZ06     11.073005   0.019015   582.33   &lt;2e-16 ***
ORIGIN_SZBMSZ07     13.108296   0.008070  1624.28   &lt;2e-16 ***
ORIGIN_SZBMSZ08     13.268123   0.007830  1694.43   &lt;2e-16 ***
ORIGIN_SZBMSZ09     12.808319   0.010242  1250.53   &lt;2e-16 ***
ORIGIN_SZBMSZ10     12.477193   0.010456  1193.29   &lt;2e-16 ***
ORIGIN_SZBMSZ11     12.887491   0.008458  1523.78   &lt;2e-16 ***
ORIGIN_SZBMSZ12     12.726426   0.010879  1169.83   &lt;2e-16 ***
ORIGIN_SZBMSZ13     13.514153   0.008189  1650.29   &lt;2e-16 ***
ORIGIN_SZBMSZ14     13.267019   0.008379  1583.35   &lt;2e-16 ***
ORIGIN_SZBMSZ15     13.423788   0.008093  1658.76   &lt;2e-16 ***
ORIGIN_SZBMSZ16     12.415650   0.010838  1145.55   &lt;2e-16 ***
ORIGIN_SZBMSZ17     11.749029   0.016964   692.60   &lt;2e-16 ***
ORIGIN_SZBPSZ01     13.918774   0.007912  1759.19   &lt;2e-16 ***
ORIGIN_SZBPSZ02     13.592443   0.008410  1616.25   &lt;2e-16 ***
ORIGIN_SZBPSZ03     13.623409   0.008337  1634.11   &lt;2e-16 ***
ORIGIN_SZBPSZ04     13.963977   0.007771  1796.87   &lt;2e-16 ***
ORIGIN_SZBPSZ05     14.055438   0.007434  1890.80   &lt;2e-16 ***
ORIGIN_SZBPSZ06     12.311343   0.011186  1100.63   &lt;2e-16 ***
ORIGIN_SZBPSZ07     12.586861   0.010922  1152.46   &lt;2e-16 ***
ORIGIN_SZBSSZ01     13.429024   0.008396  1599.51   &lt;2e-16 ***
ORIGIN_SZBSSZ02     13.863321   0.007647  1812.80   &lt;2e-16 ***
ORIGIN_SZBSSZ03     13.248987   0.007985  1659.26   &lt;2e-16 ***
ORIGIN_SZBTSZ01     13.348274   0.008611  1550.14   &lt;2e-16 ***
ORIGIN_SZBTSZ02     12.557463   0.010364  1211.62   &lt;2e-16 ***
ORIGIN_SZBTSZ03     12.903233   0.009307  1386.47   &lt;2e-16 ***
ORIGIN_SZBTSZ04     12.399043   0.011963  1036.48   &lt;2e-16 ***
ORIGIN_SZBTSZ05     12.060894   0.013659   883.02   &lt;2e-16 ***
ORIGIN_SZBTSZ06     12.217232   0.011261  1084.87   &lt;2e-16 ***
ORIGIN_SZBTSZ07     11.093165   0.015423   719.28   &lt;2e-16 ***
ORIGIN_SZBTSZ08     12.434431   0.012464   997.63   &lt;2e-16 ***
ORIGIN_SZCBSZ01     10.881843   0.055296   196.79   &lt;2e-16 ***
ORIGIN_SZCCSZ01     11.635695   0.015571   747.27   &lt;2e-16 ***
ORIGIN_SZCHSZ01     13.095147   0.013636   960.33   &lt;2e-16 ***
ORIGIN_SZCHSZ02     13.231032   0.010121  1307.28   &lt;2e-16 ***
ORIGIN_SZCHSZ03     14.069851   0.009373  1501.07   &lt;2e-16 ***
ORIGIN_SZCKSZ01     13.696622   0.007736  1770.40   &lt;2e-16 ***
ORIGIN_SZCKSZ02     14.036381   0.007826  1793.59   &lt;2e-16 ***
ORIGIN_SZCKSZ03     14.345239   0.007283  1969.67   &lt;2e-16 ***
ORIGIN_SZCKSZ04     14.845529   0.007427  1998.80   &lt;2e-16 ***
ORIGIN_SZCKSZ05     14.593898   0.007703  1894.61   &lt;2e-16 ***
ORIGIN_SZCKSZ06     13.864939   0.009347  1483.38   &lt;2e-16 ***
ORIGIN_SZCLSZ01     12.828708   0.009832  1304.84   &lt;2e-16 ***
ORIGIN_SZCLSZ02     12.073755   0.014857   812.67   &lt;2e-16 ***
ORIGIN_SZCLSZ03     12.697179   0.010016  1267.70   &lt;2e-16 ***
ORIGIN_SZCLSZ04     14.345334   0.007345  1953.05   &lt;2e-16 ***
ORIGIN_SZCLSZ05     11.993309   0.015823   757.99   &lt;2e-16 ***
ORIGIN_SZCLSZ06     14.524604   0.007112  2042.27   &lt;2e-16 ***
ORIGIN_SZCLSZ07     13.366012   0.008040  1662.43   &lt;2e-16 ***
ORIGIN_SZCLSZ08     13.890809   0.008194  1695.23   &lt;2e-16 ***
ORIGIN_SZCLSZ09     12.255433   0.017605   696.13   &lt;2e-16 ***
ORIGIN_SZDTSZ02      9.606665   0.083615   114.89   &lt;2e-16 ***
ORIGIN_SZDTSZ03     10.381102   0.073995   140.29   &lt;2e-16 ***
ORIGIN_SZDTSZ13     10.598486   0.031812   333.16   &lt;2e-16 ***
ORIGIN_SZGLSZ01     12.082608   0.011278  1071.32   &lt;2e-16 ***
ORIGIN_SZGLSZ02     13.739544   0.007781  1765.81   &lt;2e-16 ***
ORIGIN_SZGLSZ03     13.448466   0.008170  1645.99   &lt;2e-16 ***
ORIGIN_SZGLSZ04     14.354089   0.007420  1934.45   &lt;2e-16 ***
ORIGIN_SZGLSZ05     14.190400   0.007597  1867.97   &lt;2e-16 ***
ORIGIN_SZHGSZ01     13.857332   0.007392  1874.64   &lt;2e-16 ***
ORIGIN_SZHGSZ02     14.032802   0.007366  1905.06   &lt;2e-16 ***
ORIGIN_SZHGSZ03     13.721782   0.007759  1768.57   &lt;2e-16 ***
ORIGIN_SZHGSZ04     14.493820   0.007143  2029.11   &lt;2e-16 ***
ORIGIN_SZHGSZ05     14.719762   0.007154  2057.61   &lt;2e-16 ***
ORIGIN_SZHGSZ06     13.300639   0.008162  1629.68   &lt;2e-16 ***
ORIGIN_SZHGSZ07     13.948331   0.007579  1840.43   &lt;2e-16 ***
ORIGIN_SZHGSZ08     13.557335   0.008080  1677.91   &lt;2e-16 ***
ORIGIN_SZHGSZ09     12.543305   0.008858  1416.04   &lt;2e-16 ***
ORIGIN_SZHGSZ10     10.691891   0.042513   251.50   &lt;2e-16 ***
ORIGIN_SZJESZ01     13.919191   0.007553  1842.80   &lt;2e-16 ***
ORIGIN_SZJESZ02     13.810745   0.007517  1837.24   &lt;2e-16 ***
ORIGIN_SZJESZ03     13.754274   0.007707  1784.66   &lt;2e-16 ***
ORIGIN_SZJESZ04     12.161917   0.011611  1047.47   &lt;2e-16 ***
ORIGIN_SZJESZ05     11.530671   0.015114   762.91   &lt;2e-16 ***
ORIGIN_SZJESZ06     13.977956   0.007313  1911.25   &lt;2e-16 ***
ORIGIN_SZJESZ07     11.876437   0.013132   904.41   &lt;2e-16 ***
ORIGIN_SZJESZ08     12.279478   0.013270   925.33   &lt;2e-16 ***
ORIGIN_SZJESZ09     14.174712   0.007806  1815.85   &lt;2e-16 ***
ORIGIN_SZJESZ10     12.128467   0.020111   603.07   &lt;2e-16 ***
ORIGIN_SZJESZ11     11.812134   0.020696   570.74   &lt;2e-16 ***
ORIGIN_SZJWSZ01     13.823704   0.008893  1554.49   &lt;2e-16 ***
ORIGIN_SZJWSZ02     14.491330   0.007349  1971.93   &lt;2e-16 ***
ORIGIN_SZJWSZ03     14.734976   0.007306  2016.94   &lt;2e-16 ***
ORIGIN_SZJWSZ04     14.181923   0.007591  1868.29   &lt;2e-16 ***
ORIGIN_SZJWSZ05     11.861817   0.014214   834.52   &lt;2e-16 ***
ORIGIN_SZJWSZ06     12.418411   0.012373  1003.66   &lt;2e-16 ***
ORIGIN_SZJWSZ07     11.183939   0.028400   393.80   &lt;2e-16 ***
ORIGIN_SZJWSZ08     14.603008   0.007921  1843.52   &lt;2e-16 ***
ORIGIN_SZJWSZ09     15.404148   0.006934  2221.39   &lt;2e-16 ***
ORIGIN_SZKLSZ01     13.832869   0.007643  1809.82   &lt;2e-16 ***
ORIGIN_SZKLSZ02     13.064172   0.008542  1529.48   &lt;2e-16 ***
ORIGIN_SZKLSZ03     13.306171   0.008179  1626.96   &lt;2e-16 ***
ORIGIN_SZKLSZ04     11.637103   0.013331   872.93   &lt;2e-16 ***
ORIGIN_SZKLSZ05     12.367057   0.012362  1000.41   &lt;2e-16 ***
ORIGIN_SZKLSZ06      7.980405   0.185804    42.95   &lt;2e-16 ***
ORIGIN_SZKLSZ07     12.732175   0.010231  1244.45   &lt;2e-16 ***
ORIGIN_SZKLSZ08     11.974599   0.011720  1021.77   &lt;2e-16 ***
ORIGIN_SZLKSZ01     10.739976   0.040324   266.35   &lt;2e-16 ***
ORIGIN_SZMDSZ01     11.339398   0.029385   385.89   &lt;2e-16 ***
ORIGIN_SZMDSZ02     12.327618   0.012169  1013.03   &lt;2e-16 ***
ORIGIN_SZMDSZ03     11.504366   0.017994   639.35   &lt;2e-16 ***
ORIGIN_SZMPSZ01     12.660301   0.010453  1211.21   &lt;2e-16 ***
ORIGIN_SZMPSZ02     12.991374   0.009226  1408.17   &lt;2e-16 ***
ORIGIN_SZMPSZ03     13.720605   0.008207  1671.90   &lt;2e-16 ***
ORIGIN_SZMUSZ02     10.484215   0.103879   100.93   &lt;2e-16 ***
ORIGIN_SZNTSZ01     10.855747   0.035723   303.89   &lt;2e-16 ***
ORIGIN_SZNTSZ02     10.515585   0.024035   437.51   &lt;2e-16 ***
ORIGIN_SZNTSZ03     12.988055   0.009447  1374.76   &lt;2e-16 ***
ORIGIN_SZNTSZ05     10.552017   0.049850   211.68   &lt;2e-16 ***
ORIGIN_SZNTSZ06      9.832891   0.055949   175.75   &lt;2e-16 ***
ORIGIN_SZNVSZ01     13.979136   0.007381  1893.84   &lt;2e-16 ***
ORIGIN_SZNVSZ02     13.021250   0.008790  1481.36   &lt;2e-16 ***
ORIGIN_SZNVSZ03     12.499585   0.010094  1238.31   &lt;2e-16 ***
ORIGIN_SZNVSZ04     12.315526   0.011014  1118.17   &lt;2e-16 ***
ORIGIN_SZNVSZ05     10.988660   0.017942   612.46   &lt;2e-16 ***
ORIGIN_SZPGSZ01     13.029057   0.013661   953.75   &lt;2e-16 ***
ORIGIN_SZPGSZ02     12.956228   0.009537  1358.47   &lt;2e-16 ***
ORIGIN_SZPGSZ03     14.011066   0.007653  1830.76   &lt;2e-16 ***
ORIGIN_SZPGSZ04     14.542239   0.007410  1962.63   &lt;2e-16 ***
ORIGIN_SZPGSZ05     13.762046   0.008408  1636.88   &lt;2e-16 ***
ORIGIN_SZPLSZ01     12.669900   0.013501   938.42   &lt;2e-16 ***
ORIGIN_SZPLSZ02     12.208661   0.016223   752.58   &lt;2e-16 ***
ORIGIN_SZPLSZ03     11.961715   0.037650   317.71   &lt;2e-16 ***
ORIGIN_SZPLSZ04     10.970305   0.037528   292.32   &lt;2e-16 ***
ORIGIN_SZPLSZ05     11.529098   0.023382   493.07   &lt;2e-16 ***
ORIGIN_SZPNSZ01     14.809433   0.007683  1927.54   &lt;2e-16 ***
ORIGIN_SZPNSZ02     13.456232   0.013008  1034.48   &lt;2e-16 ***
ORIGIN_SZPNSZ03     11.812303   0.020334   580.90   &lt;2e-16 ***
ORIGIN_SZPNSZ04     10.860901   0.034110   318.41   &lt;2e-16 ***
ORIGIN_SZPNSZ05     11.908348   0.028335   420.26   &lt;2e-16 ***
ORIGIN_SZPRSZ01     12.994356   0.013458   965.54   &lt;2e-16 ***
ORIGIN_SZPRSZ02     14.593280   0.007650  1907.53   &lt;2e-16 ***
ORIGIN_SZPRSZ03     14.271549   0.007629  1870.57   &lt;2e-16 ***
ORIGIN_SZPRSZ04     13.157473   0.009728  1352.55   &lt;2e-16 ***
ORIGIN_SZPRSZ05     14.817103   0.007593  1951.35   &lt;2e-16 ***
ORIGIN_SZPRSZ06     12.524933   0.013249   945.33   &lt;2e-16 ***
ORIGIN_SZPRSZ07     11.473800   0.017307   662.95   &lt;2e-16 ***
ORIGIN_SZPRSZ08     13.487934   0.008873  1520.09   &lt;2e-16 ***
ORIGIN_SZQTSZ01     13.477190   0.008862  1520.81   &lt;2e-16 ***
ORIGIN_SZQTSZ02     12.967076   0.008431  1538.04   &lt;2e-16 ***
ORIGIN_SZQTSZ03     13.537700   0.008078  1675.82   &lt;2e-16 ***
ORIGIN_SZQTSZ04     12.612515   0.009295  1356.85   &lt;2e-16 ***
ORIGIN_SZQTSZ05     13.049546   0.008551  1526.15   &lt;2e-16 ***
ORIGIN_SZQTSZ06     13.129405   0.008737  1502.71   &lt;2e-16 ***
ORIGIN_SZQTSZ07     12.327427   0.011193  1101.34   &lt;2e-16 ***
ORIGIN_SZQTSZ08     13.194474   0.008592  1535.63   &lt;2e-16 ***
ORIGIN_SZQTSZ09     12.970627   0.009125  1421.47   &lt;2e-16 ***
ORIGIN_SZQTSZ10     13.259150   0.008770  1511.91   &lt;2e-16 ***
ORIGIN_SZQTSZ11     11.284665   0.015596   723.58   &lt;2e-16 ***
ORIGIN_SZQTSZ12     10.880722   0.019634   554.18   &lt;2e-16 ***
ORIGIN_SZQTSZ13     13.043175   0.009934  1312.94   &lt;2e-16 ***
ORIGIN_SZQTSZ14     11.941187   0.013554   880.99   &lt;2e-16 ***
ORIGIN_SZQTSZ15     12.773938   0.013692   932.93   &lt;2e-16 ***
ORIGIN_SZRCSZ01     12.357602   0.013697   902.20   &lt;2e-16 ***
ORIGIN_SZRCSZ06     12.989158   0.009900  1312.00   &lt;2e-16 ***
ORIGIN_SZRVSZ01     11.090198   0.032806   338.05   &lt;2e-16 ***
ORIGIN_SZRVSZ02     10.700016   0.028182   379.68   &lt;2e-16 ***
ORIGIN_SZRVSZ03     10.904990   0.025102   434.42   &lt;2e-16 ***
ORIGIN_SZRVSZ04     10.234020   0.055903   183.07   &lt;2e-16 ***
ORIGIN_SZRVSZ05     11.564511   0.017233   671.09   &lt;2e-16 ***
ORIGIN_SZSBSZ01     13.694820   0.008691  1575.66   &lt;2e-16 ***
ORIGIN_SZSBSZ02     12.799807   0.010113  1265.64   &lt;2e-16 ***
ORIGIN_SZSBSZ03     14.310247   0.007549  1895.70   &lt;2e-16 ***
ORIGIN_SZSBSZ04     14.268462   0.007921  1801.45   &lt;2e-16 ***
ORIGIN_SZSBSZ05     13.283604   0.008936  1486.52   &lt;2e-16 ***
ORIGIN_SZSBSZ06     12.343936   0.018178   679.06   &lt;2e-16 ***
ORIGIN_SZSBSZ07     13.012784   0.013823   941.40   &lt;2e-16 ***
ORIGIN_SZSBSZ08     12.308768   0.015394   799.60   &lt;2e-16 ***
ORIGIN_SZSBSZ09     12.684160   0.010752  1179.75   &lt;2e-16 ***
ORIGIN_SZSESZ02     14.507589   0.007314  1983.52   &lt;2e-16 ***
ORIGIN_SZSESZ03     14.625654   0.007129  2051.67   &lt;2e-16 ***
ORIGIN_SZSESZ04     14.147730   0.007624  1855.61   &lt;2e-16 ***
ORIGIN_SZSESZ05     13.090677   0.008431  1552.70   &lt;2e-16 ***
ORIGIN_SZSESZ06     14.100045   0.007737  1822.40   &lt;2e-16 ***
ORIGIN_SZSESZ07     11.109260   0.020519   541.40   &lt;2e-16 ***
ORIGIN_SZSGSZ01     12.569577   0.010566  1189.65   &lt;2e-16 ***
ORIGIN_SZSGSZ02     12.242935   0.011838  1034.21   &lt;2e-16 ***
ORIGIN_SZSGSZ03     13.655770   0.007838  1742.24   &lt;2e-16 ***
ORIGIN_SZSGSZ04     13.796171   0.007685  1795.21   &lt;2e-16 ***
ORIGIN_SZSGSZ05     11.799689   0.012271   961.56   &lt;2e-16 ***
ORIGIN_SZSGSZ06     13.964562   0.007447  1875.17   &lt;2e-16 ***
ORIGIN_SZSGSZ07     12.912197   0.008601  1501.32   &lt;2e-16 ***
ORIGIN_SZSKSZ01     13.223717   0.010716  1233.99   &lt;2e-16 ***
ORIGIN_SZSKSZ02     14.101501   0.008569  1645.58   &lt;2e-16 ***
ORIGIN_SZSKSZ03     12.793468   0.010321  1239.52   &lt;2e-16 ***
ORIGIN_SZSKSZ04     11.391713   0.028338   401.99   &lt;2e-16 ***
ORIGIN_SZSKSZ05     12.428737   0.016911   734.97   &lt;2e-16 ***
ORIGIN_SZSLSZ01     10.261594   0.033554   305.82   &lt;2e-16 ***
ORIGIN_SZSLSZ04     12.833157   0.009951  1289.67   &lt;2e-16 ***
ORIGIN_SZSRSZ01     11.393980   0.017085   666.88   &lt;2e-16 ***
ORIGIN_SZTHSZ01     10.856447   0.049328   220.09   &lt;2e-16 ***
ORIGIN_SZTHSZ03     11.953178   0.023143   516.49   &lt;2e-16 ***
ORIGIN_SZTHSZ04     10.905361   0.029249   372.85   &lt;2e-16 ***
ORIGIN_SZTHSZ06     11.516883   0.019243   598.50   &lt;2e-16 ***
ORIGIN_SZTMSZ01     13.803358   0.008506  1622.79   &lt;2e-16 ***
ORIGIN_SZTMSZ02     15.412369   0.007373  2090.28   &lt;2e-16 ***
ORIGIN_SZTMSZ03     14.826912   0.007479  1982.54   &lt;2e-16 ***
ORIGIN_SZTMSZ04     14.106880   0.008140  1733.04   &lt;2e-16 ***
ORIGIN_SZTMSZ05     12.434029   0.013131   946.94   &lt;2e-16 ***
ORIGIN_SZTNSZ01     11.577227   0.014121   819.88   &lt;2e-16 ***
ORIGIN_SZTNSZ02     11.955301   0.011372  1051.26   &lt;2e-16 ***
ORIGIN_SZTNSZ03     11.454010   0.014698   779.29   &lt;2e-16 ***
ORIGIN_SZTNSZ04     12.983794   0.009495  1367.46   &lt;2e-16 ***
ORIGIN_SZTPSZ01     12.873722   0.008874  1450.67   &lt;2e-16 ***
ORIGIN_SZTPSZ02     14.081937   0.007202  1955.32   &lt;2e-16 ***
ORIGIN_SZTPSZ03     13.016319   0.008352  1558.52   &lt;2e-16 ***
ORIGIN_SZTPSZ04     13.322837   0.007822  1703.31   &lt;2e-16 ***
ORIGIN_SZTPSZ05     13.478751   0.008167  1650.48   &lt;2e-16 ***
ORIGIN_SZTPSZ06     13.984853   0.007708  1814.29   &lt;2e-16 ***
ORIGIN_SZTPSZ07     13.533836   0.008301  1630.36   &lt;2e-16 ***
ORIGIN_SZTPSZ08     12.571354   0.011229  1119.49   &lt;2e-16 ***
ORIGIN_SZTPSZ09     12.916599   0.008879  1454.76   &lt;2e-16 ***
ORIGIN_SZTPSZ10     12.804665   0.009576  1337.19   &lt;2e-16 ***
ORIGIN_SZTPSZ11     13.620840   0.007985  1705.81   &lt;2e-16 ***
ORIGIN_SZTPSZ12     13.037361   0.008816  1478.89   &lt;2e-16 ***
ORIGIN_SZTSSZ01     10.876195   0.048380   224.81   &lt;2e-16 ***
ORIGIN_SZTSSZ02     14.044818   0.010495  1338.21   &lt;2e-16 ***
ORIGIN_SZTSSZ03     13.680946   0.010574  1293.88   &lt;2e-16 ***
ORIGIN_SZTSSZ04     13.611037   0.011155  1220.18   &lt;2e-16 ***
ORIGIN_SZTSSZ05     12.819921   0.016598   772.38   &lt;2e-16 ***
ORIGIN_SZTSSZ06     13.627076   0.019330   704.98   &lt;2e-16 ***
ORIGIN_SZWCSZ01     13.145574   0.011293  1164.00   &lt;2e-16 ***
ORIGIN_SZWCSZ02     11.192640   0.033469   334.41   &lt;2e-16 ***
ORIGIN_SZWCSZ03      8.543403   0.124212    68.78   &lt;2e-16 ***
ORIGIN_SZWDSZ01     14.954761   0.007046  2122.40   &lt;2e-16 ***
ORIGIN_SZWDSZ02     14.371425   0.007537  1906.80   &lt;2e-16 ***
ORIGIN_SZWDSZ03     14.806538   0.007498  1974.77   &lt;2e-16 ***
ORIGIN_SZWDSZ04     14.581359   0.007907  1844.18   &lt;2e-16 ***
ORIGIN_SZWDSZ05     13.946530   0.008113  1718.94   &lt;2e-16 ***
ORIGIN_SZWDSZ06     14.220468   0.007853  1810.87   &lt;2e-16 ***
ORIGIN_SZWDSZ07     12.612066   0.010345  1219.19   &lt;2e-16 ***
ORIGIN_SZWDSZ08     12.831128   0.010131  1266.59   &lt;2e-16 ***
ORIGIN_SZWDSZ09     14.656026   0.007511  1951.17   &lt;2e-16 ***
ORIGIN_SZYSSZ01     13.261082   0.008306  1596.58   &lt;2e-16 ***
ORIGIN_SZYSSZ02     14.245337   0.007812  1823.60   &lt;2e-16 ***
ORIGIN_SZYSSZ03     15.134694   0.007426  2038.07   &lt;2e-16 ***
ORIGIN_SZYSSZ04     14.454130   0.007529  1919.85   &lt;2e-16 ***
ORIGIN_SZYSSZ05     13.451953   0.008632  1558.37   &lt;2e-16 ***
ORIGIN_SZYSSZ06     12.474801   0.013312   937.11   &lt;2e-16 ***
ORIGIN_SZYSSZ07     11.860498   0.015598   760.39   &lt;2e-16 ***
ORIGIN_SZYSSZ08     13.386484   0.008730  1533.44   &lt;2e-16 ***
ORIGIN_SZYSSZ09     14.521428   0.007349  1976.07   &lt;2e-16 ***
log(SCHOOL_COUNT)    0.318923   0.000459   694.89   &lt;2e-16 ***
log(BUSINESS_COUNT) -1.481761   0.001445 -1025.09   &lt;2e-16 ***
log(dist)           -0.588290   0.001087  -541.09   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 186229141  on 14470  degrees of freedom
Residual deviance:  15254342  on 14188  degrees of freedom
AIC: 15344031

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p><img src="orcSIM_Poisson_R.png" class="img-fluid" width="326"></p>
<ul>
<li>the ⍺1 and ⍺2 of SCHOOL_COUNT and BUSINESS_COUNT are 0.3189228 and -1.481761 respectively.</li>
<li>𝛽, the distance decay parameter is -0.5882901</li>
<li>there are a series of parameters which are the vector of 𝜇𝑖 values associated with the origin constraints.</li>
</ul>
<p>Next, let us examine how well the proportion of variance in the dependent variable (i.e.&nbsp;TRIPS) that can be explained by the explanatory variables.</p>
<section id="goodness-of-fit-2" class="level4">
<h4 class="anchored" data-anchor-id="goodness-of-fit-2">Goodness of fit</h4>
<p>In statistical modelling, the next question we would like to answer is how well the proportion of variance in the dependent variable (i.e.&nbsp;TRIPS) that can be explained by the explanatory variables.</p>
<p>In order to provide answer to this question, R-squared statistics will be used. However, R-squared is not an output of glm(). Hence we will write a function called CalcRSquared by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>CalcRSquared <span class="ot">&lt;-</span> <span class="cf">function</span>(observed, estimated){</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">cor</span>(observed, estimated)</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>  R2 <span class="ot">&lt;-</span> r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>  R2</span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>NOw, we can examine how the constraints hold for destinations this time.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(orcSIM_Poisson<span class="sc">$</span>data<span class="sc">$</span>TRIPS, orcSIM_Poisson<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4304431</code></pre>
</div>
</div>
<p>With reference to the R-Squared above, we can conclude that the model accounts for about 43% of the variation of flows in the systems. Not bad, but not brilliant either.</p>
</section>
</section>
<section id="doubly-constrained-model-1" class="level3">
<h3 class="anchored" data-anchor-id="doubly-constrained-model-1">Doubly constrained model</h3>
<p>In this section, we will fit a doubly constrained SIM by using the general formula shown below:</p>
<p><img src="Doubly constrained model.png" class="img-fluid" width="294"></p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>dbcSIM_Poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>                ORIGIN_SZ <span class="sc">+</span> </span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>                DESTIN_SZ <span class="sc">+</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> inter_zonal_flow,</span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dbcSIM_Poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ ORIGIN_SZ + DESTIN_SZ + log(dist), family = poisson(link = "log"), 
    data = inter_zonal_flow, na.action = na.exclude)

Coefficients:
                  Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)      2.179e+01  5.927e-03  3676.629  &lt; 2e-16 ***
ORIGIN_SZAMSZ02  5.273e-01  4.802e-03   109.800  &lt; 2e-16 ***
ORIGIN_SZAMSZ03  3.139e-01  4.925e-03    63.741  &lt; 2e-16 ***
ORIGIN_SZAMSZ04 -2.139e-01  5.363e-03   -39.888  &lt; 2e-16 ***
ORIGIN_SZAMSZ05 -1.887e-01  6.038e-03   -31.244  &lt; 2e-16 ***
ORIGIN_SZAMSZ06  1.553e-01  5.439e-03    28.549  &lt; 2e-16 ***
ORIGIN_SZAMSZ07 -9.835e-01  9.867e-03   -99.669  &lt; 2e-16 ***
ORIGIN_SZAMSZ08 -4.514e-01  9.306e-03   -48.504  &lt; 2e-16 ***
ORIGIN_SZAMSZ09  7.221e-02  5.739e-03    12.582  &lt; 2e-16 ***
ORIGIN_SZAMSZ10  4.308e-01  5.036e-03    85.553  &lt; 2e-16 ***
ORIGIN_SZAMSZ11 -1.472e+00  1.312e-02  -112.202  &lt; 2e-16 ***
ORIGIN_SZAMSZ12 -1.725e+00  1.116e-02  -154.540  &lt; 2e-16 ***
ORIGIN_SZBDSZ01  8.805e-01  4.815e-03   182.871  &lt; 2e-16 ***
ORIGIN_SZBDSZ02  1.110e-01  5.551e-03    19.996  &lt; 2e-16 ***
ORIGIN_SZBDSZ03  3.620e-01  5.065e-03    71.462  &lt; 2e-16 ***
ORIGIN_SZBDSZ04  1.462e+00  4.419e-03   330.814  &lt; 2e-16 ***
ORIGIN_SZBDSZ05  6.203e-01  5.082e-03   122.048  &lt; 2e-16 ***
ORIGIN_SZBDSZ06  6.717e-01  5.193e-03   129.349  &lt; 2e-16 ***
ORIGIN_SZBDSZ07 -1.233e+00  1.008e-02  -122.342  &lt; 2e-16 ***
ORIGIN_SZBDSZ08 -1.044e+00  9.454e-03  -110.445  &lt; 2e-16 ***
ORIGIN_SZBKSZ01 -2.915e-01  7.134e-03   -40.857  &lt; 2e-16 ***
ORIGIN_SZBKSZ02  5.536e-01  5.899e-03    93.846  &lt; 2e-16 ***
ORIGIN_SZBKSZ03  7.417e-01  5.677e-03   130.650  &lt; 2e-16 ***
ORIGIN_SZBKSZ04 -2.235e-01  6.746e-03   -33.139  &lt; 2e-16 ***
ORIGIN_SZBKSZ05 -2.411e-01  6.936e-03   -34.753  &lt; 2e-16 ***
ORIGIN_SZBKSZ06 -1.401e-01  6.501e-03   -21.550  &lt; 2e-16 ***
ORIGIN_SZBKSZ07  7.081e-01  5.181e-03   136.675  &lt; 2e-16 ***
ORIGIN_SZBKSZ08 -9.191e-02  5.912e-03   -15.545  &lt; 2e-16 ***
ORIGIN_SZBKSZ09 -1.778e-01  6.328e-03   -28.100  &lt; 2e-16 ***
ORIGIN_SZBLSZ01 -2.357e+00  1.543e-02  -152.697  &lt; 2e-16 ***
ORIGIN_SZBLSZ02 -2.808e+00  1.979e-02  -141.855  &lt; 2e-16 ***
ORIGIN_SZBLSZ03 -3.298e+00  4.662e-02   -70.743  &lt; 2e-16 ***
ORIGIN_SZBLSZ04 -2.692e+00  2.419e-02  -111.290  &lt; 2e-16 ***
ORIGIN_SZBMSZ01  6.216e-02  5.937e-03    10.471  &lt; 2e-16 ***
ORIGIN_SZBMSZ02 -1.350e+00  7.371e-03  -183.185  &lt; 2e-16 ***
ORIGIN_SZBMSZ03 -7.532e-01  6.315e-03  -119.274  &lt; 2e-16 ***
ORIGIN_SZBMSZ04 -2.918e-01  5.956e-03   -48.999  &lt; 2e-16 ***
ORIGIN_SZBMSZ05 -2.611e+00  1.724e-02  -151.479  &lt; 2e-16 ***
ORIGIN_SZBMSZ06 -3.027e+00  1.855e-02  -163.172  &lt; 2e-16 ***
ORIGIN_SZBMSZ07 -6.938e-01  6.404e-03  -108.353  &lt; 2e-16 ***
ORIGIN_SZBMSZ08 -9.273e-01  6.450e-03  -143.758  &lt; 2e-16 ***
ORIGIN_SZBMSZ09 -1.289e+00  9.202e-03  -140.103  &lt; 2e-16 ***
ORIGIN_SZBMSZ10 -1.665e+00  9.568e-03  -174.023  &lt; 2e-16 ***
ORIGIN_SZBMSZ11 -1.112e+00  7.199e-03  -154.399  &lt; 2e-16 ***
ORIGIN_SZBMSZ12 -1.528e+00  9.990e-03  -152.900  &lt; 2e-16 ***
ORIGIN_SZBMSZ13 -6.232e-01  6.583e-03   -94.669  &lt; 2e-16 ***
ORIGIN_SZBMSZ14 -1.043e+00  7.244e-03  -143.925  &lt; 2e-16 ***
ORIGIN_SZBMSZ15 -5.017e-01  6.735e-03   -74.494  &lt; 2e-16 ***
ORIGIN_SZBMSZ16 -1.526e+00  9.950e-03  -153.346  &lt; 2e-16 ***
ORIGIN_SZBMSZ17 -1.573e+00  1.615e-02   -97.387  &lt; 2e-16 ***
ORIGIN_SZBPSZ01  5.766e-01  6.289e-03    91.685  &lt; 2e-16 ***
ORIGIN_SZBPSZ02  8.245e-02  7.216e-03    11.426  &lt; 2e-16 ***
ORIGIN_SZBPSZ03  3.304e-01  7.043e-03    46.912  &lt; 2e-16 ***
ORIGIN_SZBPSZ04  6.464e-01  5.770e-03   112.034  &lt; 2e-16 ***
ORIGIN_SZBPSZ05  9.422e-01  5.295e-03   177.950  &lt; 2e-16 ***
ORIGIN_SZBPSZ06 -1.051e+00  9.818e-03  -107.060  &lt; 2e-16 ***
ORIGIN_SZBPSZ07 -5.471e-01  9.166e-03   -59.692  &lt; 2e-16 ***
ORIGIN_SZBSSZ01  2.972e-01  5.919e-03    50.214  &lt; 2e-16 ***
ORIGIN_SZBSSZ02  2.839e-01  5.085e-03    55.823  &lt; 2e-16 ***
ORIGIN_SZBSSZ03 -2.341e-01  5.656e-03   -41.386  &lt; 2e-16 ***
ORIGIN_SZBTSZ01  9.637e-02  6.369e-03    15.131  &lt; 2e-16 ***
ORIGIN_SZBTSZ02 -6.283e-01  8.458e-03   -74.285  &lt; 2e-16 ***
ORIGIN_SZBTSZ03 -4.338e-01  7.343e-03   -59.081  &lt; 2e-16 ***
ORIGIN_SZBTSZ04 -1.499e+00  1.100e-02  -136.271  &lt; 2e-16 ***
ORIGIN_SZBTSZ05 -9.591e-01  1.222e-02   -78.492  &lt; 2e-16 ***
ORIGIN_SZBTSZ06 -1.284e+00  9.930e-03  -129.310  &lt; 2e-16 ***
ORIGIN_SZBTSZ07 -2.386e+00  1.446e-02  -165.051  &lt; 2e-16 ***
ORIGIN_SZBTSZ08 -1.369e+00  1.138e-02  -120.280  &lt; 2e-16 ***
ORIGIN_SZCBSZ01 -3.591e+00  5.490e-02   -65.415  &lt; 2e-16 ***
ORIGIN_SZCCSZ01 -7.076e-01  1.404e-02   -50.408  &lt; 2e-16 ***
ORIGIN_SZCHSZ01 -9.127e-01  1.229e-02   -74.287  &lt; 2e-16 ***
ORIGIN_SZCHSZ02 -8.553e-01  8.871e-03   -96.416  &lt; 2e-16 ***
ORIGIN_SZCHSZ03  1.111e+00  6.612e-03   168.019  &lt; 2e-16 ***
ORIGIN_SZCKSZ01  2.917e-01  5.853e-03    49.828  &lt; 2e-16 ***
ORIGIN_SZCKSZ02  7.074e-01  6.059e-03   116.752  &lt; 2e-16 ***
ORIGIN_SZCKSZ03  1.129e+00  5.317e-03   212.270  &lt; 2e-16 ***
ORIGIN_SZCKSZ04  1.613e+00  5.478e-03   294.516  &lt; 2e-16 ***
ORIGIN_SZCKSZ05  8.263e-01  6.416e-03   128.790  &lt; 2e-16 ***
ORIGIN_SZCKSZ06  6.437e-01  8.236e-03    78.163  &lt; 2e-16 ***
ORIGIN_SZCLSZ01 -7.207e-01  8.210e-03   -87.778  &lt; 2e-16 ***
ORIGIN_SZCLSZ02 -1.751e+00  1.390e-02  -125.962  &lt; 2e-16 ***
ORIGIN_SZCLSZ03 -1.037e+00  8.547e-03  -121.369  &lt; 2e-16 ***
ORIGIN_SZCLSZ04  6.147e-01  5.124e-03   119.976  &lt; 2e-16 ***
ORIGIN_SZCLSZ05 -2.099e+00  1.502e-02  -139.727  &lt; 2e-16 ***
ORIGIN_SZCLSZ06  7.250e-01  4.941e-03   146.731  &lt; 2e-16 ***
ORIGIN_SZCLSZ07 -5.336e-01  6.247e-03   -85.422  &lt; 2e-16 ***
ORIGIN_SZCLSZ08 -2.127e-01  6.754e-03   -31.492  &lt; 2e-16 ***
ORIGIN_SZCLSZ09 -1.799e+00  1.691e-02  -106.375  &lt; 2e-16 ***
ORIGIN_SZDTSZ02 -3.907e+00  8.347e-02   -46.815  &lt; 2e-16 ***
ORIGIN_SZDTSZ03 -3.417e+00  7.386e-02   -46.262  &lt; 2e-16 ***
ORIGIN_SZDTSZ13 -3.017e+00  3.152e-02   -95.717  &lt; 2e-16 ***
ORIGIN_SZGLSZ01 -1.779e+00  9.936e-03  -179.050  &lt; 2e-16 ***
ORIGIN_SZGLSZ02 -1.062e-01  5.431e-03   -19.556  &lt; 2e-16 ***
ORIGIN_SZGLSZ03 -2.459e-01  5.716e-03   -43.021  &lt; 2e-16 ***
ORIGIN_SZGLSZ04  8.654e-01  4.639e-03   186.524  &lt; 2e-16 ***
ORIGIN_SZGLSZ05  5.871e-01  4.792e-03   122.512  &lt; 2e-16 ***
ORIGIN_SZHGSZ01  3.534e-01  5.045e-03    70.050  &lt; 2e-16 ***
ORIGIN_SZHGSZ02  4.212e-01  5.080e-03    82.904  &lt; 2e-16 ***
ORIGIN_SZHGSZ03  2.401e-01  5.423e-03    44.270  &lt; 2e-16 ***
ORIGIN_SZHGSZ04  8.174e-01  4.614e-03   177.165  &lt; 2e-16 ***
ORIGIN_SZHGSZ05  1.216e+00  4.564e-03   266.350  &lt; 2e-16 ***
ORIGIN_SZHGSZ06 -1.831e-01  5.820e-03   -31.454  &lt; 2e-16 ***
ORIGIN_SZHGSZ07  3.165e-01  5.072e-03    62.400  &lt; 2e-16 ***
ORIGIN_SZHGSZ08 -1.152e-01  5.705e-03   -20.198  &lt; 2e-16 ***
ORIGIN_SZHGSZ09 -1.286e+00  9.160e-03  -140.383  &lt; 2e-16 ***
ORIGIN_SZHGSZ10 -3.377e+00  4.247e-02   -79.529  &lt; 2e-16 ***
ORIGIN_SZJESZ01  4.860e-01  5.591e-03    86.929  &lt; 2e-16 ***
ORIGIN_SZJESZ02  1.767e-01  5.577e-03    31.675  &lt; 2e-16 ***
ORIGIN_SZJESZ03 -2.169e-01  5.951e-03   -36.453  &lt; 2e-16 ***
ORIGIN_SZJESZ04 -1.547e+00  1.045e-02  -148.020  &lt; 2e-16 ***
ORIGIN_SZJESZ05 -2.331e+00  1.427e-02  -163.327  &lt; 2e-16 ***
ORIGIN_SZJESZ06  3.010e-01  5.499e-03    54.747  &lt; 2e-16 ***
ORIGIN_SZJESZ07 -1.968e+00  1.211e-02  -162.556  &lt; 2e-16 ***
ORIGIN_SZJESZ08 -1.294e+00  1.220e-02  -106.052  &lt; 2e-16 ***
ORIGIN_SZJESZ09  5.777e-01  5.873e-03    98.355  &lt; 2e-16 ***
ORIGIN_SZJESZ10 -1.431e+00  1.948e-02   -73.452  &lt; 2e-16 ***
ORIGIN_SZJESZ11 -1.965e+00  2.008e-02   -97.848  &lt; 2e-16 ***
ORIGIN_SZJWSZ01  4.165e-01  7.146e-03    58.283  &lt; 2e-16 ***
ORIGIN_SZJWSZ02  8.321e-01  5.323e-03   156.338  &lt; 2e-16 ***
ORIGIN_SZJWSZ03  1.552e+00  4.995e-03   310.652  &lt; 2e-16 ***
ORIGIN_SZJWSZ04  6.528e-01  5.671e-03   115.105  &lt; 2e-16 ***
ORIGIN_SZJWSZ05 -2.129e+00  1.336e-02  -159.300  &lt; 2e-16 ***
ORIGIN_SZJWSZ06 -1.459e+00  1.136e-02  -128.443  &lt; 2e-16 ***
ORIGIN_SZJWSZ07 -2.705e+00  2.806e-02   -96.409  &lt; 2e-16 ***
ORIGIN_SZJWSZ08  1.220e+00  6.166e-03   197.780  &lt; 2e-16 ***
ORIGIN_SZJWSZ09  1.857e+00  4.892e-03   379.507  &lt; 2e-16 ***
ORIGIN_SZKLSZ01  1.088e-01  5.329e-03    20.419  &lt; 2e-16 ***
ORIGIN_SZKLSZ02 -8.822e-01  6.771e-03  -130.289  &lt; 2e-16 ***
ORIGIN_SZKLSZ03 -6.850e-01  6.284e-03  -109.011  &lt; 2e-16 ***
ORIGIN_SZKLSZ04 -2.208e+00  1.224e-02  -180.319  &lt; 2e-16 ***
ORIGIN_SZKLSZ05 -1.172e+00  1.108e-02  -105.822  &lt; 2e-16 ***
ORIGIN_SZKLSZ06 -6.110e+00  1.858e-01   -32.889  &lt; 2e-16 ***
ORIGIN_SZKLSZ07 -1.405e+00  9.225e-03  -152.255  &lt; 2e-16 ***
ORIGIN_SZKLSZ08 -1.777e+00  1.047e-02  -169.767  &lt; 2e-16 ***
ORIGIN_SZLKSZ01 -2.097e+00  3.988e-02   -52.571  &lt; 2e-16 ***
ORIGIN_SZMDSZ01 -8.873e-01  2.876e-02   -30.850  &lt; 2e-16 ***
ORIGIN_SZMDSZ02 -6.256e-01  1.074e-02   -58.264  &lt; 2e-16 ***
ORIGIN_SZMDSZ03 -2.084e+00  1.731e-02  -120.384  &lt; 2e-16 ***
ORIGIN_SZMPSZ01 -9.654e-01  8.696e-03  -111.011  &lt; 2e-16 ***
ORIGIN_SZMPSZ02 -1.038e+00  7.338e-03  -141.458  &lt; 2e-16 ***
ORIGIN_SZMPSZ03 -2.831e-05  5.938e-03    -0.005 0.996196    
ORIGIN_SZMUSZ02 -3.761e+00  1.038e-01   -36.234  &lt; 2e-16 ***
ORIGIN_SZNTSZ01 -3.035e+00  3.553e-02   -85.432  &lt; 2e-16 ***
ORIGIN_SZNTSZ02 -3.419e+00  2.359e-02  -144.929  &lt; 2e-16 ***
ORIGIN_SZNTSZ03 -9.068e-01  8.252e-03  -109.891  &lt; 2e-16 ***
ORIGIN_SZNTSZ05 -4.079e+00  4.996e-02   -81.649  &lt; 2e-16 ***
ORIGIN_SZNTSZ06 -3.946e+00  5.653e-02   -69.794  &lt; 2e-16 ***
ORIGIN_SZNVSZ01  3.248e-01  4.942e-03    65.730  &lt; 2e-16 ***
ORIGIN_SZNVSZ02 -6.929e-01  7.051e-03   -98.270  &lt; 2e-16 ***
ORIGIN_SZNVSZ03 -1.054e+00  8.377e-03  -125.784  &lt; 2e-16 ***
ORIGIN_SZNVSZ04 -9.908e-01  9.345e-03  -106.026  &lt; 2e-16 ***
ORIGIN_SZNVSZ05 -2.260e+00  1.692e-02  -133.579  &lt; 2e-16 ***
ORIGIN_SZPGSZ01  2.391e-01  1.304e-02    18.331  &lt; 2e-16 ***
ORIGIN_SZPGSZ02 -3.372e-01  7.843e-03   -42.991  &lt; 2e-16 ***
ORIGIN_SZPGSZ03  9.487e-01  5.136e-03   184.729  &lt; 2e-16 ***
ORIGIN_SZPGSZ04  1.397e+00  4.797e-03   291.240  &lt; 2e-16 ***
ORIGIN_SZPGSZ05  4.436e-01  6.340e-03    69.973  &lt; 2e-16 ***
ORIGIN_SZPLSZ01 -9.714e-01  1.228e-02   -79.120  &lt; 2e-16 ***
ORIGIN_SZPLSZ02 -1.069e+00  1.533e-02   -69.693  &lt; 2e-16 ***
ORIGIN_SZPLSZ03 -2.123e+00  3.735e-02   -56.843  &lt; 2e-16 ***
ORIGIN_SZPLSZ04 -3.091e+00  3.713e-02   -83.239  &lt; 2e-16 ***
ORIGIN_SZPLSZ05 -2.172e+00  2.261e-02   -96.063  &lt; 2e-16 ***
ORIGIN_SZPNSZ01  8.911e-01  6.628e-03   134.453  &lt; 2e-16 ***
ORIGIN_SZPNSZ02 -2.124e-01  1.257e-02   -16.902  &lt; 2e-16 ***
ORIGIN_SZPNSZ03 -2.412e+00  2.015e-02  -119.676  &lt; 2e-16 ***
ORIGIN_SZPNSZ04 -3.468e+00  3.437e-02  -100.895  &lt; 2e-16 ***
ORIGIN_SZPNSZ05 -2.082e+00  2.823e-02   -73.739  &lt; 2e-16 ***
ORIGIN_SZPRSZ01 -6.406e-01  1.205e-02   -53.179  &lt; 2e-16 ***
ORIGIN_SZPRSZ02  8.122e-01  5.086e-03   159.696  &lt; 2e-16 ***
ORIGIN_SZPRSZ03  3.998e-01  5.179e-03    77.196  &lt; 2e-16 ***
ORIGIN_SZPRSZ04 -8.472e-01  7.922e-03  -106.935  &lt; 2e-16 ***
ORIGIN_SZPRSZ05  8.021e-01  4.851e-03   165.360  &lt; 2e-16 ***
ORIGIN_SZPRSZ06 -1.448e+00  1.214e-02  -119.229  &lt; 2e-16 ***
ORIGIN_SZPRSZ07 -3.196e+00  1.671e-02  -191.261  &lt; 2e-16 ***
ORIGIN_SZPRSZ08 -5.845e-01  6.724e-03   -86.927  &lt; 2e-16 ***
ORIGIN_SZQTSZ01 -1.841e-01  7.549e-03   -24.386  &lt; 2e-16 ***
ORIGIN_SZQTSZ02 -8.701e-01  6.810e-03  -127.780  &lt; 2e-16 ***
ORIGIN_SZQTSZ03 -1.245e-01  6.475e-03   -19.232  &lt; 2e-16 ***
ORIGIN_SZQTSZ04 -1.459e+00  7.982e-03  -182.744  &lt; 2e-16 ***
ORIGIN_SZQTSZ05 -6.653e-01  6.959e-03   -95.612  &lt; 2e-16 ***
ORIGIN_SZQTSZ06 -8.165e-01  7.268e-03  -112.333  &lt; 2e-16 ***
ORIGIN_SZQTSZ07 -1.517e+00  9.984e-03  -151.941  &lt; 2e-16 ***
ORIGIN_SZQTSZ08 -4.965e-01  6.785e-03   -73.172  &lt; 2e-16 ***
ORIGIN_SZQTSZ09 -9.000e-01  7.595e-03  -118.499  &lt; 2e-16 ***
ORIGIN_SZQTSZ10 -6.676e-01  7.154e-03   -93.316  &lt; 2e-16 ***
ORIGIN_SZQTSZ11 -2.518e+00  1.470e-02  -171.319  &lt; 2e-16 ***
ORIGIN_SZQTSZ12 -3.042e+00  1.902e-02  -159.979  &lt; 2e-16 ***
ORIGIN_SZQTSZ13 -7.486e-01  8.445e-03   -88.642  &lt; 2e-16 ***
ORIGIN_SZQTSZ14 -1.931e+00  1.261e-02  -153.152  &lt; 2e-16 ***
ORIGIN_SZQTSZ15 -9.542e-01  1.271e-02   -75.060  &lt; 2e-16 ***
ORIGIN_SZRCSZ01 -1.814e+00  1.292e-02  -140.423  &lt; 2e-16 ***
ORIGIN_SZRCSZ06 -5.545e-01  9.047e-03   -61.294  &lt; 2e-16 ***
ORIGIN_SZRVSZ01 -2.886e+00  3.255e-02   -88.653  &lt; 2e-16 ***
ORIGIN_SZRVSZ02 -3.151e+00  2.812e-02  -112.051  &lt; 2e-16 ***
ORIGIN_SZRVSZ03 -2.981e+00  2.484e-02  -120.010  &lt; 2e-16 ***
ORIGIN_SZRVSZ04 -3.550e+00  5.613e-02   -63.242  &lt; 2e-16 ***
ORIGIN_SZRVSZ05 -2.581e+00  1.802e-02  -143.202  &lt; 2e-16 ***
ORIGIN_SZSBSZ01  2.854e-01  7.107e-03    40.160  &lt; 2e-16 ***
ORIGIN_SZSBSZ02 -9.023e-01  8.724e-03  -103.429  &lt; 2e-16 ***
ORIGIN_SZSBSZ03  8.290e-01  5.538e-03   149.687  &lt; 2e-16 ***
ORIGIN_SZSBSZ04  4.039e-01  6.201e-03    65.142  &lt; 2e-16 ***
ORIGIN_SZSBSZ05 -2.673e-01  7.413e-03   -36.060  &lt; 2e-16 ***
ORIGIN_SZSBSZ06 -9.056e-01  1.750e-02   -51.741  &lt; 2e-16 ***
ORIGIN_SZSBSZ07  4.668e-02  1.313e-02     3.555 0.000377 ***
ORIGIN_SZSBSZ08 -1.119e+00  1.454e-02   -76.933  &lt; 2e-16 ***
ORIGIN_SZSBSZ09 -9.693e-01  9.537e-03  -101.635  &lt; 2e-16 ***
ORIGIN_SZSESZ02  1.144e+00  4.779e-03   239.289  &lt; 2e-16 ***
ORIGIN_SZSESZ03  1.279e+00  4.566e-03   280.158  &lt; 2e-16 ***
ORIGIN_SZSESZ04  8.077e-01  5.274e-03   153.150  &lt; 2e-16 ***
ORIGIN_SZSESZ05 -2.345e-01  6.310e-03   -37.169  &lt; 2e-16 ***
ORIGIN_SZSESZ06  1.055e+00  4.990e-03   211.380  &lt; 2e-16 ***
ORIGIN_SZSESZ07 -2.318e+00  1.968e-02  -117.789  &lt; 2e-16 ***
ORIGIN_SZSGSZ01 -6.628e-01  8.807e-03   -75.259  &lt; 2e-16 ***
ORIGIN_SZSGSZ02 -1.364e+00  1.040e-02  -131.099  &lt; 2e-16 ***
ORIGIN_SZSGSZ03  1.145e-01  5.464e-03    20.957  &lt; 2e-16 ***
ORIGIN_SZSGSZ04  2.946e-01  5.086e-03    57.926  &lt; 2e-16 ***
ORIGIN_SZSGSZ05 -2.078e+00  1.099e-02  -189.122  &lt; 2e-16 ***
ORIGIN_SZSGSZ06  4.552e-01  4.887e-03    93.141  &lt; 2e-16 ***
ORIGIN_SZSGSZ07 -8.944e-01  6.709e-03  -133.319  &lt; 2e-16 ***
ORIGIN_SZSKSZ01 -3.218e-01  9.300e-03   -34.602  &lt; 2e-16 ***
ORIGIN_SZSKSZ02  1.112e+00  6.383e-03   174.264  &lt; 2e-16 ***
ORIGIN_SZSKSZ03 -2.613e-01  8.601e-03   -30.382  &lt; 2e-16 ***
ORIGIN_SZSKSZ04 -1.585e+00  2.794e-02   -56.736  &lt; 2e-16 ***
ORIGIN_SZSKSZ05 -2.766e-01  1.636e-02   -16.911  &lt; 2e-16 ***
ORIGIN_SZSLSZ01 -2.450e+00  3.303e-02   -74.174  &lt; 2e-16 ***
ORIGIN_SZSLSZ04 -1.029e-01  7.962e-03   -12.925  &lt; 2e-16 ***
ORIGIN_SZSRSZ01 -2.256e+00  1.765e-02  -127.821  &lt; 2e-16 ***
ORIGIN_SZTHSZ01 -2.617e+00  4.901e-02   -53.393  &lt; 2e-16 ***
ORIGIN_SZTHSZ03 -8.200e-01  2.268e-02   -36.157  &lt; 2e-16 ***
ORIGIN_SZTHSZ04 -2.429e+00  2.887e-02   -84.140  &lt; 2e-16 ***
ORIGIN_SZTHSZ06 -1.711e+00  1.863e-02   -91.810  &lt; 2e-16 ***
ORIGIN_SZTMSZ01 -2.178e-01  6.181e-03   -35.240  &lt; 2e-16 ***
ORIGIN_SZTMSZ02  1.777e+00  4.337e-03   409.709  &lt; 2e-16 ***
ORIGIN_SZTMSZ03  1.005e+00  4.603e-03   218.370  &lt; 2e-16 ***
ORIGIN_SZTMSZ04  1.657e-01  5.506e-03    30.098  &lt; 2e-16 ***
ORIGIN_SZTMSZ05 -1.288e+00  1.148e-02  -112.181  &lt; 2e-16 ***
ORIGIN_SZTNSZ01 -1.717e+00  1.313e-02  -130.840  &lt; 2e-16 ***
ORIGIN_SZTNSZ02 -1.649e+00  1.038e-02  -158.873  &lt; 2e-16 ***
ORIGIN_SZTNSZ03 -2.153e+00  1.379e-02  -156.081  &lt; 2e-16 ***
ORIGIN_SZTNSZ04 -3.955e-01  7.847e-03   -50.401  &lt; 2e-16 ***
ORIGIN_SZTPSZ01 -8.039e-01  6.990e-03  -115.007  &lt; 2e-16 ***
ORIGIN_SZTPSZ02  5.370e-01  4.725e-03   113.635  &lt; 2e-16 ***
ORIGIN_SZTPSZ03 -7.760e-01  6.427e-03  -120.747  &lt; 2e-16 ***
ORIGIN_SZTPSZ04 -8.126e-01  6.137e-03  -132.405  &lt; 2e-16 ***
ORIGIN_SZTPSZ05 -5.055e-01  6.774e-03   -74.624  &lt; 2e-16 ***
ORIGIN_SZTPSZ06  8.884e-02  6.569e-03    13.523  &lt; 2e-16 ***
ORIGIN_SZTPSZ07 -5.820e-01  6.613e-03   -88.003  &lt; 2e-16 ***
ORIGIN_SZTPSZ08 -1.057e+00  9.847e-03  -107.370  &lt; 2e-16 ***
ORIGIN_SZTPSZ09 -9.056e-01  7.135e-03  -126.913  &lt; 2e-16 ***
ORIGIN_SZTPSZ10 -1.133e+00  8.089e-03  -140.099  &lt; 2e-16 ***
ORIGIN_SZTPSZ11 -2.364e-01  5.946e-03   -39.763  &lt; 2e-16 ***
ORIGIN_SZTPSZ12 -8.022e-01  6.965e-03  -115.167  &lt; 2e-16 ***
ORIGIN_SZTSSZ01 -2.828e+00  4.827e-02   -58.574  &lt; 2e-16 ***
ORIGIN_SZTSSZ02  2.022e-02  1.051e-02     1.924 0.054350 .  
ORIGIN_SZTSSZ03  1.000e-01  1.096e-02     9.121  &lt; 2e-16 ***
ORIGIN_SZTSSZ04 -6.379e-01  1.163e-02   -54.857  &lt; 2e-16 ***
ORIGIN_SZTSSZ05 -1.110e+00  1.734e-02   -64.044  &lt; 2e-16 ***
ORIGIN_SZTSSZ06  3.753e-01  1.981e-02    18.947  &lt; 2e-16 ***
ORIGIN_SZWCSZ01  1.370e+00  9.208e-03   148.832  &lt; 2e-16 ***
ORIGIN_SZWCSZ02 -2.961e+00  3.310e-02   -89.465  &lt; 2e-16 ***
ORIGIN_SZWCSZ03 -4.991e+00  1.241e-01   -40.200  &lt; 2e-16 ***
ORIGIN_SZWDSZ01  1.521e+00  4.936e-03   308.233  &lt; 2e-16 ***
ORIGIN_SZWDSZ02  2.839e-01  5.617e-03    50.542  &lt; 2e-16 ***
ORIGIN_SZWDSZ03  1.368e+00  5.323e-03   256.975  &lt; 2e-16 ***
ORIGIN_SZWDSZ04  1.023e+00  5.923e-03   172.752  &lt; 2e-16 ***
ORIGIN_SZWDSZ05  2.341e-01  6.055e-03    38.662  &lt; 2e-16 ***
ORIGIN_SZWDSZ06  3.146e-01  5.988e-03    52.541  &lt; 2e-16 ***
ORIGIN_SZWDSZ07 -1.495e+00  9.121e-03  -163.925  &lt; 2e-16 ***
ORIGIN_SZWDSZ08 -8.907e-01  8.739e-03  -101.931  &lt; 2e-16 ***
ORIGIN_SZWDSZ09  1.442e+00  5.311e-03   271.421  &lt; 2e-16 ***
ORIGIN_SZYSSZ01 -2.526e-01  6.441e-03   -39.224  &lt; 2e-16 ***
ORIGIN_SZYSSZ02  8.716e-01  5.762e-03   151.252  &lt; 2e-16 ***
ORIGIN_SZYSSZ03  1.786e+00  5.064e-03   352.596  &lt; 2e-16 ***
ORIGIN_SZYSSZ04  8.411e-01  5.170e-03   162.688  &lt; 2e-16 ***
ORIGIN_SZYSSZ05  4.256e-01  6.250e-03    68.096  &lt; 2e-16 ***
ORIGIN_SZYSSZ06 -7.489e-01  1.191e-02   -62.869  &lt; 2e-16 ***
ORIGIN_SZYSSZ07 -8.462e-01  1.445e-02   -58.542  &lt; 2e-16 ***
ORIGIN_SZYSSZ08  1.809e-01  6.786e-03    26.652  &lt; 2e-16 ***
ORIGIN_SZYSSZ09  1.114e+00  5.072e-03   219.710  &lt; 2e-16 ***
DESTIN_SZAMSZ02  6.899e-02  4.596e-03    15.012  &lt; 2e-16 ***
DESTIN_SZAMSZ03  7.517e-02  4.464e-03    16.840  &lt; 2e-16 ***
DESTIN_SZAMSZ04 -1.130e+00  6.437e-03  -175.593  &lt; 2e-16 ***
DESTIN_SZAMSZ05 -1.075e+00  6.516e-03  -164.998  &lt; 2e-16 ***
DESTIN_SZAMSZ06 -9.613e-01  6.593e-03  -145.809  &lt; 2e-16 ***
DESTIN_SZAMSZ07 -1.507e+00  9.761e-03  -154.383  &lt; 2e-16 ***
DESTIN_SZAMSZ08 -4.843e-01  6.979e-03   -69.393  &lt; 2e-16 ***
DESTIN_SZAMSZ09 -1.022e+00  6.631e-03  -154.149  &lt; 2e-16 ***
DESTIN_SZAMSZ10  1.221e-01  4.703e-03    25.962  &lt; 2e-16 ***
DESTIN_SZAMSZ11 -8.907e-01  8.851e-03  -100.637  &lt; 2e-16 ***
DESTIN_SZAMSZ12  1.980e-02  5.169e-03     3.830 0.000128 ***
DESTIN_SZBDSZ01  9.697e-01  4.274e-03   226.885  &lt; 2e-16 ***
DESTIN_SZBDSZ02 -1.990e-01  5.527e-03   -36.000  &lt; 2e-16 ***
DESTIN_SZBDSZ03  1.243e-01  5.077e-03    24.493  &lt; 2e-16 ***
DESTIN_SZBDSZ04  1.157e+00  4.193e-03   276.010  &lt; 2e-16 ***
DESTIN_SZBDSZ05  9.257e-01  4.439e-03   208.543  &lt; 2e-16 ***
DESTIN_SZBDSZ06  4.068e-01  5.027e-03    80.919  &lt; 2e-16 ***
DESTIN_SZBDSZ07 -8.181e-01  9.893e-03   -82.694  &lt; 2e-16 ***
DESTIN_SZBDSZ08 -1.591e+00  1.116e-02  -142.556  &lt; 2e-16 ***
DESTIN_SZBKSZ01 -1.373e+00  7.213e-03  -190.343  &lt; 2e-16 ***
DESTIN_SZBKSZ02 -5.249e-01  6.185e-03   -84.860  &lt; 2e-16 ***
DESTIN_SZBKSZ03 -1.009e+00  6.540e-03  -154.254  &lt; 2e-16 ***
DESTIN_SZBKSZ04 -5.640e-01  5.642e-03   -99.962  &lt; 2e-16 ***
DESTIN_SZBKSZ05 -9.411e-01  7.057e-03  -133.353  &lt; 2e-16 ***
DESTIN_SZBKSZ06 -1.312e+00  6.739e-03  -194.696  &lt; 2e-16 ***
DESTIN_SZBKSZ07  1.269e-02  4.925e-03     2.576 0.009982 ** 
DESTIN_SZBKSZ08 -1.365e+00  7.508e-03  -181.775  &lt; 2e-16 ***
DESTIN_SZBKSZ09 -1.767e-01  5.561e-03   -31.768  &lt; 2e-16 ***
DESTIN_SZBLSZ01 -7.834e-01  7.569e-03  -103.495  &lt; 2e-16 ***
DESTIN_SZBLSZ02  1.657e-01  7.176e-03    23.092  &lt; 2e-16 ***
DESTIN_SZBLSZ03  1.279e+00  8.176e-03   156.470  &lt; 2e-16 ***
DESTIN_SZBLSZ04 -5.502e-01  1.379e-02   -39.898  &lt; 2e-16 ***
DESTIN_SZBMSZ01  6.866e-01  5.418e-03   126.726  &lt; 2e-16 ***
DESTIN_SZBMSZ02 -1.230e-01  5.532e-03   -22.240  &lt; 2e-16 ***
DESTIN_SZBMSZ03 -2.393e-01  6.239e-03   -38.352  &lt; 2e-16 ***
DESTIN_SZBMSZ04 -4.232e-02  5.795e-03    -7.302 2.83e-13 ***
DESTIN_SZBMSZ05 -2.385e-01  7.592e-03   -31.410  &lt; 2e-16 ***
DESTIN_SZBMSZ06 -1.196e+00  1.347e-02   -88.731  &lt; 2e-16 ***
DESTIN_SZBMSZ07  4.589e-01  5.183e-03    88.546  &lt; 2e-16 ***
DESTIN_SZBMSZ08 -8.618e-01  6.986e-03  -123.351  &lt; 2e-16 ***
DESTIN_SZBMSZ09 -2.132e+00  1.548e-02  -137.678  &lt; 2e-16 ***
DESTIN_SZBMSZ10 -1.462e+00  9.398e-03  -155.587  &lt; 2e-16 ***
DESTIN_SZBMSZ11 -1.324e+00  8.547e-03  -154.956  &lt; 2e-16 ***
DESTIN_SZBMSZ12 -8.403e-01  8.533e-03   -98.483  &lt; 2e-16 ***
DESTIN_SZBMSZ13  1.337e-01  5.966e-03    22.407  &lt; 2e-16 ***
DESTIN_SZBMSZ14 -1.049e+00  8.299e-03  -126.436  &lt; 2e-16 ***
DESTIN_SZBMSZ15 -6.745e-01  7.624e-03   -88.472  &lt; 2e-16 ***
DESTIN_SZBMSZ16 -1.406e+00  1.165e-02  -120.622  &lt; 2e-16 ***
DESTIN_SZBMSZ17 -1.575e+00  1.673e-02   -94.108  &lt; 2e-16 ***
DESTIN_SZBPSZ01 -1.105e+00  6.317e-03  -174.888  &lt; 2e-16 ***
DESTIN_SZBPSZ02 -2.075e+00  9.112e-03  -227.713  &lt; 2e-16 ***
DESTIN_SZBPSZ03 -1.686e+00  8.741e-03  -192.875  &lt; 2e-16 ***
DESTIN_SZBPSZ04 -7.908e-01  6.609e-03  -119.652  &lt; 2e-16 ***
DESTIN_SZBPSZ05  2.173e-01  4.878e-03    44.536  &lt; 2e-16 ***
DESTIN_SZBPSZ06 -1.175e+00  8.364e-03  -140.450  &lt; 2e-16 ***
DESTIN_SZBPSZ07 -2.067e-01  8.452e-03   -24.450  &lt; 2e-16 ***
DESTIN_SZBSSZ01  3.129e-01  5.068e-03    61.753  &lt; 2e-16 ***
DESTIN_SZBSSZ02 -4.876e-01  5.699e-03   -85.553  &lt; 2e-16 ***
DESTIN_SZBSSZ03  4.104e-01  4.305e-03    95.329  &lt; 2e-16 ***
DESTIN_SZBTSZ01  6.182e-01  4.888e-03   126.477  &lt; 2e-16 ***
DESTIN_SZBTSZ02 -1.834e-02  7.178e-03    -2.555 0.010618 *  
DESTIN_SZBTSZ03  4.889e-01  5.847e-03    83.617  &lt; 2e-16 ***
DESTIN_SZBTSZ04 -6.985e-01  1.140e-02   -61.254  &lt; 2e-16 ***
DESTIN_SZBTSZ05  3.284e-01  7.354e-03    44.659  &lt; 2e-16 ***
DESTIN_SZBTSZ06 -1.376e-01  7.394e-03   -18.611  &lt; 2e-16 ***
DESTIN_SZBTSZ07 -1.448e+00  1.132e-02  -127.907  &lt; 2e-16 ***
DESTIN_SZBTSZ08 -7.108e-01  1.038e-02   -68.491  &lt; 2e-16 ***
DESTIN_SZCBSZ01 -5.736e+00  3.163e-01   -18.136  &lt; 2e-16 ***
DESTIN_SZCCSZ01 -6.116e-03  8.337e-03    -0.734 0.463213    
DESTIN_SZCHSZ01 -2.152e-01  9.904e-03   -21.724  &lt; 2e-16 ***
DESTIN_SZCHSZ02  5.330e-01  5.751e-03    92.693  &lt; 2e-16 ***
DESTIN_SZCHSZ03  2.545e+00  4.393e-03   579.316  &lt; 2e-16 ***
DESTIN_SZCKSZ01 -5.624e-01  5.649e-03   -99.556  &lt; 2e-16 ***
DESTIN_SZCKSZ02 -1.107e+00  6.327e-03  -174.935  &lt; 2e-16 ***
DESTIN_SZCKSZ03  1.272e-01  4.942e-03    25.740  &lt; 2e-16 ***
DESTIN_SZCKSZ04 -8.522e-01  7.100e-03  -120.032  &lt; 2e-16 ***
DESTIN_SZCKSZ05 -1.152e+00  7.624e-03  -151.097  &lt; 2e-16 ***
DESTIN_SZCKSZ06 -4.306e-01  7.302e-03   -58.974  &lt; 2e-16 ***
DESTIN_SZCLSZ01  1.967e-01  5.373e-03    36.603  &lt; 2e-16 ***
DESTIN_SZCLSZ02 -2.039e+00  1.360e-02  -149.929  &lt; 2e-16 ***
DESTIN_SZCLSZ03 -9.352e-01  8.289e-03  -112.825  &lt; 2e-16 ***
DESTIN_SZCLSZ04  5.565e-02  5.324e-03    10.452  &lt; 2e-16 ***
DESTIN_SZCLSZ05 -1.079e+00  8.816e-03  -122.382  &lt; 2e-16 ***
DESTIN_SZCLSZ06  4.092e-01  4.903e-03    83.457  &lt; 2e-16 ***
DESTIN_SZCLSZ07 -3.586e-01  6.025e-03   -59.521  &lt; 2e-16 ***
DESTIN_SZCLSZ08 -2.481e-01  6.655e-03   -37.280  &lt; 2e-16 ***
DESTIN_SZCLSZ09  1.616e-01  7.115e-03    22.712  &lt; 2e-16 ***
DESTIN_SZDTSZ02 -1.739e+00  3.495e-02   -49.749  &lt; 2e-16 ***
DESTIN_SZDTSZ03 -6.057e-01  1.462e-02   -41.424  &lt; 2e-16 ***
DESTIN_SZDTSZ13 -1.374e+00  1.628e-02   -84.420  &lt; 2e-16 ***
DESTIN_SZGLSZ01 -9.217e-02  5.526e-03   -16.680  &lt; 2e-16 ***
DESTIN_SZGLSZ02 -7.186e-02  5.282e-03   -13.604  &lt; 2e-16 ***
DESTIN_SZGLSZ03  6.462e-01  4.343e-03   148.802  &lt; 2e-16 ***
DESTIN_SZGLSZ04  9.286e-01  4.366e-03   212.718  &lt; 2e-16 ***
DESTIN_SZGLSZ05  8.123e-01  4.361e-03   186.274  &lt; 2e-16 ***
DESTIN_SZHGSZ01  6.682e-02  4.249e-03    15.724  &lt; 2e-16 ***
DESTIN_SZHGSZ02 -8.127e-01  5.670e-03  -143.327  &lt; 2e-16 ***
DESTIN_SZHGSZ03 -1.354e+00  6.624e-03  -204.350  &lt; 2e-16 ***
DESTIN_SZHGSZ04 -4.491e-01  4.843e-03   -92.736  &lt; 2e-16 ***
DESTIN_SZHGSZ05 -5.025e-01  5.098e-03   -98.576  &lt; 2e-16 ***
DESTIN_SZHGSZ06 -8.681e-01  5.952e-03  -145.850  &lt; 2e-16 ***
DESTIN_SZHGSZ07  5.416e-02  4.769e-03    11.357  &lt; 2e-16 ***
DESTIN_SZHGSZ08 -4.713e-02  5.259e-03    -8.962  &lt; 2e-16 ***
DESTIN_SZHGSZ09 -1.463e-02  5.495e-03    -2.661 0.007780 ** 
DESTIN_SZHGSZ10 -3.580e+00  2.633e-02  -135.962  &lt; 2e-16 ***
DESTIN_SZJESZ01 -3.662e-01  5.667e-03   -64.626  &lt; 2e-16 ***
DESTIN_SZJESZ02 -7.329e-01  5.866e-03  -124.942  &lt; 2e-16 ***
DESTIN_SZJESZ03 -8.935e-01  6.361e-03  -140.480  &lt; 2e-16 ***
DESTIN_SZJESZ04 -1.056e+00  7.399e-03  -142.725  &lt; 2e-16 ***
DESTIN_SZJESZ05 -1.534e+00  1.026e-02  -149.548  &lt; 2e-16 ***
DESTIN_SZJESZ06  3.142e-01  4.821e-03    65.186  &lt; 2e-16 ***
DESTIN_SZJESZ07 -1.325e+00  8.548e-03  -155.025  &lt; 2e-16 ***
DESTIN_SZJESZ08 -6.585e-01  8.316e-03   -79.182  &lt; 2e-16 ***
DESTIN_SZJESZ09  2.623e-01  6.335e-03    41.404  &lt; 2e-16 ***
DESTIN_SZJESZ10  8.434e-01  7.605e-03   110.903  &lt; 2e-16 ***
DESTIN_SZJESZ11  5.545e-01  7.460e-03    74.332  &lt; 2e-16 ***
DESTIN_SZJWSZ01 -9.344e-01  7.193e-03  -129.901  &lt; 2e-16 ***
DESTIN_SZJWSZ02 -8.409e-01  6.026e-03  -139.562  &lt; 2e-16 ***
DESTIN_SZJWSZ03  5.817e-01  4.912e-03   118.414  &lt; 2e-16 ***
DESTIN_SZJWSZ04  4.487e-01  5.028e-03    89.238  &lt; 2e-16 ***
DESTIN_SZJWSZ05 -1.025e+00  6.735e-03  -152.119  &lt; 2e-16 ***
DESTIN_SZJWSZ06 -6.779e-01  6.249e-03  -108.486  &lt; 2e-16 ***
DESTIN_SZJWSZ07 -2.832e+00  2.874e-02   -98.545  &lt; 2e-16 ***
DESTIN_SZJWSZ08 -3.222e-01  5.798e-03   -55.574  &lt; 2e-16 ***
DESTIN_SZJWSZ09  9.066e-01  4.868e-03   186.231  &lt; 2e-16 ***
DESTIN_SZKLSZ01 -2.365e-01  5.795e-03   -40.800  &lt; 2e-16 ***
DESTIN_SZKLSZ02 -5.433e-01  6.142e-03   -88.471  &lt; 2e-16 ***
DESTIN_SZKLSZ03 -8.051e-01  6.873e-03  -117.138  &lt; 2e-16 ***
DESTIN_SZKLSZ04 -1.295e+00  9.018e-03  -143.584  &lt; 2e-16 ***
DESTIN_SZKLSZ05 -4.104e-01  8.780e-03   -46.745  &lt; 2e-16 ***
DESTIN_SZKLSZ06 -2.536e+00  3.632e-02   -69.814  &lt; 2e-16 ***
DESTIN_SZKLSZ07 -6.646e-01  7.073e-03   -93.958  &lt; 2e-16 ***
DESTIN_SZKLSZ08 -1.435e-01  5.495e-03   -26.110  &lt; 2e-16 ***
DESTIN_SZLKSZ01 -1.266e+00  2.083e-02   -60.776  &lt; 2e-16 ***
DESTIN_SZMDSZ01 -1.565e+00  2.028e-02   -77.168  &lt; 2e-16 ***
DESTIN_SZMDSZ02 -9.779e-01  1.147e-02   -85.276  &lt; 2e-16 ***
DESTIN_SZMDSZ03 -3.329e+00  2.543e-02  -130.907  &lt; 2e-16 ***
DESTIN_SZMPSZ01 -4.582e-01  8.065e-03   -56.809  &lt; 2e-16 ***
DESTIN_SZMPSZ02 -5.399e-01  6.459e-03   -83.578  &lt; 2e-16 ***
DESTIN_SZMPSZ03  4.913e-01  5.227e-03    93.990  &lt; 2e-16 ***
DESTIN_SZMUSZ02 -1.449e+00  2.025e-02   -71.562  &lt; 2e-16 ***
DESTIN_SZNTSZ01 -2.922e+00  4.496e-02   -64.985  &lt; 2e-16 ***
DESTIN_SZNTSZ02 -1.380e+00  1.128e-02  -122.288  &lt; 2e-16 ***
DESTIN_SZNTSZ03 -5.078e-01  8.042e-03   -63.137  &lt; 2e-16 ***
DESTIN_SZNTSZ05 -2.002e+00  2.587e-02   -77.399  &lt; 2e-16 ***
DESTIN_SZNTSZ06 -3.809e+00  4.342e-02   -87.719  &lt; 2e-16 ***
DESTIN_SZNVSZ01 -1.096e-01  5.101e-03   -21.482  &lt; 2e-16 ***
DESTIN_SZNVSZ02 -3.058e-02  5.759e-03    -5.310 1.10e-07 ***
DESTIN_SZNVSZ03  1.035e-01  5.789e-03    17.872  &lt; 2e-16 ***
DESTIN_SZNVSZ04 -1.213e+00  1.104e-02  -109.870  &lt; 2e-16 ***
DESTIN_SZNVSZ05 -1.010e+00  9.216e-03  -109.581  &lt; 2e-16 ***
DESTIN_SZPGSZ01 -1.200e+00  1.632e-02   -73.534  &lt; 2e-16 ***
DESTIN_SZPGSZ02 -1.286e+00  7.412e-03  -173.488  &lt; 2e-16 ***
DESTIN_SZPGSZ03 -1.513e-01  4.861e-03   -31.134  &lt; 2e-16 ***
DESTIN_SZPGSZ04 -1.973e-01  5.034e-03   -39.187  &lt; 2e-16 ***
DESTIN_SZPGSZ05 -1.525e+00  8.260e-03  -184.661  &lt; 2e-16 ***
DESTIN_SZPLSZ01 -3.600e-01  7.428e-03   -48.468  &lt; 2e-16 ***
DESTIN_SZPLSZ02 -1.714e+00  1.345e-02  -127.452  &lt; 2e-16 ***
DESTIN_SZPLSZ03 -3.248e-01  9.888e-03   -32.849  &lt; 2e-16 ***
DESTIN_SZPLSZ04 -1.703e+00  1.189e-02  -143.264  &lt; 2e-16 ***
DESTIN_SZPLSZ05 -5.123e-01  1.200e-02   -42.679  &lt; 2e-16 ***
DESTIN_SZPNSZ01  2.693e-01  6.935e-03    38.830  &lt; 2e-16 ***
DESTIN_SZPNSZ02  8.465e-01  7.871e-03   107.550  &lt; 2e-16 ***
DESTIN_SZPNSZ03 -3.440e-01  8.724e-03   -39.437  &lt; 2e-16 ***
DESTIN_SZPNSZ04  1.593e+00  9.386e-03   169.762  &lt; 2e-16 ***
DESTIN_SZPNSZ05  1.193e+00  1.300e-02    91.782  &lt; 2e-16 ***
DESTIN_SZPRSZ01 -1.108e+00  8.819e-03  -125.632  &lt; 2e-16 ***
DESTIN_SZPRSZ02  8.686e-02  5.629e-03    15.432  &lt; 2e-16 ***
DESTIN_SZPRSZ03  6.903e-01  4.395e-03   157.063  &lt; 2e-16 ***
DESTIN_SZPRSZ04 -2.858e-01  8.471e-03   -33.737  &lt; 2e-16 ***
DESTIN_SZPRSZ05  1.720e-01  5.353e-03    32.134  &lt; 2e-16 ***
DESTIN_SZPRSZ06  4.240e-01  5.871e-03    72.210  &lt; 2e-16 ***
DESTIN_SZPRSZ07 -1.512e+00  1.243e-02  -121.681  &lt; 2e-16 ***
DESTIN_SZPRSZ08 -5.671e-01  6.851e-03   -82.772  &lt; 2e-16 ***
DESTIN_SZQTSZ01 -5.928e-01  9.049e-03   -65.508  &lt; 2e-16 ***
DESTIN_SZQTSZ02 -7.732e-01  7.888e-03   -98.013  &lt; 2e-16 ***
DESTIN_SZQTSZ03 -5.084e-01  7.396e-03   -68.741  &lt; 2e-16 ***
DESTIN_SZQTSZ04 -6.401e-01  7.536e-03   -84.937  &lt; 2e-16 ***
DESTIN_SZQTSZ05 -4.380e-01  6.931e-03   -63.198  &lt; 2e-16 ***
DESTIN_SZQTSZ06 -6.621e-01  7.189e-03   -92.104  &lt; 2e-16 ***
DESTIN_SZQTSZ07 -9.433e-01  1.125e-02   -83.848  &lt; 2e-16 ***
DESTIN_SZQTSZ08  4.584e-01  5.698e-03    80.448  &lt; 2e-16 ***
DESTIN_SZQTSZ09 -3.157e-01  6.586e-03   -47.938  &lt; 2e-16 ***
DESTIN_SZQTSZ10  1.966e-01  5.989e-03    32.825  &lt; 2e-16 ***
DESTIN_SZQTSZ11  2.527e-01  6.185e-03    40.850  &lt; 2e-16 ***
DESTIN_SZQTSZ12 -1.703e-01  8.667e-03   -19.651  &lt; 2e-16 ***
DESTIN_SZQTSZ13  5.453e-01  6.306e-03    86.473  &lt; 2e-16 ***
DESTIN_SZQTSZ14  5.310e-01  7.013e-03    75.720  &lt; 2e-16 ***
DESTIN_SZQTSZ15  1.352e+00  8.163e-03   165.573  &lt; 2e-16 ***
DESTIN_SZRCSZ01 -1.063e-01  7.673e-03   -13.857  &lt; 2e-16 ***
DESTIN_SZRCSZ06 -1.071e+00  1.898e-02   -56.422  &lt; 2e-16 ***
DESTIN_SZRVSZ01 -1.552e+00  1.652e-02   -93.899  &lt; 2e-16 ***
DESTIN_SZRVSZ02 -2.415e+00  3.269e-02   -73.878  &lt; 2e-16 ***
DESTIN_SZRVSZ03 -1.522e+00  1.392e-02  -109.300  &lt; 2e-16 ***
DESTIN_SZRVSZ04 -1.171e+00  1.574e-02   -74.398  &lt; 2e-16 ***
DESTIN_SZRVSZ05 -2.239e+00  2.811e-02   -79.654  &lt; 2e-16 ***
DESTIN_SZSBSZ01 -1.377e+00  9.600e-03  -143.394  &lt; 2e-16 ***
DESTIN_SZSBSZ02 -1.443e+00  8.160e-03  -176.793  &lt; 2e-16 ***
DESTIN_SZSBSZ03  5.157e-01  5.162e-03    99.894  &lt; 2e-16 ***
DESTIN_SZSBSZ04  2.402e-01  6.072e-03    39.554  &lt; 2e-16 ***
DESTIN_SZSBSZ05 -1.272e+00  8.278e-03  -153.639  &lt; 2e-16 ***
DESTIN_SZSBSZ06 -1.867e+00  2.272e-02   -82.172  &lt; 2e-16 ***
DESTIN_SZSBSZ07 -6.031e-01  1.849e-02   -32.622  &lt; 2e-16 ***
DESTIN_SZSBSZ08  8.146e-01  5.980e-03   136.211  &lt; 2e-16 ***
DESTIN_SZSBSZ09  9.169e-02  5.701e-03    16.082  &lt; 2e-16 ***
DESTIN_SZSESZ02 -6.378e-01  5.247e-03  -121.551  &lt; 2e-16 ***
DESTIN_SZSESZ03  1.728e-01  4.233e-03    40.815  &lt; 2e-16 ***
DESTIN_SZSESZ04 -1.058e+00  5.985e-03  -176.714  &lt; 2e-16 ***
DESTIN_SZSESZ05 -8.058e-01  5.121e-03  -157.335  &lt; 2e-16 ***
DESTIN_SZSESZ06 -5.590e-01  6.620e-03   -84.444  &lt; 2e-16 ***
DESTIN_SZSESZ07 -3.146e+00  2.278e-02  -138.111  &lt; 2e-16 ***
DESTIN_SZSGSZ01 -1.806e-01  6.012e-03   -30.042  &lt; 2e-16 ***
DESTIN_SZSGSZ02 -2.995e-01  5.355e-03   -55.930  &lt; 2e-16 ***
DESTIN_SZSGSZ03 -4.079e-01  5.060e-03   -80.615  &lt; 2e-16 ***
DESTIN_SZSGSZ04 -1.520e-01  5.092e-03   -29.840  &lt; 2e-16 ***
DESTIN_SZSGSZ05 -1.992e+00  1.014e-02  -196.392  &lt; 2e-16 ***
DESTIN_SZSGSZ06  6.687e-01  4.115e-03   162.509  &lt; 2e-16 ***
DESTIN_SZSGSZ07 -4.509e-01  5.530e-03   -81.530  &lt; 2e-16 ***
DESTIN_SZSISZ01 -5.576e-01  2.618e-02   -21.295  &lt; 2e-16 ***
DESTIN_SZSKSZ01 -4.741e-01  7.922e-03   -59.849  &lt; 2e-16 ***
DESTIN_SZSKSZ02  9.398e-01  5.719e-03   164.345  &lt; 2e-16 ***
DESTIN_SZSKSZ03 -2.768e-01  6.605e-03   -41.914  &lt; 2e-16 ***
DESTIN_SZSKSZ04 -1.254e+00  1.453e-02   -86.244  &lt; 2e-16 ***
DESTIN_SZSKSZ05 -2.574e-01  1.128e-02   -22.828  &lt; 2e-16 ***
DESTIN_SZSLSZ01 -7.789e-01  8.581e-03   -90.768  &lt; 2e-16 ***
DESTIN_SZSLSZ04 -8.600e-01  7.313e-03  -117.602  &lt; 2e-16 ***
DESTIN_SZSRSZ01 -1.140e+00  1.420e-02   -80.294  &lt; 2e-16 ***
DESTIN_SZTHSZ01 -4.312e+00  3.686e-02  -116.990  &lt; 2e-16 ***
DESTIN_SZTHSZ03 -2.668e+00  2.527e-02  -105.592  &lt; 2e-16 ***
DESTIN_SZTHSZ04 -3.100e+00  2.163e-02  -143.273  &lt; 2e-16 ***
DESTIN_SZTHSZ06 -2.598e+00  1.563e-02  -166.168  &lt; 2e-16 ***
DESTIN_SZTMSZ01 -2.103e-01  5.924e-03   -35.506  &lt; 2e-16 ***
DESTIN_SZTMSZ02  1.820e+00  3.913e-03   465.178  &lt; 2e-16 ***
DESTIN_SZTMSZ03  8.491e-01  4.361e-03   194.689  &lt; 2e-16 ***
DESTIN_SZTMSZ04  1.020e+00  4.344e-03   234.861  &lt; 2e-16 ***
DESTIN_SZTMSZ05  6.281e-01  6.004e-03   104.619  &lt; 2e-16 ***
DESTIN_SZTNSZ01 -3.382e-01  7.437e-03   -45.476  &lt; 2e-16 ***
DESTIN_SZTNSZ02 -1.087e+00  1.017e-02  -106.873  &lt; 2e-16 ***
DESTIN_SZTNSZ03 -1.421e+00  1.199e-02  -118.523  &lt; 2e-16 ***
DESTIN_SZTNSZ04 -3.103e-01  7.472e-03   -41.523  &lt; 2e-16 ***
DESTIN_SZTPSZ01 -4.884e-01  6.156e-03   -79.344  &lt; 2e-16 ***
DESTIN_SZTPSZ02  7.128e-01  4.129e-03   172.617  &lt; 2e-16 ***
DESTIN_SZTPSZ03 -4.315e-01  5.990e-03   -72.039  &lt; 2e-16 ***
DESTIN_SZTPSZ04 -1.590e+00  7.607e-03  -209.041  &lt; 2e-16 ***
DESTIN_SZTPSZ05 -1.045e+00  6.234e-03  -167.638  &lt; 2e-16 ***
DESTIN_SZTPSZ06 -4.298e-01  7.007e-03   -61.339  &lt; 2e-16 ***
DESTIN_SZTPSZ07 -2.160e+00  1.203e-02  -179.462  &lt; 2e-16 ***
DESTIN_SZTPSZ08 -1.194e+00  9.307e-03  -128.313  &lt; 2e-16 ***
DESTIN_SZTPSZ09 -2.042e-01  7.112e-03   -28.718  &lt; 2e-16 ***
DESTIN_SZTPSZ10 -1.248e+00  9.011e-03  -138.449  &lt; 2e-16 ***
DESTIN_SZTPSZ11 -8.341e-02  5.600e-03   -14.893  &lt; 2e-16 ***
DESTIN_SZTPSZ12 -6.799e-01  6.633e-03  -102.517  &lt; 2e-16 ***
DESTIN_SZTSSZ01 -1.569e+00  2.221e-02   -70.628  &lt; 2e-16 ***
DESTIN_SZTSSZ02 -1.728e-01  1.464e-02   -11.805  &lt; 2e-16 ***
DESTIN_SZTSSZ03  6.721e-01  9.244e-03    72.713  &lt; 2e-16 ***
DESTIN_SZTSSZ04  5.465e-01  1.002e-02    54.530  &lt; 2e-16 ***
DESTIN_SZTSSZ05  1.482e+00  1.044e-02   142.022  &lt; 2e-16 ***
DESTIN_SZTSSZ06  2.519e+00  1.674e-02   150.506  &lt; 2e-16 ***
DESTIN_SZWCSZ01  2.057e+00  5.476e-03   375.589  &lt; 2e-16 ***
DESTIN_SZWCSZ02 -2.059e+00  1.293e-02  -159.217  &lt; 2e-16 ***
DESTIN_SZWCSZ03 -3.178e+00  3.270e-02   -97.207  &lt; 2e-16 ***
DESTIN_SZWDSZ01  1.049e+00  4.457e-03   235.280  &lt; 2e-16 ***
DESTIN_SZWDSZ02 -1.314e+00  6.586e-03  -199.500  &lt; 2e-16 ***
DESTIN_SZWDSZ03  3.435e-01  5.246e-03    65.478  &lt; 2e-16 ***
DESTIN_SZWDSZ04 -7.881e-01  7.336e-03  -107.418  &lt; 2e-16 ***
DESTIN_SZWDSZ05 -8.733e-01  7.291e-03  -119.775  &lt; 2e-16 ***
DESTIN_SZWDSZ06 -2.084e-01  5.298e-03   -39.328  &lt; 2e-16 ***
DESTIN_SZWDSZ07 -1.599e+00  7.172e-03  -222.972  &lt; 2e-16 ***
DESTIN_SZWDSZ08 -5.107e-01  6.919e-03   -73.805  &lt; 2e-16 ***
DESTIN_SZWDSZ09  3.824e-01  5.466e-03    69.964  &lt; 2e-16 ***
DESTIN_SZYSSZ01  8.831e-02  4.653e-03    18.977  &lt; 2e-16 ***
DESTIN_SZYSSZ02 -3.212e-01  5.732e-03   -56.039  &lt; 2e-16 ***
DESTIN_SZYSSZ03 -4.144e-01  6.627e-03   -62.535  &lt; 2e-16 ***
DESTIN_SZYSSZ04 -4.624e-01  5.818e-03   -79.476  &lt; 2e-16 ***
DESTIN_SZYSSZ05 -1.590e+00  1.110e-02  -143.237  &lt; 2e-16 ***
DESTIN_SZYSSZ06 -1.463e+00  1.077e-02  -135.813  &lt; 2e-16 ***
DESTIN_SZYSSZ07 -7.861e-01  1.443e-02   -54.464  &lt; 2e-16 ***
DESTIN_SZYSSZ08  6.262e-01  4.546e-03   137.749  &lt; 2e-16 ***
DESTIN_SZYSSZ09  1.522e-01  4.805e-03    31.674  &lt; 2e-16 ***
log(dist)       -1.841e+00  4.634e-04 -3974.101  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 45858216  on 14469  degrees of freedom
Residual deviance: 10409366  on 13911  degrees of freedom
AIC: 10499609

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p><img src="dbcSIM_Poisson_R.png" width="322" height="23"></p>
<p>(β=−1.841475) indicates a negative exponential relationship between distance and the phenomenon being modeled.</p>
<p>The negative sign suggests a decrease in the phenomenon as distance increases. In other words, the phenomenon tends to diminish or decay as you move farther away from a certain point.</p>
<p>The magnitude of the value indicates the rate of decay. In your case, a larger negative value (β) suggests a faster decay—meaning the effect diminishes rapidly with distance.</p>
<section id="goodness-of-fit-3" class="level4">
<h4 class="anchored" data-anchor-id="goodness-of-fit-3">Goodness of fit</h4>
<p>In statistical modelling, the next question we would like to answer is how well the proportion of variance in the dependent variable (i.e.&nbsp;TRIPS) that can be explained by the explanatory variables.</p>
<p>In order to provide answer to this question, R-squared statistics will be used. However, R-squared is not an output of glm(). Hence we will write a function called CalcRSquared by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>CalcRSquared <span class="ot">&lt;-</span> <span class="cf">function</span>(observed, estimated){</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">cor</span>(observed, estimated)</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>  R2 <span class="ot">&lt;-</span> r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>  R2</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, we can examine how the constraints hold for destinations this time.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(orcSIM_Poisson<span class="sc">$</span>data<span class="sc">$</span>TRIPS, orcSIM_Poisson<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4304431</code></pre>
</div>
</div>
<p>With reference to the R-Squared above, we can conclude that the model accounts for about 43% of the variation of flows in the systems. Not bad, but not brilliant either.</p>
<p>Next, let us examine how well the proportion of variance in the dependent variable (i.e.&nbsp;TRIPS) that can be explained by the explanatory variables.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(dbcSIM_Poisson<span class="sc">$</span>data<span class="sc">$</span>TRIPS,</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>             dbcSIM_Poisson<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6606106</code></pre>
</div>
</div>
<p>Notice that there is a relatively greater improvement in the R-Squared value.</p>
</section>
</section>
</section>
<section id="re-model-comparison" class="level2">
<h2 class="anchored" data-anchor-id="re-model-comparison">22 Re-Model comparison</h2>
<section id="statistical-measures-1" class="level3">
<h3 class="anchored" data-anchor-id="statistical-measures-1">Statistical measures</h3>
<p>Another useful model performance measure for continuous dependent variable is Root Mean Squared Error. In this sub-section, you will learn how to use compare_performance() of performance package</p>
<p>First of all, let us create a list called model_list by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>model_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Origin_Constrained =</span> orcSIM_Poisson,</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Doubly_Constrained =</span> dbcSIM_Poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will compute the RMSE of all the models in model_list file by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(model_list,</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="st">"RMSE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name               | Model |     RMSE
-------------------------------------
Origin_Constrained |   glm | 2458.950
Doubly_Constrained |   glm | 1897.735</code></pre>
</div>
</div>
<p>The print above reveals that doubly constrained SIM is the best model among the two SIMs because it has the smallest RMSE value of 1897.735.</p>
</section>
<section id="visualising-fitted-values-1" class="level3">
<h3 class="anchored" data-anchor-id="visualising-fitted-values-1">Visualising fitted values</h3>
<p>In this section, you will learn how to visualise the observed values and the fitted values.</p>
<p>Firstly we will extract the fitted values from Origin-constrained Model by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(orcSIM_Poisson<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will append the fitted values into inter_zonal_flow data frame by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>inter_zonal_flow <span class="ot">&lt;-</span> inter_zonal_flow <span class="sc">%&gt;%</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dbcSIM_Poisson<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>inter_zonal_flow <span class="ot">&lt;-</span> inter_zonal_flow <span class="sc">%&gt;%</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, two scatterplots will be created by using geom_point() and other appropriate functions of ggplot2 package.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>orc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> inter_zonal_flow,</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> orcTRIPS,</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm) <span class="sc">+</span></span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">150000</span>),</span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">150000</span>))</span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>dbc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> inter_zonal_flow,</span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> dbcTRIPS,</span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm) <span class="sc">+</span></span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">150000</span>),</span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">150000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, we will put all the graphs into a single visual for better comparison by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(orc_p, dbc_p,</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-146-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Observation: Both graphs look similar after the removal of outlier.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>