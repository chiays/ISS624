---
title: "Take-home_Ex1: Geospatial Analytics for Public Good"
author: "Yong Soon"
date: "26 Nov 2023"
date-modified: "last-modified"
---

##1 Getting started

##Setting the Scene As city-wide urban infrastructures such as buses, taxis, mass rapid transit, public utilities and roads become digital, the datasets obtained can be used as a framework for tracking movement patterns through space and time. This is particularly true with the recent trend of massive deployment of pervasive computing technologies such as GPS and RFID on the vehicles. For example, routes and ridership data were collected with the use of smart cards and Global Positioning System (GPS) devices available on the public buses. These massive movement data collected are likely to contain structure and patterns that provide useful information about characteristics of the measured phenomena. The identification, analysis and comparison of such patterns will provide greater insights on human movement and behaviours within a city. These understandings will potentially contribute to a better urban management and useful information for urban transport services providers both from the private and public sector to formulate informed decision to gain competitive advantage.

In real-world practices, the use of these massive locational aware data, however, tend to be confined to simple tracking and mapping with GIS applications. This is mainly due to a general lack of functions in conventional GIS which is capable of analysing and model spatial and spatio-temporal data effectively.

##Objectives Exploratory Spatial Data Analysis (ESDA) hold tremendous potential to address complex problems facing society. In this study, you are tasked to apply appropriate Local Indicators of Spatial Association (GLISA) and Emerging Hot Spot Analysis (EHSA) to undercover the spatial and spatio-temporal mobility patterns of public bus passengers in Singapore.

##2 The Task

###2.1 Geovisualisation and Analysis With reference to the time intervals provided in the table below, compute the passenger trips generated by origin at the hexagon level,

| Peak hour period              | Bus tap on time |
|-------------------------------|-----------------|
| Weekday morning peak          | 6am to 9am      |
| Weekday afternoon peak        | 5pm to 8pm      |
| Weekend/holiday morning peak  | 11am to 2pm     |
| Weekend/holiday evening peak  | 4pm to 7pm      |

-   Display the geographical distribution of the passenger trips by using appropriate geovisualisation methods,

-   Describe the spatial patterns revealed by the geovisualisation (not more than 200 words per visual).

##3 Installing and Loading the R Packages

Six R packages will be used for this exercise, they are sf, sfdep, tmap, tidyverse, knitr, plotly.

```{r}
#| code-fold: true
#| code-summary: "Show the code"
pacman::p_load(sf, sfdep, tmap, tidyverse, knitr, plotly)
```

1.  sf: Purpose: The sf package stands for "simple features" and is used for working with spatial data in R. It provides a framework for representing and manipulating geometric objects like points, lines, and polygons, making it useful for tasks such as geographic information system (GIS) analysis.

2.  sfdep: Purpose: The sfdep provides users with a way to conduct "Exploratory Spatial Data Analysis", typical for exploratory data analysis. It evaluates the phenomena captured in the data on whether they are dependent upon space--or are spatially auto-correlated. "Local Indicators of Spatial Association", LISAs for short are measures that are developed to identify whether some observed pattern is truly random or impacted by its relationship in space.

3.  tmap: Purpose: tmap is a package for creating thematic maps in R. It provides a simple and consistent interface for visualizing spatial data, making it easier to create informative and visually appealing maps. It is often used in conjunction with the sf package for handling spatial data.

4.  tidyverse: Purpose: The tidyverse is not a single package but a collection of R packages that work together cohesively for data manipulation and visualization. It includes popular packages like ggplot2 for plotting, dplyr for data manipulation, tidyr for data tidying, and others. The tidyverse philosophy emphasizes a consistent and intuitive approach to data analysis.

5.  knitr: Purpose: knitr is a package for dynamic report generation in R. It allows you to embed R code directly into documents and then render the code and its output, such as tables and plots, into various document formats like HTML, PDF, or Word. It is commonly used with R Markdown to create reproducible research reports.

6.  plotly: Purpose: plotly is a package for creating interactive and dynamic plots in R. It supports a variety of chart types, including scatter plots, line charts, and 3D plots. The resulting visualizations can be embedded into web pages, making it a powerful tool for creating interactive and shareable data visualizations.


##4 The Data

###4.1 Aspatial data
For the purpose of this take-home exercise, Passenger Volume by Origin Destination Bus Stops downloaded from LTA DataMall will be used.

####4.1.1 Importing the aspatial data

Since listings data set is in csv file format, we will use read_csv() of readr package to import origin_destination_bus.csv as shown the code chunk below. The output R object is called odbus0823 and it is a tibble data frame.

```{r}
odbus0823 <- read_csv("data/aspatial/origin_destination_bus_202308.csv")
```

###4.2 Geospatial data
Two geospatial data will be used in this study, they are:

- Bus Stop Location from LTA DataMall. It provides information about all the bus stops currently being serviced by buses, including the bus stop code (identifier) and location coordinates.

- hexagon, a hexagon layer of 250m (this distance is the perpendicular distance between the centre of the hexagon and its edges.) should be used to replace the relative coarse and irregular Master Plan 2019 Planning Sub-zone GIS data set of URA.


####4.2.1 Importing the data into R Environment

The code chunk below uses st_read() function of sf package to import BusStop shapefile into R as line feature data frame.

```{r}
#| code-fold: true
#| code-summary: "Show the code"
BusStop = st_read(dsn = "data/geospatial", 
                         layer = "BusStop")
```
The message above reveals that there are a total of 5161 features and 3 fields in BusStop linestring feature data frame and it is in svy21 projected coordinates system too.


















